package ru.yandex.metrika.util;

import junit.framework.Assert;
import org.junit.Test;

import ru.yandex.metrika.util.hash.CHIntHash32;

/**
 * @author serebrserg
 * @since 21.12.15
 */
public class CHIntHash32Test {

    @Test
    public void test(){
        for (String[] test : testData){
            Assert.assertEquals(Long.valueOf(test[1]).longValue(), CHIntHash32.apply(Long.parseUnsignedLong(test[0])));
        }
    }

    // 100 различных UserID -> intHash32(UserID) из ClickHouse
    static String[][] testData = {
            {"574508571422434564", "1232799698"},
            {"5353047191450705463", "2109475228"},
            {"8760395861444360944", "2571454567"},
            {"653719901417520498", "13401587"},
            {"8514271601376481529", "26828842"},
            {"576409081450686524", "64171460"},
            {"587605841430813098", "66060563"},
            {"2278753661399979773", "72540730"},
            {"477989771441739349", "80930440"},
            {"1231262711434360799", "96339816"},
            {"1759858121450631523", "117062136"},
            {"708482441450698084", "120571080"},
            {"6409083591373570773", "187055988"},
            {"2245270551399978373", "242550682"},
            {"1457443541442495884", "251175815"},
            {"3833345021353592433", "255731797"},
            {"365135351448878273", "257299273"},
            {"439405041444161254", "269703774"},
            {"1738552321450358183", "290175277"},
            {"9763786781384179988", "321117138"},
            {"2544172899156658089", "389185960"},
            {"9944331467514988264", "402478947"},
            {"2699337881418284273", "413960254"},
            {"5656536571431611078", "492494388"},
            {"2008835341449312664", "499184872"},
            {"2199369871432043433", "531643201"},
            {"9689482641449333338", "535034905"},
            {"2054012981426600429", "535756210"},
            {"2050475761437474299", "576062128"},
            {"593937931434583663", "592849304"},
            {"2763202341449210989", "625481710"},
            {"2146249911434797963", "637502713"},
            {"203360371429514498", "646586554"},
            {"1615210201434717584", "670911305"},
            {"14815288433074838264", "675624748"},
            {"893160161414747923", "685433070"},
            {"7433388801447157884", "689755149"},
            {"9173829701450702953", "694729539"},
            {"598151261425995659", "766131915"},
            {"7138384751388517413", "766830127"},
            {"1367121241409909929", "768234957"},
            {"6005191001378407123", "805351191"},
            {"2340394191439800208", "849395176"},
            {"2409993381440086194", "869901211"},
            {"4939693341405012489", "870349469"},
            {"672571061447674949", "904603483"},
            {"2277935091437480149", "912597484"},
            {"836194701370263154", "938813023"},
            {"1048398951429018769", "986212354"},
            {"5494673661445616663", "989971705"},
            {"7523250891449860709", "1017997739"},
            {"9417746331435038678", "1036404258"},
            {"8379921591450102744", "1059030820"},
            {"352629401438618118", "1070338567"},
            {"2200097151434520123", "1070884468"},
            {"8287186165786064583", "1098071187"},
            {"1881488351448886808", "1098876118"},
            {"1281647341449591444", "1111012554"},
            {"221662991445270664", "1130239609"},
            {"243951511430134014", "1136082983"},
            {"5423817781364459834", "1138618523"},
            {"9287443731445283619", "1148053244"},
            {"4068221971443769783", "1154787538"},
            {"6195821621436368038", "1169673060"},
            {"1262293881440995488", "1178073609"},
            {"8408294391449567104", "1188636349"},
            {"553387171446539013", "1193947871"},
            {"324041541444515139", "1208609695"},
            {"2147358501433234564", "1224245414"},
            {"153673631450702349", "1228313392"},
            {"2042106681448913173", "1245824184"},
            {"6118714941422867823", "1265062920"},
            {"561268281450700533", "1349123845"},
            {"1827649601450688314", "1400735996"},
            {"8928405191436088684", "1435015580"},
            {"3489250581391167403", "1461174718"},
            {"346899141442321113", "1475088142"},
            {"2337983451400491683", "1522207304"},
            {"6027806481414666403", "1532718400"},
            {"1430364651433855253", "1558388743"},
            {"6449129594759398668", "1651645600"},
            {"460255151434709143", "1668506938"},
            {"13889011450703684", "1679675822"},
            {"377537311443104183", "1690845892"},
            {"381942191379998878", "1701744050"},
            {"4964370371377237504", "1703834593"},
            {"196341781410457638", "1722607031"},
            {"7440273881446303873", "1739712617"},
            {"7308118021450443428", "1766512373"},
            {"1777370191431422809", "1814668930"},
            {"1647883241446750253", "1833995816"},
            {"2538206501447847728", "1837252048"},
            {"8971121871450339239", "1838262291"},
            {"934211391450628439", "1912711187"},
            {"2354139901450703559", "1967013712"},
            {"324542501416227059", "1978950218"},
            {"1005081341449756688", "1983032827"},
            {"2510344331447260383", "1991083809"},
            {"6707754131450700824", "2042644098"},
            {"2630824271445549288", "2054378981"}
    };
}
