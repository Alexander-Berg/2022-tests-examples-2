##HEADER
accident_id: '635eda0e-b458-466b-8c34-40e05857ee02'
run_id: '12345'
task: 'raw_mdb_order_proc_dynamic_increment'
creation_dttm: '20180402000001'
##DESCRIPTION
Exception message: Node is out of tablet memory, all writes disabled

***** Details:
Received HTTP response with error
    origin          taxi-etl01h.taxi.yandex.net in 2018-04-19T20:41:44.855610Z
    headers         {
                      "X-YT-Correlation-Id": "6ec61586-ca91fe3d-8b0b7c9f-cf1fa36f",
                      "X-YT-Parameters": "{\"path\"=\"//home/taxi-dwh/raw/mdb/order_proc/2018-01-01\";\"update\"=\"true\";\"input_format\"=<\"boolean_as_string\"=%false;\"ignore_inner_attributes\"=%false;\"always_create_attributes\"=%false;\"format\"=\"binary\";>\"yson\";}",
                      "Accept-Encoding": "gzip, identity",
                      "X-Started-By": "{\"pid\"=34397;\"user\"=\"robot-taxi-stat\";}",
                      "Content-Encoding": "gzip",
                      "X-YT-Header-Format": "<format=text>yson",
                      "User-Agent": "Python wrapper 0.8.27-0"
                    }
    params          {
                      "path": "//home/taxi-dwh/raw/mdb/order_proc/2018-01-01",
                      "update": "true",
                      "input_format": "yson"
                    }
    url             http://n0396-sas.hahn.yt.yandex.net/api/v3/insert_rows
    transparent     True
Node is out of tablet memory, all writes disabled
    code            1703
    origin          n6358-sas.hahn.yt.yandex.net in 2018-04-19T20:41:44.842076Z (pid 290501, tid 9903a27acc8fa58d, fid fffa4f16c298de0c)
    service         TabletService
    address         n6358-sas.hahn.yt.yandex.net:9012
    connection_id   20b-16a22aea-6bb0c911-4ebcf470
    timeout         60000
    request_id      553078-3143181e-941bc7a9-2ce9a54
    realm_id        7fb0-e967-3fe02bc-3f723b2e
    method          Write


Exception type: <class 'yt.wrapper.errors.YtHttpResponseError'>
Python version: Python 2.7.6: /usr/bin/python


---------------====== Original traceback ======------------------

Traceback (most recent call last):
  File "/usr/lib/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/robot-taxi-stat/etl/layer/yt/raw/mdb/order_proc/dynamic_increment_loader.py", line 15, in <module>
    loader.load()
  File "/home/robot-taxi-stat/etl/lib/yt/dyntable_operation/dynamic_table_loaders.py", line 47, in load
    records
  File "/home/robot-taxi-stat/etl/lib/yt/dyntable_operation/operations.py", line 65, in insert_chunk_in_dynamic_table
    return insert_with_retries(path, chunk, update=True)
  File "/home/robot-taxi-stat/etl/lib/decorators.py", line 20, in decorated
    result = fn(*args, **kwargs)
  File "<decorator-gen-83>", line 2, in insert_rows
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/client_helpers.py", line 48, in decorator
    return original_func(*args, client=self, **kwargs)
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/dynamic_table_commands.py", line 179, in insert_rows
    client=client).run()
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/retries.py", line 59, in run
    return self.action()
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/dynamic_table_commands.py", line 81, in action
    **kwargs)
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/transaction_commands.py", line 10, in _make_transactional_request
    return make_request(command_name, params, **kwargs)
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/driver.py", line 115, in make_request
    client=client)
  File "<decorator-gen-2>", line 2, in make_request
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/common.py", line 245, in forbidden_inside_job
    return func(*args, **kwargs)
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/http_driver.py", line 272, in make_request
    client=client)
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/http_helpers.py", line 290, in make_request_with_retries
    return RequestRetrier(method=method, url=url, **kwargs).run()
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/retries.py", line 59, in run
    return self.action()
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/http_helpers.py", line 260, in action
    _raise_for_status(response, request_info)
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/http_helpers.py", line 161, in _raise_for_status
    raise YtHttpResponseError(error=response.error(), **request_info)
YtHttpResponseError: Node is out of tablet memory, all writes disabled

***** Details:
Received HTTP response with error
    origin          taxi-etl01h.taxi.yandex.net in 2018-04-19T20:41:44.855610Z
    headers         {
                      "X-YT-Correlation-Id": "6ec61586-ca91fe3d-8b0b7c9f-cf1fa36f",
                      "X-YT-Parameters": "{\"path\"=\"//home/taxi-dwh/raw/mdb/order_proc/2018-01-01\";\"update\"=\"true\";\"input_format\"=<\"boolean_as_string\"=%false;\"ignore_inner_attributes\"=%false;\"always_create_attributes\"=%false;\"format\"=\"binary\";>\"yson\";}",
                      "Accept-Encoding": "gzip, identity",
                      "X-Started-By": "{\"pid\"=34397;\"user\"=\"robot-taxi-stat\";}",
                      "Content-Encoding": "gzip",
                      "X-YT-Header-Format": "<format=text>yson",
                      "User-Agent": "Python wrapper 0.8.27-0"
                    }
    params          {
                      "path": "//home/taxi-dwh/raw/mdb/order_proc/2018-01-01",
                      "update": "true",
                      "input_format": "yson"
                    }
    url             http://n0396-sas.hahn.yt.yandex.net/api/v3/insert_rows
    transparent     True
Node is out of tablet memory, all writes disabled
    code            1703
    origin          n6358-sas.hahn.yt.yandex.net in 2018-04-19T20:41:44.842076Z (pid 290501, tid 9903a27acc8fa58d, fid fffa4f16c298de0c)
    service         TabletService
    address         n6358-sas.hahn.yt.yandex.net:9012
    connection_id   20b-16a22aea-6bb0c911-4ebcf470
    timeout         60000
    request_id      553078-3143181e-941bc7a9-2ce9a54
    realm_id        7fb0-e967-3fe02bc-3f723b2e
    method          Write


---------------====== Detailed traceback ======------------------

Traceback (most recent call last):

------------------------------
/usr/lib/python2.7/runpy.py:
 in _run_module_as_main(mod_name = 'layer.yt.raw.mdb.order_proc.dynamic_increment_loader', alter_argv = 1)

     160         sys.argv[0] = fname
     161     return _run_code(code, main_globals, None,
  -> 162                      "__main__", fname, loader, pkg_name)
     163
     164 def run_module(mod_name, init_globals=None,

Vars:
  fname = '/home/robot-taxi-stat/etl/layer/yt/raw/mdb/order_proc/dynamic_increment_loader.py'
  loader = <pkgutil.ImpLoader instance at 0x7f866c0729e0>
  pkg_name = 'layer.yt.raw.mdb.order_proc'

------------------------------
/usr/lib/python2.7/runpy.py:
 in _run_code(code = <code object <module> at 0x7f866fe8df30, file "/.../order_proc/dynamic_increment_loader.py", line 4>, run_globals = {'MDBDynamicIncrementLoader': <class 'lib.yt.dyntable_operation.dynamic_table_loaders.MDBDynamicIncrementLoader'>, 'RawOrderProc': <class 'layer.yt.raw.mdb.order_proc.table.RawOrderProc'>, '__builtins__': <module '__builtin__' (built-in)>, '__doc__': None, '__file__': '/home/robot-taxi-stat/etl/layer/yt/raw/mdb/order_proc/dynamic_increment_loader.py', '__loader__': <pkgutil.ImpLoader instance>, '__name__': '__main__', '__package__': 'layer.yt.raw.mdb.order_proc', 'extract_utils': <module 'lib.extract_utils' from '/home/robot-taxi-stat/etl/lib/extract_utils.pyc'>, 'loader': <lib.yt.dyntable_operation.dynamic_table_loaders.MDBDynamicIncrementLoader object>}, init_globals = None, mod_name = '__main__', mod_fname = '/home/robot-taxi-stat/etl/layer/yt/raw/mdb/order_proc/dynamic_increment_loader.py', mod_loader = <pkgutil.ImpLoader instance>, pkg_name = '
 layer.yt.raw.mdb.order_proc')

      70                        __loader__ = mod_loader,
      71                        __package__ = pkg_name)
   -> 72     exec code in run_globals
      73     return run_globals
      74

Vars:
  code = <code object <module> at 0x7f866fe8df30, file "/home/robot-taxi-stat/etl/layer/yt/raw/mdb/order_proc/dynamic_increment_loader.py", line 4>
  run_globals = {'MDBDynamicIncrementLoader': lib.yt.dyntable_operation.dynamic_table_loaders.MDBDynamicIncrementLoader,
                 'RawOrderProc': layer.yt.raw.mdb.order_proc.table.RawOrderProc,
                 '__builtins__': <module '__builtin__' (built-in)>,
                 '__doc__': None,
                 '__file__': '/home/robot-taxi-stat/etl/layer/yt/raw/mdb/order_proc/dynamic_increment_loader.py',
                 '__loader__': <pkgutil.ImpLoader instance at 0x7f866c0729e0>,
                 '__name__': '__main__',
                 '__package__': 'layer.yt.raw.mdb.order_proc',
                 'extract_utils': <module 'lib.extract_utils' from '/home/robot-taxi-stat/etl/lib/extract_utils.pyc'>,
                 'loader': <lib.yt.dyntable_operation.dynamic_table_loaders.MDBDynamicIncrementLoader at 0x7f8658ee27d0>}

------------------------------
/home/robot-taxi-stat/etl/layer/yt/raw/mdb/order_proc/dynamic_increment_loader.py:
 in <module>()

      11         filters={'commit_state': {'$in': [None, 'done']}},
      12         order_created=extract_utils.path_extractor('order.created'),
      13         **extract_utils.DEFAULT_MONGODB_EXTRACTORS
      14     )
   -> 15     loader.load()

Vars:
  loader = <lib.yt.dyntable_operation.dynamic_table_loaders.MDBDynamicIncrementLoader at 0x7f8658ee27d0>
  loader.load = <bound method MDBDynamicIncrementLoader.load of <lib.yt.dyntable_operation.dynamic_table_loaders.MDBDynamicIncrementLoader object at 0x7f8658ee27d0>>

------------------------------
/home/robot-taxi-stat/etl/lib/yt/dyntable_operation/dynamic_table_loaders.py:
 in load(self = <lib.yt.dyntable_operation.dynamic_table_loaders.MDBDynamicIncrementLoader object>)

      45                     insert_chunk_in_dynamic_table(
      46                         YTMeta(self.table, partition=partition),
   -> 47                         records
      48                     )
      49             else:

Vars:
  records = <itertools._grouper at 0x7f857201a110>

------------------------------
/home/robot-taxi-stat/etl/lib/yt/dyntable_operation/operations.py:
 in insert_chunk_in_dynamic_table(meta = <lib.yt.meta.YTMeta object>, chunk = [{'doc': {u'_id': u'7452c580e33c4422ae581a9f48a9828a', u'aliases': [{u'due': '2018-01-09 12:10:00.000000', u'due_optimistic': None, u'generation': 1, u'id': u'dbae3b14bf7f4037bfe6aeca0a853ee5'}], u'autoreorder': {u'decisions': [{u'created': '2018-01-09 12:13:39.243000'}]}, u'candidates': [{u'adjusted_point': {u'avg_speed': 0, u'direction': -1, u'geopoint': [...], u'time': 1515499575}, u'alias_id': u'dbae3b14bf7f4037bfe6aeca0a853ee5', u'ar': 0.5, u'cancel_attempts': 3, u'cancel_status': u'finished', u'car_color': u'\u0447\u0435\u0440\u043d\u044b\u0439', u'car_color_code': u'040001', u'car_model': u'LADA (\u0412\u0410\u0417) 2114', u'car_number': u'\u0420204\u0410\u0410116', u'ci': u'f8b9e6bc1b264e62a731ae6843234dc8', ...}, {u'cancel_status': u'finished', u'hd': True, u'ost': '2018-01-09 12:13:53.743000', u'requestcar_status': u'finished', u'setcared': '2018-01-09 12:13:53.743000'}], u'changes': {u'objects':
 [{u'c': '2018-01-09 12:10:41.011000', u'ci': u'a23e364afa6d4543942c1c42af945a5c', u'id': u'624886643c0c48b8a41b921a5486d692', u'n': u'user_ready', u's': u'applied', u'si': {...}, u't': '2018-01-09 12:10:39.000000', u'vl': False, u'vr': 4}, {u'c': '2018-01-09 12:10:41.011000', u'ci': u'a23e364afa6d4543942c1c42af945a5c', u'id': u'ca2315d469c14ffd80b74657d6148b1b', u'n': u'user_ready', u's': u'applied', u'si': {...}, u't': '2018-01-09 12:10:39.000000', u'vl': True, u'vr': 4}]}, u'created': '2018-01-09 12:06:27.869000', u'insurer_id': u'83d0d8e57b9242f7a7968653ecfe490b', u'lookup': {u'eta': '2018-01-09 12:13:39.696000', u'generation': 3, u'generation_updated': '2018-01-09 12:13:39.696000', u'name': u'direct_assignment', u'need_start': True, u'params': {}, u'restart_eta': None, u'start_eta': '2018-01-09 12:13:39.243000', u'state': {}, u'version': 2}, u'order': {u'_type': u'soon', u'application': u'android', u'calc': {u'allowed_tariffs': {u'__park__': {...}}, u'distance': 1810.73, u'extra
 _distance_multiplier': 1.0, u'recalculated': False, u'time': 245.81740725040436}, u'city': u'\u041a\u0430\u0437\u0430\u043d\u044c', u'cost': None, u'created': '2018-01-09 12:06:27.763000', u'device_id': u'22f06c3cd04bf93d7b8864c32a759888f2d8b07d', u'dont_call': False, u'dont_sms': True, u'experiments': [u'address_change_logging', u'antifraud_fix_price', u'autoreorder_android', u'autoreorder_notifications', u'change_card_during_the_ride', u'direct_assignment', u'dynamic_transfer_price', u'feedback_user_chat', u'fiscal_receipt', u'fixed_price', u'forced_surge', u'hunger_time', u'new_stq', u'open_near_point_a', u'order_show_comment', u'payment_change', u'pool_tooltip', u'route_adjust', u'route_adjust_eta', u'routing_42', ...], ...}, u'order_info': {u'need_sync': True, u'source_point': [49.10721469999999, 55.7823999], u'statistics': {u'assign_route_time': 144.79, u'assign_surge': 1.0, u'corp_ride_report_sent': False, u'ride_report_sent': False, u'setcared': None, u'status_updates': [{..
 .}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]}, u'with_coupon': False}, ...}, 'etl_updated': '2018-04-19 20:40:07', 'id': '7452c580e33c4422ae581a9f48a9828a', 'order_created': '2018-01-09 12:06:27', 'updated': '2018-04-19 20:35:16'}])

      61     # FIXME yt.wrapper bug: https://st.yandex-team.ru/YT-7915, remove this?
      62     chunk = list(chunk)
      63
      64     insert_with_retries = try_except(exceptions=[YtError])(yt_client.insert_rows)
   -> 65     return insert_with_retries(path, chunk, update=True)

Vars:
  insert_with_retries = <function lib.decorators.decorated>
  path = '//home/taxi-dwh/raw/mdb/order_proc/2018-01-01'
  chunk = [{'doc': {u'_id': u'7452c580e33c4422ae581a9f48a9828a',
             u'aliases': [{u'due': '2018-01-09 12:10:00.000000',
               u'due_optimistic': None,
               u'generation': 1,
               u'id': u'dbae3b14bf7f4037bfe6aeca0a853ee5'}],
             u'autoreorder': {u'decisions': [{u'created': '2018-01-09 12:13:39.243000'}]},
             u'candidates': [{u'adjusted_point': {u'avg_speed': 0,
                u'direction': -1,
                u'geopoint': [49.10838367, 55.77712762],
                u'time': 1515499575},
               u'alias_id': u'dbae3b14bf7f4037bfe6aeca0a853ee5',
               u'ar': 0.5,
               u'cancel_attempts': 3,
               u'cancel_status': u'finished',
               u'car_color': u'\u0447\u0435\u0440\u043d\u044b\u0439',
               u'car_color_code': u'040001',
               u'car_model': u'LADA (\u0412\u0410\u0417) 2114',
               u'car_number': u'\u0420204\u0410\u0410116',
               u'ci': u'f8b9e6bc1b264e62a731ae6843234dc8',
               u'cr': 0.93,
               u'created': '2018-01-09 12:06:28.745000',
               u'db_id': u'eafd8352bb7249a0800739e70548f3ce',
               u'dbcar_id': u'cfae94a1d3c74db6845c54833ebc88f2',
               u'dist': 719.412,
               u'dm': None,
               u'dp': None,
               u'dp_values': {u'c': 1, u'r': -1},
               u'dr': None,
               u'driver_experiments': [u'assign_new_ui',
                u'clientdriver_chat_recognize_message',
                u'order_show_comment',
                u'partner_program_burger_king',
                u'proxy_gps_set_to_geotracks',
                u'show_traning'],
               u'driver_id': u'1956793037_05c6b0500fe545459c151ce3a98c7107',
               u'driver_license': u'1625458154',
               u'driverclientchat_enabled': True,
               u'dv': None,
               u'experiments': [u'proxy_gps_set_to_geotracks',
                u'show_traning',
                u'order_show_comment',
                u'assign_new_ui',
                u'clientdriver_chat_recognize_message',
                u'partner_program_burger_king'],
               u'gprs_time': 18.698,
               u'hd': True,
               u'is': True,
               u'last_failed_cancelrequest': '2018-01-09 12:15:30.782000',
               u'line_dist': 590.9570502302975,
               u'name': u'\u0411\u0443\u0448\u0443\u0435\u0432 \u0421\u0435\u0440\u0433\u0435\u0439 \u0421\u0435\u0440\u0433\u0435\u0435\u0432\u0438\u0447',
               u'ost': '2018-01-09 12:06:29.075000',
               u'phone': u'+79600673457',
               u'point': [49.10838367, 55.77712762],
               u'rd': True,
               u'requestcar_status': u'finished',
               u'setcared': '2018-01-09 12:06:29.075000',
               u'tariff_class': u'econom',
               u'tariff_currency': u'RUB',
               u'tariff_id': u'f8b9e6bc1b264e62a731ae6843234dc8',
               u'taximeter_version': u'8.44',
               u'time': 123.09,
               u'z': [u'dc4adce8fe134691a678c05174574905']},
              {u'cancel_status': u'finished',
               u'hd': True,
               u'ost': '2018-01-09 12:13:53.743000',
               u'requestcar_status': u'finished',
               u'setcared': '2018-01-09 12:13:53.743000'}],
             u'changes': {u'objects': [{u'c': '2018-01-09 12:10:41.011000',
                u'ci': u'a23e364afa6d4543942c1c42af945a5c',
                u'id': u'624886643c0c48b8a41b921a5486d692',
                u'n': u'user_ready',
                u's': u'applied',
                u'si': {u'c': 0, u's': u'delivered'},
                u't': '2018-01-09 12:10:39.000000',
                u'vl': False,
                u'vr': 4},
               {u'c': '2018-01-09 12:10:41.011000',
                u'ci': u'a23e364afa6d4543942c1c42af945a5c',
                u'id': u'ca2315d469c14ffd80b74657d6148b1b',
                u'n': u'user_ready',
                u's': u'applied',
                u'si': {u'c': 1, u's': u'delivered', u't': '2018-01-09 12:10:41.621000'},
                u't': '2018-01-09 12:10:39.000000',
                u'vl': True,
                u'vr': 4}]},
             u'created': '2018-01-09 12:06:27.869000',
             u'insurer_id': u'83d0d8e57b9242f7a7968653ecfe490b',
             u'lookup': {u'eta': '2018-01-09 12:13:39.696000',
              u'generation': 3,
              u'generation_updated': '2018-01-09 12:13:39.696000',
              u'name': u'direct_assignment',
              u'need_start': True,
              u'params': {},
              u'restart_eta': None,
              u'start_eta': '2018-01-09 12:13:39.243000',
              u'state': {},
              u'version': 2},
             u'order': {u'_type': u'soon',
              u'application': u'android',
              u'calc': {u'allowed_tariffs': {u'__park__': {u'business': 114.0,
                 u'econom': 65.0,
                 u'vip': 299.0}},
               u'distance': 1810.73,
               u'extra_distance_multiplier': 1.0,
               u'recalculated': False,
               u'time': 245.81740725040436},
              u'city': u'\u041a\u0430\u0437\u0430\u043d\u044c',
              u'cost': None,
              u'created': '2018-01-09 12:06:27.763000',
              u'device_id': u'22f06c3cd04bf93d7b8864c32a759888f2d8b07d',
              u'dont_call': False,
              u'dont_sms': True,
              u'experiments': [u'address_change_logging',
               u'antifraud_fix_price',
               u'autoreorder_android',
               u'autoreorder_notifications',
               u'change_card_during_the_ride',
               u'direct_assignment',
               u'dynamic_transfer_price',
               u'feedback_user_chat',
               u'fiscal_receipt',
               u'fixed_price',
               u'forced_surge',
               u'hunger_time',
               u'new_stq',
               u'open_near_point_a',
               u'order_show_comment',
               u'payment_change',
               u'pool_tooltip',
               u'route_adjust',
               u'route_adjust_eta',
               u'routing_42',
               u'surge_add_business',
               u'surge_distance',
               u'surgeprice',
               u'taximeter_complete',
               u'trash_test',
               u'user_position_enabled'],
              u'fixed_price': {u'destination': [49.095131, 55.771403],
               u'max_distance_from_b': 500,
               u'price': 65.0,
               u'show_price_in_taximeter': True},
              u'nz': u'kazan',
              u'operator_login': None,
              u'payment_tech': {u'debt': False,
               u'hold_initiated': False,
               u'last_known_ip': u'::ffff:85.140.2.34',
               u'main_card_billing_id': None,
               u'main_card_payment_id': None,
               u'main_card_persistent_id': None,
               u'need_cvn': False,
               u'type': u'cash'},
              u'referral_id': None,
              u'referral_timestamp': None,
              u'request': {u'class': [u'econom'],
               u'comment': u'',
               u'corp': {u'cost_center': None},
               u'destinations': [{u'country': u'\u0420\u043e\u0441\u0441\u0438\u044f',
                 u'description': u'\u041a\u0430\u0437\u0430\u043d\u044c, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u0420\u043e\u0441\u0441\u0438\u044f',
                 u'exact': True,
                 u'fullname': u'\u0420\u043e\u0441\u0441\u0438\u044f, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u041a\u0430\u0437\u0430\u043d\u044c, \u041f\u043e\u0440\u0442\u043e\u0432\u0430\u044f \u0443\u043b\u0438\u0446\u0430, 2',
                 u'geopoint': [49.095131, 55.771403],
                 u'locality': u'\u041a\u0430\u0437\u0430\u043d\u044c',
                 u'object_type': u'\u0434\u0440\u0443\u0433\u043e\u0435',
                 u'oid': u'56257878',
                 u'premisenumber': u'2',
                 u'short_text': u'\u041f\u043e\u0440\u0442\u043e\u0432\u0430\u044f \u0443\u043b\u0438\u0446\u0430, 2',
                 u'thoroughfare': u'\u041f\u043e\u0440\u0442\u043e\u0432\u0430\u044f \u0443\u043b\u0438\u0446\u0430',
                 u'type': u'address',
                 u'use_geopoint': False}],
               u'driverclientchat_enabled': False,
               u'due': '2018-01-09 12:10:00.000000',
               u'excluded_parks': [],
               u'ignore_excluded_parks': True,
               u'offer': u'475f8565697e42eea803b00f3cdb2277',
               u'payment': {u'payment_method_id': None, u'type': u'cash'},
               u'requirements': {},
               u'service_level': 50,
               u'source': {u'country': u'\u0420\u043e\u0441\u0441\u0438\u044f',
                u'description': u'\u041a\u0430\u0437\u0430\u043d\u044c, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u0420\u043e\u0441\u0441\u0438\u044f',
                u'exact': True,
                u'fullname': u'\u0420\u043e\u0441\u0441\u0438\u044f, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u041a\u0430\u0437\u0430\u043d\u044c, \u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430, 39',
                u'geopoint': [49.10721469999999, 55.7823999],
                u'locality': u'\u041a\u0430\u0437\u0430\u043d\u044c',
                u'object_type': u'\u0434\u0440\u0443\u0433\u043e\u0435',
                u'oid': u'56267164',
                u'premisenumber': u'39',
                u'short_text': u'\u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430, 39',
                u'thoroughfare': u'\u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430',
                u'type': u'address',
                u'use_geopoint': False},
               u'source_geoareas': [u'kazan_activation', u'kazan', u'Kazan'],
               u'source_raw': {u'country': u'\u0420\u043e\u0441\u0441\u0438\u044f',
                u'description': u'\u041a\u0430\u0437\u0430\u043d\u044c, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u0420\u043e\u0441\u0441\u0438\u044f',
                u'exact': True,
                u'fullname': u'\u0420\u043e\u0441\u0441\u0438\u044f, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u041a\u0430\u0437\u0430\u043d\u044c, \u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430, 39',
                u'geopoint': [49.10721469999999, 55.7823999],
                u'locality': u'\u041a\u0430\u0437\u0430\u043d\u044c',
                u'object_type': u'\u0434\u0440\u0443\u0433\u043e\u0435',
                u'oid': u'56267164',
                u'premisenumber': u'39',
                u'short_text': u'\u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430, 39',
                u'thoroughfare': u'\u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430',
                u'type': u'address',
                u'use_geopoint': False},
               u'sp': 1.0},
              u'rsk': u'1915db7bcfe04b3c8935924686be346e',
              u'status': u'cancelled',
              u'status_updated': '2018-01-09 12:15:21.466000',
              u'taxi_status': None,
              u'terminal_id': None,
              u'user_agent': u'yandex-taxi/3.50.1.15759 Android/5.1.1 (Micromax; Micromax Q415)',
              u'user_id': u'a23e364afa6d4543942c1c42af945a5c',
              u'user_locale': u'ru',
              u'user_phone_id': '5814aacb21586f10fe1657bd',
              u'user_ready': True,
              u'user_uid': u'577064411',
              u'vendor_id': None,
              u'version': 7},
             u'order_info': {u'need_sync': True,
              u'source_point': [49.10721469999999, 55.7823999],
              u'statistics': {u'assign_route_time': 144.79,
               u'assign_surge': 1.0,
               u'corp_ride_report_sent': False,
               u'ride_report_sent': False,
               u'setcared': None,
               u'status_updates': [{u'c': '2018-01-09 12:06:27.869000',
                 u'h': False,
                 u'q': u'create',
                 u's': u'pending'},
                {u'c': '2018-01-09 12:06:33.240000',
                 u'd': [49.10867526, 55.77697332],
                 u'h': False,
                 u'i': 0,
                 u'p': {u'avg_speed': 0.0,
                  u'direction': 0.0,
                  u'geopoint': [49.10867526, 55.77697332],
                  u'taxi_status': u'pending',
                  u'time': '2018-01-09 12:06:33.000000',
                  u'updated': '2018-01-09 12:06:33.240000'},
                 u'q': u'seen'},
                {u'c': '2018-01-09 12:06:35.135000',
                 u'g': 1,
                 u'h': False,
                 u'i': 0,
                 u's': u'assigned'},
                {u'c': '2018-01-09 12:06:35.135000',
                 u'd': [49.10867526, 55.77697332],
                 u'h': False,
                 u'i': 0,
                 u'l': 2482.0859375,
                 u'p': {u'avg_speed': 0.0,
                  u'direction': 0.0,
                  u'geopoint': [49.10867526, 55.77697332],
                  u'taxi_status': u'driving',
                  u'time': '2018-01-09 12:06:32.000000',
                  u'updated': '2018-01-09 09:06:34.000000'},
                 u't': u'driving'},
                {u'c': '2018-01-09 12:09:38.704000',
                 u'd': [49.10771589, 55.78201288],
                 u'h': False,
                 u'i': 0,
                 u'l': 733.6484375,
                 u'p': {u'avg_speed': 32.0,
                  u'direction': 326.5,
                  u'geopoint': [49.10771589, 55.78201288],
                  u'taxi_status': u'waiting',
                  u'time': '2018-01-09 12:09:34.000000',
                  u'updated': '2018-01-09 09:09:38.000000'},
                 u't': u'waiting'},
                {u'a': {u'comment_id': u'REFUSE_TO_COMPLETE_ORDER'},
                 u'c': '2018-01-09 12:13:39.243000',
                 u'd': [49.10704937, 55.78255993],
                 u'h': False,
                 u'i': 0,
                 u'q': u'autoreorder',
                 u'r': u'manual',
                 u's': u'pending',
                 u't': None},
                {u'c': '2018-01-09 12:14:50.967000',
                 u'h': True,
                 u'i': 1,
                 u'q': u'seen_timeout'},
                {u'c': '2018-01-09 12:15:21.466000',
                 u'fc': False,
                 u'h': True,
                 u's': u'cancelled'}]},
              u'with_coupon': False},
             u'order_link': u'60918985e03b4e968f5f167ec11f95db',
             u'performer': {u'alias_id': None,
              u'candidate_index': None,
              u'driver_id': None,
              u'need_sync': False,
              u'park_id': None,
              u'presetcar': False},
             u'processing': {u'version': 17},
             u'reorder': {u'decisions': [], u'suggestions': []},
             u'status': u'finished',
             u'trigger': {u's': {u'lookupinit': {u'last_called': '2018-01-09 12:13:39.696000'},
               u'seentimeout': {u'last_called': '2018-01-09 12:14:50.967000'}}},
             u'updated': '2018-04-19 20:35:16.650000'},
            'etl_updated': '2018-04-19 20:40:07',
            'id': '7452c580e33c4422ae581a9f48a9828a',
            'order_created': '2018-01-09 12:06:27',
            'updated': '2018-04-19 20:35:16'}]
  update is undefined
  builtin True = True

------------------------------
/home/robot-taxi-stat/etl/lib/decorators.py:
 in decorated(*args = ('//home/taxi-dwh/raw/mdb/order_proc/2018-01-01', [{'doc': {u'_id': u'7452c580e33c4422ae581a9f48a9828a', u'aliases': [{u'due': '2018-01-09 12:10:00.000000', u'due_optimistic': None, u'generation': 1, u'id': u'dbae3b14bf7f4037bfe6aeca0a853ee5'}], u'autoreorder': {u'decisions': [{...}]}, u'candidates': [{u'adjusted_point': {...}, u'alias_id': u'dbae3b14bf7f4037bfe6aeca0a853ee5', u'ar': 0.5, u'cancel_attempts': 3, u'cancel_status': u'finished', u'car_color': u'\u0447\u0435\u0440\u043d\u044b\u0439', u'car_color_code': u'040001', u'car_model': u'LADA (\u0412\u0410\u0417) 2114', u'car_number': u'\u0420204\u0410\u0410116', u'ci': u'f8b9e6bc1b264e62a731ae6843234dc8', ...}, {u'cancel_status': u'finished', u'hd': True, u'ost': '2018-01-09 12:13:53.743000', u'requestcar_status': u'finished', u'setcared': '2018-01-09 12:13:53.743000'}], u'changes': {u'objects': [{...}, {...}]}, u'created': '2018-01-09 12:06:27.869000', u'insurer_id': u'83d0d8e57b9242f7a7968653ecfe490b', u'l
 ookup': {u'eta': '2018-01-09 12:13:39.696000', u'generation': 3, u'generation_updated': '2018-01-09 12:13:39.696000', u'name': u'direct_assignment', u'need_start': True, u'params': {}, u'restart_eta': None, u'start_eta': '2018-01-09 12:13:39.243000', u'state': {}, u'version': 2}, u'order': {u'_type': u'soon', u'application': u'android', u'calc': {u'allowed_tariffs': {...}, u'distance': 1810.73, u'extra_distance_multiplier': 1.0, u'recalculated': False, u'time': 245.81740725040436}, u'city': u'\u041a\u0430\u0437\u0430\u043d\u044c', u'cost': None, u'created': '2018-01-09 12:06:27.763000', u'device_id': u'22f06c3cd04bf93d7b8864c32a759888f2d8b07d', u'dont_call': False, u'dont_sms': True, u'experiments': [u'address_change_logging', u'antifraud_fix_price', u'autoreorder_android', u'autoreorder_notifications', u'change_card_during_the_ride', u'direct_assignment', u'dynamic_transfer_price', u'feedback_user_chat', u'fiscal_receipt', u'fixed_price', u'forced_surge', u'hunger_time', u'new_stq'
 , u'open_near_point_a', u'order_show_comment', u'payment_change', u'pool_tooltip', u'route_adjust', u'route_adjust_eta', u'routing_42', ...], ...}, u'order_info': {u'need_sync': True, u'source_point': [49.10721469999999, 55.7823999], u'statistics': {u'assign_route_time': 144.79, u'assign_surge': 1.0, u'corp_ride_report_sent': False, u'ride_report_sent': False, u'setcared': None, u'status_updates': [...]}, u'with_coupon': False}, ...}, 'etl_updated': '2018-04-19 20:40:07', 'id': '7452c580e33c4422ae581a9f48a9828a', 'order_created': '2018-01-09 12:06:27', 'updated': '2018-04-19 20:35:16'}]), **kwargs = {'update': True})

      18             for attempt in xrange(times):
      19                 try:
   -> 20                     result = fn(*args, **kwargs)
      21                     return result
      22                 except exceptions:

Vars:
  result is undefined
  fn = <bound method YtClient.insert_rows of <yt.wrapper.client.YtClient object at 0x7f8668ab3f90>>
  args = ('//home/taxi-dwh/raw/mdb/order_proc/2018-01-01',
          [{'doc': {u'_id': u'7452c580e33c4422ae581a9f48a9828a',
             u'aliases': [{u'due': '2018-01-09 12:10:00.000000',
               u'due_optimistic': None,
               u'generation': 1,
               u'id': u'dbae3b14bf7f4037bfe6aeca0a853ee5'}],
             u'autoreorder': {u'decisions': [{u'created': '2018-01-09 12:13:39.243000'}]},
             u'candidates': [{u'adjusted_point': {u'avg_speed': 0,
                u'direction': -1,
                u'geopoint': [49.10838367, 55.77712762],
                u'time': 1515499575},
               u'alias_id': u'dbae3b14bf7f4037bfe6aeca0a853ee5',
               u'ar': 0.5,
               u'cancel_attempts': 3,
               u'cancel_status': u'finished',
               u'car_color': u'\u0447\u0435\u0440\u043d\u044b\u0439',
               u'car_color_code': u'040001',
               u'car_model': u'LADA (\u0412\u0410\u0417) 2114',
               u'car_number': u'\u0420204\u0410\u0410116',
               u'ci': u'f8b9e6bc1b264e62a731ae6843234dc8',
               u'cr': 0.93,
               u'created': '2018-01-09 12:06:28.745000',
               u'db_id': u'eafd8352bb7249a0800739e70548f3ce',
               u'dbcar_id': u'cfae94a1d3c74db6845c54833ebc88f2',
               u'dist': 719.412,
               u'dm': None,
               u'dp': None,
               u'dp_values': {u'c': 1, u'r': -1},
               u'dr': None,
               u'driver_experiments': [u'assign_new_ui',
                u'clientdriver_chat_recognize_message',
                u'order_show_comment',
                u'partner_program_burger_king',
                u'proxy_gps_set_to_geotracks',
                u'show_traning'],
               u'driver_id': u'1956793037_05c6b0500fe545459c151ce3a98c7107',
               u'driver_license': u'1625458154',
               u'driverclientchat_enabled': True,
               u'dv': None,
               u'experiments': [u'proxy_gps_set_to_geotracks',
                u'show_traning',
                u'order_show_comment',
                u'assign_new_ui',
                u'clientdriver_chat_recognize_message',
                u'partner_program_burger_king'],
               u'gprs_time': 18.698,
               u'hd': True,
               u'is': True,
               u'last_failed_cancelrequest': '2018-01-09 12:15:30.782000',
               u'line_dist': 590.9570502302975,
               u'name': u'\u0411\u0443\u0448\u0443\u0435\u0432 \u0421\u0435\u0440\u0433\u0435\u0439 \u0421\u0435\u0440\u0433\u0435\u0435\u0432\u0438\u0447',
               u'ost': '2018-01-09 12:06:29.075000',
               u'phone': u'+79600673457',
               u'point': [49.10838367, 55.77712762],
               u'rd': True,
               u'requestcar_status': u'finished',
               u'setcared': '2018-01-09 12:06:29.075000',
               u'tariff_class': u'econom',
               u'tariff_currency': u'RUB',
               u'tariff_id': u'f8b9e6bc1b264e62a731ae6843234dc8',
               u'taximeter_version': u'8.44',
               u'time': 123.09,
               u'z': [u'dc4adce8fe134691a678c05174574905']},
              {u'cancel_status': u'finished',
               u'hd': True,
               u'ost': '2018-01-09 12:13:53.743000',
               u'requestcar_status': u'finished',
               u'setcared': '2018-01-09 12:13:53.743000'}],
             u'changes': {u'objects': [{u'c': '2018-01-09 12:10:41.011000',
                u'ci': u'a23e364afa6d4543942c1c42af945a5c',
                u'id': u'624886643c0c48b8a41b921a5486d692',
                u'n': u'user_ready',
                u's': u'applied',
                u'si': {u'c': 0, u's': u'delivered'},
                u't': '2018-01-09 12:10:39.000000',
                u'vl': False,
                u'vr': 4},
               {u'c': '2018-01-09 12:10:41.011000',
                u'ci': u'a23e364afa6d4543942c1c42af945a5c',
                u'id': u'ca2315d469c14ffd80b74657d6148b1b',
                u'n': u'user_ready',
                u's': u'applied',
                u'si': {u'c': 1,
                 u's': u'delivered',
                 u't': '2018-01-09 12:10:41.621000'},
                u't': '2018-01-09 12:10:39.000000',
                u'vl': True,
                u'vr': 4}]},
             u'created': '2018-01-09 12:06:27.869000',
             u'insurer_id': u'83d0d8e57b9242f7a7968653ecfe490b',
             u'lookup': {u'eta': '2018-01-09 12:13:39.696000',
              u'generation': 3,
              u'generation_updated': '2018-01-09 12:13:39.696000',
              u'name': u'direct_assignment',
              u'need_start': True,
              u'params': {},
              u'restart_eta': None,
              u'start_eta': '2018-01-09 12:13:39.243000',
              u'state': {},
              u'version': 2},
             u'order': {u'_type': u'soon',
              u'application': u'android',
              u'calc': {u'allowed_tariffs': {u'__park__': {u'business': 114.0,
                 u'econom': 65.0,
                 u'vip': 299.0}},
               u'distance': 1810.73,
               u'extra_distance_multiplier': 1.0,
               u'recalculated': False,
               u'time': 245.81740725040436},
              u'city': u'\u041a\u0430\u0437\u0430\u043d\u044c',
              u'cost': None,
              u'created': '2018-01-09 12:06:27.763000',
              u'device_id': u'22f06c3cd04bf93d7b8864c32a759888f2d8b07d',
              u'dont_call': False,
              u'dont_sms': True,
              u'experiments': [u'address_change_logging',
               u'antifraud_fix_price',
               u'autoreorder_android',
               u'autoreorder_notifications',
               u'change_card_during_the_ride',
               u'direct_assignment',
               u'dynamic_transfer_price',
               u'feedback_user_chat',
               u'fiscal_receipt',
               u'fixed_price',
               u'forced_surge',
               u'hunger_time',
               u'new_stq',
               u'open_near_point_a',
               u'order_show_comment',
               u'payment_change',
               u'pool_tooltip',
               u'route_adjust',
               u'route_adjust_eta',
               u'routing_42',
               u'surge_add_business',
               u'surge_distance',
               u'surgeprice',
               u'taximeter_complete',
               u'trash_test',
               u'user_position_enabled'],
              u'fixed_price': {u'destination': [49.095131, 55.771403],
               u'max_distance_from_b': 500,
               u'price': 65.0,
               u'show_price_in_taximeter': True},
              u'nz': u'kazan',
              u'operator_login': None,
              u'payment_tech': {u'debt': False,
               u'hold_initiated': False,
               u'last_known_ip': u'::ffff:85.140.2.34',
               u'main_card_billing_id': None,
               u'main_card_payment_id': None,
               u'main_card_persistent_id': None,
               u'need_cvn': False,
               u'type': u'cash'},
              u'referral_id': None,
              u'referral_timestamp': None,
              u'request': {u'class': [u'econom'],
               u'comment': u'',
               u'corp': {u'cost_center': None},
               u'destinations': [{u'country': u'\u0420\u043e\u0441\u0441\u0438\u044f',
                 u'description': u'\u041a\u0430\u0437\u0430\u043d\u044c, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u0420\u043e\u0441\u0441\u0438\u044f',
                 u'exact': True,
                 u'fullname': u'\u0420\u043e\u0441\u0441\u0438\u044f, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u041a\u0430\u0437\u0430\u043d\u044c, \u041f\u043e\u0440\u0442\u043e\u0432\u0430\u044f \u0443\u043b\u0438\u0446\u0430, 2',
                 u'geopoint': [49.095131, 55.771403],
                 u'locality': u'\u041a\u0430\u0437\u0430\u043d\u044c',
                 u'object_type': u'\u0434\u0440\u0443\u0433\u043e\u0435',
                 u'oid': u'56257878',
                 u'premisenumber': u'2',
                 u'short_text': u'\u041f\u043e\u0440\u0442\u043e\u0432\u0430\u044f \u0443\u043b\u0438\u0446\u0430, 2',
                 u'thoroughfare': u'\u041f\u043e\u0440\u0442\u043e\u0432\u0430\u044f \u0443\u043b\u0438\u0446\u0430',
                 u'type': u'address',
                 u'use_geopoint': False}],
               u'driverclientchat_enabled': False,
               u'due': '2018-01-09 12:10:00.000000',
               u'excluded_parks': [],
               u'ignore_excluded_parks': True,
               u'offer': u'475f8565697e42eea803b00f3cdb2277',
               u'payment': {u'payment_method_id': None, u'type': u'cash'},
               u'requirements': {},
               u'service_level': 50,
               u'source': {u'country': u'\u0420\u043e\u0441\u0441\u0438\u044f',
                u'description': u'\u041a\u0430\u0437\u0430\u043d\u044c, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u0420\u043e\u0441\u0441\u0438\u044f',
                u'exact': True,
                u'fullname': u'\u0420\u043e\u0441\u0441\u0438\u044f, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u041a\u0430\u0437\u0430\u043d\u044c, \u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430, 39',
                u'geopoint': [49.10721469999999, 55.7823999],
                u'locality': u'\u041a\u0430\u0437\u0430\u043d\u044c',
                u'object_type': u'\u0434\u0440\u0443\u0433\u043e\u0435',
                u'oid': u'56267164',
                u'premisenumber': u'39',
                u'short_text': u'\u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430, 39',
                u'thoroughfare': u'\u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430',
                u'type': u'address',
                u'use_geopoint': False},
               u'source_geoareas': [u'kazan_activation', u'kazan', u'Kazan'],
               u'source_raw': {u'country': u'\u0420\u043e\u0441\u0441\u0438\u044f',
                u'description': u'\u041a\u0430\u0437\u0430\u043d\u044c, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u0420\u043e\u0441\u0441\u0438\u044f',
                u'exact': True,
                u'fullname': u'\u0420\u043e\u0441\u0441\u0438\u044f, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u041a\u0430\u0437\u0430\u043d\u044c, \u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430, 39',
                u'geopoint': [49.10721469999999, 55.7823999],
                u'locality': u'\u041a\u0430\u0437\u0430\u043d\u044c',
                u'object_type': u'\u0434\u0440\u0443\u0433\u043e\u0435',
                u'oid': u'56267164',
                u'premisenumber': u'39',
                u'short_text': u'\u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430, 39',
                u'thoroughfare': u'\u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430',
                u'type': u'address',
                u'use_geopoint': False},
               u'sp': 1.0},
              u'rsk': u'1915db7bcfe04b3c8935924686be346e',
              u'status': u'cancelled',
              u'status_updated': '2018-01-09 12:15:21.466000',
              u'taxi_status': None,
              u'terminal_id': None,
              u'user_agent': u'yandex-taxi/3.50.1.15759 Android/5.1.1 (Micromax; Micromax Q415)',
              u'user_id': u'a23e364afa6d4543942c1c42af945a5c',
              u'user_locale': u'ru',
              u'user_phone_id': '5814aacb21586f10fe1657bd',
              u'user_ready': True,
              u'user_uid': u'577064411',
              u'vendor_id': None,
              u'version': 7},
             u'order_info': {u'need_sync': True,
              u'source_point': [49.10721469999999, 55.7823999],
              u'statistics': {u'assign_route_time': 144.79,
               u'assign_surge': 1.0,
               u'corp_ride_report_sent': False,
               u'ride_report_sent': False,
               u'setcared': None,
               u'status_updates': [{u'c': '2018-01-09 12:06:27.869000',
                 u'h': False,
                 u'q': u'create',
                 u's': u'pending'},
                {u'c': '2018-01-09 12:06:33.240000',
                 u'd': [49.10867526, 55.77697332],
                 u'h': False,
                 u'i': 0,
                 u'p': {u'avg_speed': 0.0,
                  u'direction': 0.0,
                  u'geopoint': [49.10867526, 55.77697332],
                  u'taxi_status': u'pending',
                  u'time': '2018-01-09 12:06:33.000000',
                  u'updated': '2018-01-09 12:06:33.240000'},
                 u'q': u'seen'},
                {u'c': '2018-01-09 12:06:35.135000',
                 u'g': 1,
                 u'h': False,
                 u'i': 0,
                 u's': u'assigned'},
                {u'c': '2018-01-09 12:06:35.135000',
                 u'd': [49.10867526, 55.77697332],
                 u'h': False,
                 u'i': 0,
                 u'l': 2482.0859375,
                 u'p': {u'avg_speed': 0.0,
                  u'direction': 0.0,
                  u'geopoint': [49.10867526, 55.77697332],
                  u'taxi_status': u'driving',
                  u'time': '2018-01-09 12:06:32.000000',
                  u'updated': '2018-01-09 09:06:34.000000'},
                 u't': u'driving'},
                {u'c': '2018-01-09 12:09:38.704000',
                 u'd': [49.10771589, 55.78201288],
                 u'h': False,
                 u'i': 0,
                 u'l': 733.6484375,
                 u'p': {u'avg_speed': 32.0,
                  u'direction': 326.5,
                  u'geopoint': [49.10771589, 55.78201288],
                  u'taxi_status': u'waiting',
                  u'time': '2018-01-09 12:09:34.000000',
                  u'updated': '2018-01-09 09:09:38.000000'},
                 u't': u'waiting'},
                {u'a': {u'comment_id': u'REFUSE_TO_COMPLETE_ORDER'},
                 u'c': '2018-01-09 12:13:39.243000',
                 u'd': [49.10704937, 55.78255993],
                 u'h': False,
                 u'i': 0,
                 u'q': u'autoreorder',
                 u'r': u'manual',
                 u's': u'pending',
                 u't': None},
                {u'c': '2018-01-09 12:14:50.967000',
                 u'h': True,
                 u'i': 1,
                 u'q': u'seen_timeout'},
                {u'c': '2018-01-09 12:15:21.466000',
                 u'fc': False,
                 u'h': True,
                 u's': u'cancelled'}]},
              u'with_coupon': False},
             u'order_link': u'60918985e03b4e968f5f167ec11f95db',
             u'performer': {u'alias_id': None,
              u'candidate_index': None,
              u'driver_id': None,
              u'need_sync': False,
              u'park_id': None,
              u'presetcar': False},
             u'processing': {u'version': 17},
             u'reorder': {u'decisions': [], u'suggestions': []},
             u'status': u'finished',
             u'trigger': {u's': {u'lookupinit': {u'last_called': '2018-01-09 12:13:39.696000'},
               u'seentimeout': {u'last_called': '2018-01-09 12:14:50.967000'}}},
             u'updated': '2018-04-19 20:35:16.650000'},
            'etl_updated': '2018-04-19 20:40:07',
            'id': '7452c580e33c4422ae581a9f48a9828a',
            'order_created': '2018-01-09 12:06:27',
            'updated': '2018-04-19 20:35:16'}])
  kwargs = {'update': True}

------------------------------
/home/robot-taxi-stat/<decorator-gen-83>:
 in insert_rows(self = <yt.wrapper.client.YtClient object>, table = '//home/taxi-dwh/raw/mdb/order_proc/2018-01-01', input_stream = [{'doc': {u'_id': u'7452c580e33c4422ae581a9f48a9828a', u'aliases': [{u'due': '2018-01-09 12:10:00.000000', u'due_optimistic': None, u'generation': 1, u'id': u'dbae3b14bf7f4037bfe6aeca0a853ee5'}], u'autoreorder': {u'decisions': [{u'created': '2018-01-09 12:13:39.243000'}]}, u'candidates': [{u'adjusted_point': {u'avg_speed': 0, u'direction': -1, u'geopoint': [...], u'time': 1515499575}, u'alias_id': u'dbae3b14bf7f4037bfe6aeca0a853ee5', u'ar': 0.5, u'cancel_attempts': 3, u'cancel_status': u'finished', u'car_color': u'\u0447\u0435\u0440\u043d\u044b\u0439', u'car_color_code': u'040001', u'car_model': u'LADA (\u0412\u0410\u0417) 2114', u'car_number': u'\u0420204\u0410\u0410116', u'ci': u'f8b9e6bc1b264e62a731ae6843234dc8', ...}, {u'cancel_status': u'finished', u'hd': True, u'ost': '2018-01-09 12:13:53.743000', u'requestcar_status': u'finished', u'setcared': '20
 18-01-09 12:13:53.743000'}], u'changes': {u'objects': [{u'c': '2018-01-09 12:10:41.011000', u'ci': u'a23e364afa6d4543942c1c42af945a5c', u'id': u'624886643c0c48b8a41b921a5486d692', u'n': u'user_ready', u's': u'applied', u'si': {...}, u't': '2018-01-09 12:10:39.000000', u'vl': False, u'vr': 4}, {u'c': '2018-01-09 12:10:41.011000', u'ci': u'a23e364afa6d4543942c1c42af945a5c', u'id': u'ca2315d469c14ffd80b74657d6148b1b', u'n': u'user_ready', u's': u'applied', u'si': {...}, u't': '2018-01-09 12:10:39.000000', u'vl': True, u'vr': 4}]}, u'created': '2018-01-09 12:06:27.869000', u'insurer_id': u'83d0d8e57b9242f7a7968653ecfe490b', u'lookup': {u'eta': '2018-01-09 12:13:39.696000', u'generation': 3, u'generation_updated': '2018-01-09 12:13:39.696000', u'name': u'direct_assignment', u'need_start': True, u'params': {}, u'restart_eta': None, u'start_eta': '2018-01-09 12:13:39.243000', u'state': {}, u'version': 2}, u'order': {u'_type': u'soon', u'application': u'android', u'calc': {u'allowed_tariffs
 ': {u'__park__': {...}}, u'distance': 1810.73, u'extra_distance_multiplier': 1.0, u'recalculated': False, u'time': 245.81740725040436}, u'city': u'\u041a\u0430\u0437\u0430\u043d\u044c', u'cost': None, u'created': '2018-01-09 12:06:27.763000', u'device_id': u'22f06c3cd04bf93d7b8864c32a759888f2d8b07d', u'dont_call': False, u'dont_sms': True, u'experiments': [u'address_change_logging', u'antifraud_fix_price', u'autoreorder_android', u'autoreorder_notifications', u'change_card_during_the_ride', u'direct_assignment', u'dynamic_transfer_price', u'feedback_user_chat', u'fiscal_receipt', u'fixed_price', u'forced_surge', u'hunger_time', u'new_stq', u'open_near_point_a', u'order_show_comment', u'payment_change', u'pool_tooltip', u'route_adjust', u'route_adjust_eta', u'routing_42', ...], ...}, u'order_info': {u'need_sync': True, u'source_point': [49.10721469999999, 55.7823999], u'statistics': {u'assign_route_time': 144.79, u'assign_surge': 1.0, u'corp_ride_report_sent': False, u'ride_report_se
 nt': False, u'setcared': None, u'status_updates': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]}, u'with_coupon': False}, ...}, 'etl_updated': '2018-04-19 20:40:07', 'id': '7452c580e33c4422ae581a9f48a9828a', 'order_created': '2018-01-09 12:06:27', 'updated': '2018-04-19 20:35:16'}], update = True, aggregate = None, atomicity = None, durability = None, format = None, raw = None, require_sync_replica = None)


Vars:

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/client_helpers.py:
 in decorator(self = <yt.wrapper.client.YtClient object>, *args = ('//home/taxi-dwh/raw/mdb/order_proc/2018-01-01', [{'doc': {u'_id': u'7452c580e33c4422ae581a9f48a9828a', u'aliases': [{u'due': '2018-01-09 12:10:00.000000', u'due_optimistic': None, u'generation': 1, u'id': u'dbae3b14bf7f4037bfe6aeca0a853ee5'}], u'autoreorder': {u'decisions': [{...}]}, u'candidates': [{u'adjusted_point': {...}, u'alias_id': u'dbae3b14bf7f4037bfe6aeca0a853ee5', u'ar': 0.5, u'cancel_attempts': 3, u'cancel_status': u'finished', u'car_color': u'\u0447\u0435\u0440\u043d\u044b\u0439', u'car_color_code': u'040001', u'car_model': u'LADA (\u0412\u0410\u0417) 2114', u'car_number': u'\u0420204\u0410\u0410116', u'ci': u'f8b9e6bc1b264e62a731ae6843234dc8', ...}, {u'cancel_status': u'finished', u'hd': True, u'ost': '2018-01-09 12:13:53.743000', u'requestcar_status': u'finished', u'setcared': '2018-01-09 12:13:53.743000'}], u'changes': {u'objects': [{...}, {...}]}, u'created': '2018-01-09 12:06:27.869000', u'insurer_i
 d': u'83d0d8e57b9242f7a7968653ecfe490b', u'lookup': {u'eta': '2018-01-09 12:13:39.696000', u'generation': 3, u'generation_updated': '2018-01-09 12:13:39.696000', u'name': u'direct_assignment', u'need_start': True, u'params': {}, u'restart_eta': None, u'start_eta': '2018-01-09 12:13:39.243000', u'state': {}, u'version': 2}, u'order': {u'_type': u'soon', u'application': u'android', u'calc': {u'allowed_tariffs': {...}, u'distance': 1810.73, u'extra_distance_multiplier': 1.0, u'recalculated': False, u'time': 245.81740725040436}, u'city': u'\u041a\u0430\u0437\u0430\u043d\u044c', u'cost': None, u'created': '2018-01-09 12:06:27.763000', u'device_id': u'22f06c3cd04bf93d7b8864c32a759888f2d8b07d', u'dont_call': False, u'dont_sms': True, u'experiments': [u'address_change_logging', u'antifraud_fix_price', u'autoreorder_android', u'autoreorder_notifications', u'change_card_during_the_ride', u'direct_assignment', u'dynamic_transfer_price', u'feedback_user_chat', u'fiscal_receipt', u'fixed_price',
  u'forced_surge', u'hunger_time', u'new_stq', u'open_near_point_a', u'order_show_comment', u'payment_change', u'pool_tooltip', u'route_adjust', u'route_adjust_eta', u'routing_42', ...], ...}, u'order_info': {u'need_sync': True, u'source_point': [49.10721469999999, 55.7823999], u'statistics': {u'assign_route_time': 144.79, u'assign_surge': 1.0, u'corp_ride_report_sent': False, u'ride_report_sent': False, u'setcared': None, u'status_updates': [...]}, u'with_coupon': False}, ...}, 'etl_updated': '2018-04-19 20:40:07', 'id': '7452c580e33c4422ae581a9f48a9828a', 'order_created': '2018-01-09 12:06:27', 'updated': '2018-04-19 20:35:16'}], True, None, None, None, None, None, None), **kwargs = {})

      46     original_func = func
      47     def decorator(self, *args, **kwargs):
   -> 48         return original_func(*args, client=self, **kwargs)
      49
      50     is_class = False

Vars:
  original_func = <function yt.wrapper.dynamic_table_commands.insert_rows>
  args = ('//home/taxi-dwh/raw/mdb/order_proc/2018-01-01',
          [{'doc': {u'_id': u'7452c580e33c4422ae581a9f48a9828a',
             u'aliases': [{u'due': '2018-01-09 12:10:00.000000',
               u'due_optimistic': None,
               u'generation': 1,
               u'id': u'dbae3b14bf7f4037bfe6aeca0a853ee5'}],
             u'autoreorder': {u'decisions': [{u'created': '2018-01-09 12:13:39.243000'}]},
             u'candidates': [{u'adjusted_point': {u'avg_speed': 0,
                u'direction': -1,
                u'geopoint': [49.10838367, 55.77712762],
                u'time': 1515499575},
               u'alias_id': u'dbae3b14bf7f4037bfe6aeca0a853ee5',
               u'ar': 0.5,
               u'cancel_attempts': 3,
               u'cancel_status': u'finished',
               u'car_color': u'\u0447\u0435\u0440\u043d\u044b\u0439',
               u'car_color_code': u'040001',
               u'car_model': u'LADA (\u0412\u0410\u0417) 2114',
               u'car_number': u'\u0420204\u0410\u0410116',
               u'ci': u'f8b9e6bc1b264e62a731ae6843234dc8',
               u'cr': 0.93,
               u'created': '2018-01-09 12:06:28.745000',
               u'db_id': u'eafd8352bb7249a0800739e70548f3ce',
               u'dbcar_id': u'cfae94a1d3c74db6845c54833ebc88f2',
               u'dist': 719.412,
               u'dm': None,
               u'dp': None,
               u'dp_values': {u'c': 1, u'r': -1},
               u'dr': None,
               u'driver_experiments': [u'assign_new_ui',
                u'clientdriver_chat_recognize_message',
                u'order_show_comment',
                u'partner_program_burger_king',
                u'proxy_gps_set_to_geotracks',
                u'show_traning'],
               u'driver_id': u'1956793037_05c6b0500fe545459c151ce3a98c7107',
               u'driver_license': u'1625458154',
               u'driverclientchat_enabled': True,
               u'dv': None,
               u'experiments': [u'proxy_gps_set_to_geotracks',
                u'show_traning',
                u'order_show_comment',
                u'assign_new_ui',
                u'clientdriver_chat_recognize_message',
                u'partner_program_burger_king'],
               u'gprs_time': 18.698,
               u'hd': True,
               u'is': True,
               u'last_failed_cancelrequest': '2018-01-09 12:15:30.782000',
               u'line_dist': 590.9570502302975,
               u'name': u'\u0411\u0443\u0448\u0443\u0435\u0432 \u0421\u0435\u0440\u0433\u0435\u0439 \u0421\u0435\u0440\u0433\u0435\u0435\u0432\u0438\u0447',
               u'ost': '2018-01-09 12:06:29.075000',
               u'phone': u'+79600673457',
               u'point': [49.10838367, 55.77712762],
               u'rd': True,
               u'requestcar_status': u'finished',
               u'setcared': '2018-01-09 12:06:29.075000',
               u'tariff_class': u'econom',
               u'tariff_currency': u'RUB',
               u'tariff_id': u'f8b9e6bc1b264e62a731ae6843234dc8',
               u'taximeter_version': u'8.44',
               u'time': 123.09,
               u'z': [u'dc4adce8fe134691a678c05174574905']},
              {u'cancel_status': u'finished',
               u'hd': True,
               u'ost': '2018-01-09 12:13:53.743000',
               u'requestcar_status': u'finished',
               u'setcared': '2018-01-09 12:13:53.743000'}],
             u'changes': {u'objects': [{u'c': '2018-01-09 12:10:41.011000',
                u'ci': u'a23e364afa6d4543942c1c42af945a5c',
                u'id': u'624886643c0c48b8a41b921a5486d692',
                u'n': u'user_ready',
                u's': u'applied',
                u'si': {u'c': 0, u's': u'delivered'},
                u't': '2018-01-09 12:10:39.000000',
                u'vl': False,
                u'vr': 4},
               {u'c': '2018-01-09 12:10:41.011000',
                u'ci': u'a23e364afa6d4543942c1c42af945a5c',
                u'id': u'ca2315d469c14ffd80b74657d6148b1b',
                u'n': u'user_ready',
                u's': u'applied',
                u'si': {u'c': 1,
                 u's': u'delivered',
                 u't': '2018-01-09 12:10:41.621000'},
                u't': '2018-01-09 12:10:39.000000',
                u'vl': True,
                u'vr': 4}]},
             u'created': '2018-01-09 12:06:27.869000',
             u'insurer_id': u'83d0d8e57b9242f7a7968653ecfe490b',
             u'lookup': {u'eta': '2018-01-09 12:13:39.696000',
              u'generation': 3,
              u'generation_updated': '2018-01-09 12:13:39.696000',
              u'name': u'direct_assignment',
              u'need_start': True,
              u'params': {},
              u'restart_eta': None,
              u'start_eta': '2018-01-09 12:13:39.243000',
              u'state': {},
              u'version': 2},
             u'order': {u'_type': u'soon',
              u'application': u'android',
              u'calc': {u'allowed_tariffs': {u'__park__': {u'business': 114.0,
                 u'econom': 65.0,
                 u'vip': 299.0}},
               u'distance': 1810.73,
               u'extra_distance_multiplier': 1.0,
               u'recalculated': False,
               u'time': 245.81740725040436},
              u'city': u'\u041a\u0430\u0437\u0430\u043d\u044c',
              u'cost': None,
              u'created': '2018-01-09 12:06:27.763000',
              u'device_id': u'22f06c3cd04bf93d7b8864c32a759888f2d8b07d',
              u'dont_call': False,
              u'dont_sms': True,
              u'experiments': [u'address_change_logging',
               u'antifraud_fix_price',
               u'autoreorder_android',
               u'autoreorder_notifications',
               u'change_card_during_the_ride',
               u'direct_assignment',
               u'dynamic_transfer_price',
               u'feedback_user_chat',
               u'fiscal_receipt',
               u'fixed_price',
               u'forced_surge',
               u'hunger_time',
               u'new_stq',
               u'open_near_point_a',
               u'order_show_comment',
               u'payment_change',
               u'pool_tooltip',
               u'route_adjust',
               u'route_adjust_eta',
               u'routing_42',
               u'surge_add_business',
               u'surge_distance',
               u'surgeprice',
               u'taximeter_complete',
               u'trash_test',
               u'user_position_enabled'],
              u'fixed_price': {u'destination': [49.095131, 55.771403],
               u'max_distance_from_b': 500,
               u'price': 65.0,
               u'show_price_in_taximeter': True},
              u'nz': u'kazan',
              u'operator_login': None,
              u'payment_tech': {u'debt': False,
               u'hold_initiated': False,
               u'last_known_ip': u'::ffff:85.140.2.34',
               u'main_card_billing_id': None,
               u'main_card_payment_id': None,
               u'main_card_persistent_id': None,
               u'need_cvn': False,
               u'type': u'cash'},
              u'referral_id': None,
              u'referral_timestamp': None,
              u'request': {u'class': [u'econom'],
               u'comment': u'',
               u'corp': {u'cost_center': None},
               u'destinations': [{u'country': u'\u0420\u043e\u0441\u0441\u0438\u044f',
                 u'description': u'\u041a\u0430\u0437\u0430\u043d\u044c, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u0420\u043e\u0441\u0441\u0438\u044f',
                 u'exact': True,
                 u'fullname': u'\u0420\u043e\u0441\u0441\u0438\u044f, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u041a\u0430\u0437\u0430\u043d\u044c, \u041f\u043e\u0440\u0442\u043e\u0432\u0430\u044f \u0443\u043b\u0438\u0446\u0430, 2',
                 u'geopoint': [49.095131, 55.771403],
                 u'locality': u'\u041a\u0430\u0437\u0430\u043d\u044c',
                 u'object_type': u'\u0434\u0440\u0443\u0433\u043e\u0435',
                 u'oid': u'56257878',
                 u'premisenumber': u'2',
                 u'short_text': u'\u041f\u043e\u0440\u0442\u043e\u0432\u0430\u044f \u0443\u043b\u0438\u0446\u0430, 2',
                 u'thoroughfare': u'\u041f\u043e\u0440\u0442\u043e\u0432\u0430\u044f \u0443\u043b\u0438\u0446\u0430',
                 u'type': u'address',
                 u'use_geopoint': False}],
               u'driverclientchat_enabled': False,
               u'due': '2018-01-09 12:10:00.000000',
               u'excluded_parks': [],
               u'ignore_excluded_parks': True,
               u'offer': u'475f8565697e42eea803b00f3cdb2277',
               u'payment': {u'payment_method_id': None, u'type': u'cash'},
               u'requirements': {},
               u'service_level': 50,
               u'source': {u'country': u'\u0420\u043e\u0441\u0441\u0438\u044f',
                u'description': u'\u041a\u0430\u0437\u0430\u043d\u044c, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u0420\u043e\u0441\u0441\u0438\u044f',
                u'exact': True,
                u'fullname': u'\u0420\u043e\u0441\u0441\u0438\u044f, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u041a\u0430\u0437\u0430\u043d\u044c, \u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430, 39',
                u'geopoint': [49.10721469999999, 55.7823999],
                u'locality': u'\u041a\u0430\u0437\u0430\u043d\u044c',
                u'object_type': u'\u0434\u0440\u0443\u0433\u043e\u0435',
                u'oid': u'56267164',
                u'premisenumber': u'39',
                u'short_text': u'\u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430, 39',
                u'thoroughfare': u'\u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430',
                u'type': u'address',
                u'use_geopoint': False},
               u'source_geoareas': [u'kazan_activation', u'kazan', u'Kazan'],
               u'source_raw': {u'country': u'\u0420\u043e\u0441\u0441\u0438\u044f',
                u'description': u'\u041a\u0430\u0437\u0430\u043d\u044c, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u0420\u043e\u0441\u0441\u0438\u044f',
                u'exact': True,
                u'fullname': u'\u0420\u043e\u0441\u0441\u0438\u044f, \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u0422\u0430\u0442\u0430\u0440\u0441\u0442\u0430\u043d, \u041a\u0430\u0437\u0430\u043d\u044c, \u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430, 39',
                u'geopoint': [49.10721469999999, 55.7823999],
                u'locality': u'\u041a\u0430\u0437\u0430\u043d\u044c',
                u'object_type': u'\u0434\u0440\u0443\u0433\u043e\u0435',
                u'oid': u'56267164',
                u'premisenumber': u'39',
                u'short_text': u'\u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430, 39',
                u'thoroughfare': u'\u0443\u043b\u0438\u0446\u0430 \u041d\u0430\u0440\u0438\u043c\u0430\u043d\u043e\u0432\u0430',
                u'type': u'address',
                u'use_geopoint': False},
               u'sp': 1.0},
              u'rsk': u'1915db7bcfe04b3c8935924686be346e',
              u'status': u'cancelled',
              u'status_updated': '2018-01-09 12:15:21.466000',
              u'taxi_status': None,
              u'terminal_id': None,
              u'user_agent': u'yandex-taxi/3.50.1.15759 Android/5.1.1 (Micromax; Micromax Q415)',
              u'user_id': u'a23e364afa6d4543942c1c42af945a5c',
              u'user_locale': u'ru',
              u'user_phone_id': '5814aacb21586f10fe1657bd',
              u'user_ready': True,
              u'user_uid': u'577064411',
              u'vendor_id': None,
              u'version': 7},
             u'order_info': {u'need_sync': True,
              u'source_point': [49.10721469999999, 55.7823999],
              u'statistics': {u'assign_route_time': 144.79,
               u'assign_surge': 1.0,
               u'corp_ride_report_sent': False,
               u'ride_report_sent': False,
               u'setcared': None,
               u'status_updates': [{u'c': '2018-01-09 12:06:27.869000',
                 u'h': False,
                 u'q': u'create',
                 u's': u'pending'},
                {u'c': '2018-01-09 12:06:33.240000',
                 u'd': [49.10867526, 55.77697332],
                 u'h': False,
                 u'i': 0,
                 u'p': {u'avg_speed': 0.0,
                  u'direction': 0.0,
                  u'geopoint': [49.10867526, 55.77697332],
                  u'taxi_status': u'pending',
                  u'time': '2018-01-09 12:06:33.000000',
                  u'updated': '2018-01-09 12:06:33.240000'},
                 u'q': u'seen'},
                {u'c': '2018-01-09 12:06:35.135000',
                 u'g': 1,
                 u'h': False,
                 u'i': 0,
                 u's': u'assigned'},
                {u'c': '2018-01-09 12:06:35.135000',
                 u'd': [49.10867526, 55.77697332],
                 u'h': False,
                 u'i': 0,
                 u'l': 2482.0859375,
                 u'p': {u'avg_speed': 0.0,
                  u'direction': 0.0,
                  u'geopoint': [49.10867526, 55.77697332],
                  u'taxi_status': u'driving',
                  u'time': '2018-01-09 12:06:32.000000',
                  u'updated': '2018-01-09 09:06:34.000000'},
                 u't': u'driving'},
                {u'c': '2018-01-09 12:09:38.704000',
                 u'd': [49.10771589, 55.78201288],
                 u'h': False,
                 u'i': 0,
                 u'l': 733.6484375,
                 u'p': {u'avg_speed': 32.0,
                  u'direction': 326.5,
                  u'geopoint': [49.10771589, 55.78201288],
                  u'taxi_status': u'waiting',
                  u'time': '2018-01-09 12:09:34.000000',
                  u'updated': '2018-01-09 09:09:38.000000'},
                 u't': u'waiting'},
                {u'a': {u'comment_id': u'REFUSE_TO_COMPLETE_ORDER'},
                 u'c': '2018-01-09 12:13:39.243000',
                 u'd': [49.10704937, 55.78255993],
                 u'h': False,
                 u'i': 0,
                 u'q': u'autoreorder',
                 u'r': u'manual',
                 u's': u'pending',
                 u't': None},
                {u'c': '2018-01-09 12:14:50.967000',
                 u'h': True,
                 u'i': 1,
                 u'q': u'seen_timeout'},
                {u'c': '2018-01-09 12:15:21.466000',
                 u'fc': False,
                 u'h': True,
                 u's': u'cancelled'}]},
              u'with_coupon': False},
             u'order_link': u'60918985e03b4e968f5f167ec11f95db',
             u'performer': {u'alias_id': None,
              u'candidate_index': None,
              u'driver_id': None,
              u'need_sync': False,
              u'park_id': None,
              u'presetcar': False},
             u'processing': {u'version': 17},
             u'reorder': {u'decisions': [], u'suggestions': []},
             u'status': u'finished',
             u'trigger': {u's': {u'lookupinit': {u'last_called': '2018-01-09 12:13:39.696000'},
               u'seentimeout': {u'last_called': '2018-01-09 12:14:50.967000'}}},
             u'updated': '2018-04-19 20:35:16.650000'},
            'etl_updated': '2018-04-19 20:40:07',
            'id': '7452c580e33c4422ae581a9f48a9828a',
            'order_created': '2018-01-09 12:06:27',
            'updated': '2018-04-19 20:35:16'}],
          True,
          None,
          None,
          None,
          None,
          None,
          None)
  client is undefined
  self = <yt.wrapper.client.YtClient at 0x7f8668ab3f90>
  kwargs = {}

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/dynamic_table_commands.py:
 in insert_rows(table = //home/taxi-dwh/raw/mdb/order_proc/2018-01-01, input_stream = [{'doc': {u'_id': u'7452c580e33c4422ae581a9f48a9828a', u'aliases': [{u'due': '2018-01-09 12:10:00.000000', u'due_optimistic': None, u'generation': 1, u'id': u'dbae3b14bf7f4037bfe6aeca0a853ee5'}], u'autoreorder': {u'decisions': [{u'created': '2018-01-09 12:13:39.243000'}]}, u'candidates': [{u'adjusted_point': {u'avg_speed': 0, u'direction': -1, u'geopoint': [...], u'time': 1515499575}, u'alias_id': u'dbae3b14bf7f4037bfe6aeca0a853ee5', u'ar': 0.5, u'cancel_attempts': 3, u'cancel_status': u'finished', u'car_color': u'\u0447\u0435\u0440\u043d\u044b\u0439', u'car_color_code': u'040001', u'car_model': u'LADA (\u0412\u0410\u0417) 2114', u'car_number': u'\u0420204\u0410\u0410116', u'ci': u'f8b9e6bc1b264e62a731ae6843234dc8', ...}, {u'cancel_status': u'finished', u'hd': True, u'ost': '2018-01-09 12:13:53.743000', u'requestcar_status': u'finished', u'setcared': '2018-01-09 12:13:53.743000'}], u'changes': {u'ob
 jects': [{u'c': '2018-01-09 12:10:41.011000', u'ci': u'a23e364afa6d4543942c1c42af945a5c', u'id': u'624886643c0c48b8a41b921a5486d692', u'n': u'user_ready', u's': u'applied', u'si': {...}, u't': '2018-01-09 12:10:39.000000', u'vl': False, u'vr': 4}, {u'c': '2018-01-09 12:10:41.011000', u'ci': u'a23e364afa6d4543942c1c42af945a5c', u'id': u'ca2315d469c14ffd80b74657d6148b1b', u'n': u'user_ready', u's': u'applied', u'si': {...}, u't': '2018-01-09 12:10:39.000000', u'vl': True, u'vr': 4}]}, u'created': '2018-01-09 12:06:27.869000', u'insurer_id': u'83d0d8e57b9242f7a7968653ecfe490b', u'lookup': {u'eta': '2018-01-09 12:13:39.696000', u'generation': 3, u'generation_updated': '2018-01-09 12:13:39.696000', u'name': u'direct_assignment', u'need_start': True, u'params': {}, u'restart_eta': None, u'start_eta': '2018-01-09 12:13:39.243000', u'state': {}, u'version': 2}, u'order': {u'_type': u'soon', u'application': u'android', u'calc': {u'allowed_tariffs': {u'__park__': {...}}, u'distance': 1810.73,
  u'extra_distance_multiplier': 1.0, u'recalculated': False, u'time': 245.81740725040436}, u'city': u'\u041a\u0430\u0437\u0430\u043d\u044c', u'cost': None, u'created': '2018-01-09 12:06:27.763000', u'device_id': u'22f06c3cd04bf93d7b8864c32a759888f2d8b07d', u'dont_call': False, u'dont_sms': True, u'experiments': [u'address_change_logging', u'antifraud_fix_price', u'autoreorder_android', u'autoreorder_notifications', u'change_card_during_the_ride', u'direct_assignment', u'dynamic_transfer_price', u'feedback_user_chat', u'fiscal_receipt', u'fixed_price', u'forced_surge', u'hunger_time', u'new_stq', u'open_near_point_a', u'order_show_comment', u'payment_change', u'pool_tooltip', u'route_adjust', u'route_adjust_eta', u'routing_42', ...], ...}, u'order_info': {u'need_sync': True, u'source_point': [49.10721469999999, 55.7823999], u'statistics': {u'assign_route_time': 144.79, u'assign_surge': 1.0, u'corp_ride_report_sent': False, u'ride_report_sent': False, u'setcared': None, u'status_update
 s': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]}, u'with_coupon': False}, ...}, 'etl_updated': '2018-04-19 20:40:07', 'id': '7452c580e33c4422ae581a9f48a9828a', 'order_created': '2018-01-09 12:06:27', 'updated': '2018-04-19 20:35:16'}], update = True, aggregate = None, atomicity = None, durability = None, format = <"boolean_as_string"=%false;"ignore_inner_attrib...eate_attributes"=%false;"format"="binary";>"yson", raw = False, require_sync_replica = None, client = <yt.wrapper.client.YtClient object>)

     177         params,
     178         data=input_data,
  -> 179         client=client).run()
     180
     181 def delete_rows(table, input_stream, atomicity=None, durability=None, format=None, raw=None,

Vars:
  client = <yt.wrapper.client.YtClient at 0x7f8668ab3f90>
  ).run is undefined

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/retries.py:
 in run(self = <yt.wrapper.dynamic_table_commands.DynamicTableRequestRetrier object>)

      57                 if self.chaos_monkey_enabled and random.randint(1, 5) == 1:
      58                     raise YtRetriableError()
   -> 59                 return self.action()
      60             except self.exceptions as exception:
      61                 if attempt == retry_count:

Vars:
  self = <yt.wrapper.dynamic_table_commands.DynamicTableRequestRetrier at 0x7f857202c110>
  self.action = <bound method DynamicTableRequestRetrier.action of <yt.wrapper.dynamic_table_commands.DynamicTableRequestRetrier object at 0x7f857202c110>>

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/dynamic_table_commands.py:
 in action(self = <yt.wrapper.dynamic_table_commands.DynamicTableRequestRetrier object>)

      79             timeout=self.request_timeout,
      80             client=self.client,
   -> 81             **kwargs)
      82
      83         if response is not None:

Vars:
  kwargs = {'data': '{\x01\x06doc={\x01\x0cstatus=\x01\x10finished;\x01\x0eupdated=\x0142018-04-19 20:35:16.650000;\x01\x12performer={\x01\x1ecandidate_index=#;\x01\x12need_sync=\x04;\x01\x12presetcar=\x04;\x01\x10alias_id=#;\x01\x12driver_id=#;\x01\x0epark_id=#;};\x01\x0ecreated=\x0142018-01-09 12:06:27.869000;\x01\x0ealiases=[{\x01\x14generation=\x02\x02;\x01\x1cdue_optimistic=#;\x01\x04id=\x01@dbae3b14bf7f4037bfe6aeca0a853ee5;\x01\x06due=\x0142018-01-09 12:10:00.000000;};];\x01\x14order_link=\x01@60918985e03b4e968f5f167ec11f95db;\x01\x14processing={\x01\x0eversion=\x02";};\x01\x14order_info={\x01\x16with_coupon=\x04;\x01\x14statistics={\x01\x1cstatus_updates=[{\x01\x02q=\x01\x0ccreate;\x01\x02h=\x04;\x01\x02c=\x0142018-01-09 12:06:27.869000;\x01\x02s=\x01\x0epending;};{\x01\x02c=\x0142018-01-09 12:06:33.240000;\x01\x02d=[\x03\xca\xca\'\x12\xe9\x8dH@;\x03\xdd\xa1\x9b\xdcs\xe3K@;];\x01\x02i=\x02\x00;\x01\x02h=\x04;\x01\x02q=\x01\x08seen;\x01\x02p={\x01\x0eupdated=\x0142018-01-09 12:
 06:33.240000;\x01\x10geopoint=[\x03\xca\xca\'\x12\xe9\x8dH@;\x03\xdd\xa1\x9b\xdcs\xe3K@;];\x01\x12direction=\x03\x00\x00\x00\x00\x00\x00\x00\x00;\x01\x16taxi_status=\x01\x0epending;\x01\x08time=\x0142018-01-09 12:06:33.000000;\x01\x12avg_speed=\x03\x00\x00\x00\x00\x00\x00\x00\x00;};};{\x01\x02i=\x02\x00;\x01\x02h=\x04;\x01\x02c=\x0142018-01-09 12:06:35.135000;\x01\x02s=\x01\x10assigned;\x01\x02g=\x02\x02;};{\x01\x02c=\x0142018-01-09 12:06:35.135000;\x01\x02d=[\x03\xca\xca\'\x12\xe9\x8dH@;\x03\xdd\xa1\x9b\xdcs\xe3K@;];\x01\x02i=\x02\x00;\x01\x02h=\x04;\x01\x02l=\x03\x00\x00\x00\x00,d\xa3@;\x01\x02p={\x01\x0eupdated=\x0142018-01-09 09:06:34.000000;\x01\x10geopoint=[\x03\xca\xca\'\x12\xe9\x8dH@;\x03\xdd\xa1\x9b\xdcs\xe3K@;];\x01\x12direction=\x03\x00\x00\x00\x00\x00\x00\x00\x00;\x01\x16taxi_status=\x01\x0edriving;\x01\x08time=\x0142018-01-09 12:06:32.000000;\x01\x12avg_speed=\x03\x00\x00\x00\x00\x00\x00\x00\x00;};\x01\x02t=\x01\x0edriving;};{\x01\x02c=\x0142018-01-09 12:09:38.704000;\x
 01\x02d=[\x03\x9fg`\xa2\xc9\x8dH@;\x03MS\x80\xff\x18\xe4K@;];\x01\x02i=\x02\x00;\x01\x02h=\x04;\x01\x02l=\x03\x00\x00\x00\x000\xed\x86@;\x01\x02p={\x01\x0eupdated=\x0142018-01-09 09:09:38.000000;\x01\x10geopoint=[\x03\x9fg`\xa2\xc9\x8dH@;\x03MS\x80\xff\x18\xe4K@;];\x01\x12direction=\x03\x00\x00\x00\x00\x00ht@;\x01\x16taxi_status=\x01\x0ewaiting;\x01\x08time=\x0142018-01-09 12:09:34.000000;\x01\x12avg_speed=\x03\x00\x00\x00\x00\x00\x00@@;};\x01\x02t=\x01\x0ewaiting;};{\x01\x02a={\x01\x14comment_id=\x010REFUSE_TO_COMPLETE_ORDER;};\x01\x02c=\x0142018-01-09 12:13:39.243000;\x01\x02d=[\x03\x8c\x9a3\xcb\xb3\x8dH@;\x03IA}\xec*\xe4K@;];\x01\x02i=\x02\x00;\x01\x02h=\x04;\x01\x02q=\x01\x16autoreorder;\x01\x02s=\x01\x0epending;\x01\x02r=\x01\x0cmanual;\x01\x02t=#;};{\x01\x02i=\x02\x02;\x01\x02h=\x05;\x01\x02c=\x0142018-01-09 12:14:50.967000;\x01\x02q=\x01\x18seen_timeout;};{\x01\x02h=\x05;\x01\x02c=\x0142018-01-09 12:15:21.466000;\x01\x04fc=\x04;\x01\x02s=\x01\x12cancelled;};];\x01"assign_rout
 e_time=\x03\xe1z\x14\xaeG\x19b@;\x01\x18assign_surge=\x03\x00\x00\x00\x00\x00\x00\xf0?;\x01*corp_ride_report_sent=\x04;\x01 ride_report_sent=\x04;\x01\x10setcared=#;};\x01\x18source_point=[\x03A\x13\x176\xb9\x8dH@;\x03dr\x0f\xae%\xe4K@;];\x01\x12need_sync=\x05;};\x01\x14insurer_id=\x01@83d0d8e57b9242f7a7968653ecfe490b;\x01\x0etrigger={\x01\x02s={\x01\x16seentimeout={\x01\x16last_called=\x0142018-01-09 12:14:50.967000;};\x01\x14lookupinit={\x01\x16last_called=\x0142018-01-09 12:13:39.696000;};};};\x01\x0clookup={\x01\x08name=\x01"direct_assignment;\x01\x14generation=\x02\x06;\x01\x14need_start=\x05;\x01\nstate={};\x01\x06eta=\x0142018-01-09 12:13:39.696000;\x01\x0cparams={};\x01\x0eversion=\x02\x04;\x01\x16restart_eta=#;\x01\x12start_eta=\x0142018-01-09 12:13:39.243000;\x01$generation_updated=\x0142018-01-09 12:13:39.696000;};\x01\x16autoreorder={\x01\x12decisions=[{\x01\x0ecreated=\x0142018-01-09 12:13:39.243000;};];};\x01\x06_id=\x01@7452c580e33c4422ae581a9f48a9828a;\x01\x0echanges
 ={\x01\x0eobjects=[{\x01\x04ci=\x01@a23e364afa6d4543942c1c42af945a5c;\x01\x02s=\x01\x0eapplied;\x01\x04vl=\x04;\x01\x02c=\x0142018-01-09 12:10:41.011000;\x01\x04vr=\x02\x08;\x01\x02n=\x01\x14user_ready;\x01\x04si={\x01\x02s=\x01\x12delivered;\x01\x02c=\x02\x00;};\x01\x02t=\x0142018-01-09 12:10:39.000000;\x01\x04id=\x01@624886643c0c48b8a41b921a5486d692;};{\x01\x04ci=\x01@a23e364afa6d4543942c1c42af945a5c;\x01\x02s=\x01\x0eapplied;\x01\x04vl=\x05;\x01\x02c=\x0142018-01-09 12:10:41.011000;\x01\x04vr=\x02\x08;\x01\x02n=\x01\x14user_ready;\x01\x04si={\x01\x02s=\x01\x12delivered;\x01\x02c=\x02\x02;\x01\x02t=\x0142018-01-09 12:10:41.621000;};\x01\x02t=\x0142018-01-09 12:10:39.000000;\x01\x04id=\x01@ca2315d469c14ffd80b74657d6148b1b;};];};\x01\norder={\x01\x0cstatus=\x01\x12cancelled;\x01\x16fixed_price={\x01\nprice=\x03\x00\x00\x00\x00\x00@P@;\x01\x16destination=[\x03\xfb\xea\xaa@-\x8cH@;\x03\xa5\x84`U\xbd\xe2K@;];\x01.show_price_in_taximeter=\x05;\x01&max_distance_from_b=\x02\xe8\x07;};\x01
 \x16terminal_id=#;\x01\n_type=\x01\x08soon;\x01\x08cost=#;\x01\x1cstatus_updated=\x0142018-01-09 12:15:21.466000;\x01\x16referral_id=#;\x01\x08city=\x01\x18\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c;\x01\x0euser_id=\x01@a23e364afa6d4543942c1c42af945a5c;\x01$referral_timestamp=#;\x01\x16application=\x01\x0eandroid;\x01\x04nz=\x01\nkazan;\x01\x0eversion=\x02\x0e;\x01\x08calc={\x01\x10distance=\x03R\xb8\x1e\x85\xebJ\x9c@;\x01\x1eallowed_tariffs={\x01\x10__park__={\x01\x06vip=\x03\x00\x00\x00\x00\x00\xb0r@;\x01\x0ceconom=\x03\x00\x00\x00\x00\x00@P@;\x01\x10business=\x03\x00\x00\x00\x00\x00\x80\\@;};};\x01\x18recalculated=\x04;\x01\x08time=\x03\x00\x00@3(\xban@;\x012extra_distance_multiplier=\x03\x00\x00\x00\x00\x00\x00\xf0?;};\x01\x18payment_tech={\x01\x1chold_initiated=\x04;\x01.main_card_persistent_id=#;\x01(main_card_billing_id=#;\x01(main_card_payment_id=#;\x01\x10need_cvn=\x04;\x01\x08debt=\x04;\x01\x08type=\x01\x08cash;\x01\x1alast_known_ip=\x01$::ffff:85.140.2.34;};\x01\x1a
 user_phone_id=\x0105814aacb21586f10fe1657bd;\x01\x1coperator_login=#;\x01\x10user_uid=\x01\x12577064411;\x01\x12dont_call=\x04;\x01\x06rsk=\x01@1915db7bcfe04b3c8935924686be346e;\x01\x12vendor_id=#;\x01\x16user_locale=\x01\x04ru;\x01\x16taxi_status=#;\x01\x14user_ready=\x05;\x01\x12device_id=\x01P22f06c3cd04bf93d7b8864c32a759888f2d8b07d;\x01\x0ecreated=\x0142018-01-09 12:06:27.763000;\x01\x0erequest={\x01\x0ecomment=\x01\x00;\x01\x14source_raw={\x01\x18use_geopoint=\x04;\x01\x16description=\x01\x86\x01\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f;\x01\x18thoroughfare=\x01>\xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0;\x01\x10locality=\x01\x18\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c;\x01\x0ecountry
 =\x01\x18\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f;\x01\x10geopoint=[\x03A\x13\x176\xb9\x8dH@;\x03dr\x0f\xae%\xe4K@;];\x01\x08type=\x01\x0eaddress;\x01\x16object_type=\x01\x18\xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb5;\x01\x10fullname=\x01\xd0\x01\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0, 39;\x01\x1apremisenumber=\x01\x0439;\x01\nexact=\x05;\x01\x14short_text=\x01F\xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0, 39;\x01\x06oid=\x01\x1056267164;};\x01\x1aservice_level=\x02d;\x01\x18requirements={};\x01\noffer=\x01@475f8565697e42eea803b00f3cdb2277;\x01\x04sp=\x03\x00\x00
 \x00\x00\x00\x00\xf0?;\x01\x06due=\x0142018-01-09 12:10:00.000000;\x01\x0epayment={\x01\x08type=\x01\x08cash;\x01"payment_method_id=#;};\x01\x0csource={\x01\x18use_geopoint=\x04;\x01\x16description=\x01\x86\x01\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f;\x01\x18thoroughfare=\x01>\xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0;\x01\x10locality=\x01\x18\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c;\x01\x0ecountry=\x01\x18\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f;\x01\x10geopoint=[\x03A\x13\x176\xb9\x8dH@;\x03dr\x0f\xae%\xe4K@;];\x01\x08type=\x01\x0eaddress;\x01\x16object_type=\x01\x18\xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb5;\x01\x10fullname=\x01\xd0\x01\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0
 \xb8\xd1\x8f, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0, 39;\x01\x1apremisenumber=\x01\x0439;\x01\nexact=\x05;\x01\x14short_text=\x01F\xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0, 39;\x01\x06oid=\x01\x1056267164;};\x01\x08corp={\x01\x16cost_center=#;};\x01\x1cexcluded_parks=[];\x01*ignore_excluded_parks=\x05;\x01\x18destinations=[{\x01\x18use_geopoint=\x04;\x01\x16description=\x01\x86\x01\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb
 8\xd1\x8f;\x01\x18thoroughfare=\x016\xd0\x9f\xd0\xbe\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x8f \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0;\x01\x10locality=\x01\x18\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c;\x01\x0ecountry=\x01\x18\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f;\x01\x10geopoint=[\x03\xfb\xea\xaa@-\x8cH@;\x03\xa5\x84`U\xbd\xe2K@;];\x01\x08type=\x01\x0eaddress;\x01\x16object_type=\x01\x18\xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb5;\x01\x10fullname=\x01\xc6\x01\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd0\x9f\xd0\xbe\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x8f \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0, 2;\x01\x1apremisenumber=\x01\x022;\x01\nexact=\x05;\x01\x14short_text=\x01<\xd0\x9f\xd0\xbe\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x8f \
 xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0, 2;\x01\x06oid=\x01\x1056257878;};];\x01\nclass=[\x01\x0ceconom;];\x01\x1esource_geoareas=[\x01 kazan_activation;\x01\nkazan;\x01\nKazan;];\x010driverclientchat_enabled=\x04;};\x01\x16experiments=[\x01,address_change_logging;\x01&antifraud_fix_price;\x01&autoreorder_android;\x012autoreorder_notifications;\x016change_card_during_the_ride;\x01"direct_assignment;\x01,dynamic_transfer_price;\x01$feedback_user_chat;\x01\x1cfiscal_receipt;\x01\x16fixed_price;\x01\x18forced_surge;\x01\x16hunger_time;\x01\x0enew_stq;\x01"open_near_point_a;\x01$order_show_comment;\x01\x1cpayment_change;\x01\x18pool_tooltip;\x01\x18route_adjust;\x01 route_adjust_eta;\x01\x14routing_42;\x01$surge_add_business;\x01\x1csurge_distance;\x01\x14surgeprice;\x01$taximeter_complete;\x01\x14trash_test;\x01*user_position_enabled;];\x01\x14user_agent=\x01\x80\x01yandex-taxi/3.50.1.15759 Android/5.1.1 (Micromax; Micromax Q415);\x01\x10dont_sms=\x05;};\x01\x0ereorder={\x01\x16suggest
 ions=[];\x01\x12decisions=[];};\x01\x14candidates=[{\x01\x04ci=\x01@f8b9e6bc1b264e62a731ae6843234dc8;\x01\x08dist=\x03\x9e\xef\xa7\xc6K{\x86@;\x01\npoint=[\x03\x05\t\x1f\x84\xdf\x8dH@;\x03\xf2[\xf8\xeax\xe3K@;];\x01\x04is=\x05;\x01\x10alias_id=\x01@dbae3b14bf7f4037bfe6aeca0a853ee5;\x01\x06ost=\x0142018-01-09 12:06:29.075000;\x01\x16experiments=[\x014proxy_gps_set_to_geotracks;\x01\x18show_traning;\x01$order_show_comment;\x01\x1aassign_new_ui;\x01Fclientdriver_chat_recognize_message;\x016partner_program_burger_king;];\x01\x04ar=\x03\x00\x00\x00\x00\x00\x00\xe0?;\x01\x12dp_values={\x01\x02c=\x02\x02;\x01\x02r=\x02\x01;};\x01\x1cadjusted_point={\x01\x12avg_speed=\x02\x00;\x01\x12direction=\x02\x01;\x01\x10geopoint=[\x03\x05\t\x1f\x84\xdf\x8dH@;\x03\xf2[\xf8\xeax\xe3K@;];\x01\x08time=\x02\xee\xc0\xa5\xa5\x0b;};\x01\x1cdriver_license=\x01\x141625458154;\x01\x04cr=\x03\xc3\xf5(\\\x8f\xc2\xed?;\x010driverclientchat_enabled=\x05;\x01\x04dr=#;\x01"taximeter_version=\x01\x088.44;\x01\x04rd=\x
 05;\x01\x10dbcar_id=\x01@cfae94a1d3c74db6845c54833ebc88f2;\x01\x04dp=#;\x01\x12gprs_time=\x03\xa6\x9b\xc4 \xb0\xb22@;\x01\x10setcared=\x0142018-01-09 12:06:29.075000;\x01\x04dm=#;\x01\ndb_id=\x01@eafd8352bb7249a0800739e70548f3ce;\x01"requestcar_status=\x01\x10finished;\x01\x12car_model=\x01$LADA (\xd0\x92\xd0\x90\xd0\x97) 2114;\x01\x14car_number=\x01\x18\xd0\xa0204\xd0\x90\xd0\x90116;\x01\x1etariff_currency=\x01\x06RUB;\x01\x1ecancel_attempts=\x02\x06;\x01\nphone=\x01\x18+79600673457;\x01\x02z=[\x01@dc4adce8fe134691a678c05174574905;];\x01\x04dv=#;\x01\x12line_dist=\x03\x0e~\xf3\t\xa8w\x82@;\x01\x04hd=\x05;\x01\x12car_color=\x01\x18\xd1\x87\xd0\xb5\xd1\x80\xd0\xbd\xd1\x8b\xd0\xb9;\x012last_failed_cancelrequest=\x0142018-01-09 12:15:30.782000;\x01\x12tariff_id=\x01@f8b9e6bc1b264e62a731ae6843234dc8;\x01\x08name=\x01X\xd0\x91\xd1\x83\xd1\x88\xd1\x83\xd0\xb5\xd0\xb2 \xd0\xa1\xd0\xb5\xd1\x80\xd0\xb3\xd0\xb5\xd0\xb9 \xd0\xa1\xd0\xb5\xd1\x80\xd0\xb3\xd0\xb5\xd0\xb5\xd0\xb2\xd0\xb8\xd1\x87;\
 x01\x0ecreated=\x0142018-01-09 12:06:28.745000;\x01\x1acancel_status=\x01\x10finished;\x01$driver_experiments=[\x01\x1aassign_new_ui;\x01Fclientdriver_chat_recognize_message;\x01$order_show_comment;\x016partner_program_burger_king;\x014proxy_gps_set_to_geotracks;\x01\x18show_traning;];\x01\x12driver_id=\x01V1956793037_05c6b0500fe545459c151ce3a98c7107;\x01\x08time=\x03\xf6(\\\x8f\xc2\xc5^@;\x01\x1ccar_color_code=\x01\x0c040001;\x01\x18tariff_class=\x01\x0ceconom;};{\x01"requestcar_status=\x01\x10finished;\x01\x04hd=\x05;\x01\x10setcared=\x0142018-01-09 12:13:53.743000;\x01\x1acancel_status=\x01\x10finished;\x01\x06ost=\x0142018-01-09 12:13:53.743000;};];};\x01\x0eupdated=\x01&2018-04-19 20:35:16;\x01\x1aorder_created=\x01&2018-01-09 12:06:27;\x01\x04id=\x01@7452c580e33c4422ae581a9f48a9828a;\x01\x16etl_updated=\x01&2018-04-19 20:40:07;};'}

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/transaction_commands.py:
 in _make_transactional_request(command_name = 'insert_rows', params = {'input_format': {'attributes': {'boolean_as_string': False, 'ign...es': False, 'format': 'binary'}, 'value': 'yson'}, 'path': //home/taxi-dwh/raw/mdb/order_proc/2018-01-01, 'update': 'true'}, **kwargs = {'client': <yt.wrapper.client.YtClient object>, 'data': '{\x01\x06doc={\x01\x0cstatus=\x01\x10finished;\x01\x0eupdated=\x0142018-04-...9f48a9828a;\x01\x16etl_updated=\x01&2018-04-19 20:40:07;};', 'decode_content': False, 'return_content': True, 'timeout': 60000, 'use_heavy_proxy': True})

       8
       9 def _make_transactional_request(command_name, params, **kwargs):
   -> 10     return make_request(command_name, params, **kwargs)
      11
      12 def _make_formatted_transactional_request(command_name, params, format, **kwargs):

Vars:
  global make_request = <function yt.wrapper.driver.make_request>
  command_name = 'insert_rows'
  params = {'input_format': {'attributes': {'boolean_as_string': False, 'ignore_inner_attributes': False, 'always_create_attributes': False, 'format': 'binary'}, 'value': 'yson'},
            'path': //home/taxi-dwh/raw/mdb/order_proc/2018-01-01,
            'update': 'true'}
  kwargs = {'client': <yt.wrapper.client.YtClient at 0x7f8668ab3f90>,
            'data': '{\x01\x06doc={\x01\x0cstatus=\x01\x10finished;\x01\x0eupdated=\x0142018-04-19 20:35:16.650000;\x01\x12performer={\x01\x1ecandidate_index=#;\x01\x12need_sync=\x04;\x01\x12presetcar=\x04;\x01\x10alias_id=#;\x01\x12driver_id=#;\x01\x0epark_id=#;};\x01\x0ecreated=\x0142018-01-09 12:06:27.869000;\x01\x0ealiases=[{\x01\x14generation=\x02\x02;\x01\x1cdue_optimistic=#;\x01\x04id=\x01@dbae3b14bf7f4037bfe6aeca0a853ee5;\x01\x06due=\x0142018-01-09 12:10:00.000000;};];\x01\x14order_link=\x01@60918985e03b4e968f5f167ec11f95db;\x01\x14processing={\x01\x0eversion=\x02";};\x01\x14order_info={\x01\x16with_coupon=\x04;\x01\x14statistics={\x01\x1cstatus_updates=[{\x01\x02q=\x01\x0ccreate;\x01\x02h=\x04;\x01\x02c=\x0142018-01-09 12:06:27.869000;\x01\x02s=\x01\x0epending;};{\x01\x02c=\x0142018-01-09 12:06:33.240000;\x01\x02d=[\x03\xca\xca\'\x12\xe9\x8dH@;\x03\xdd\xa1\x9b\xdcs\xe3K@;];\x01\x02i=\x02\x00;\x01\x02h=\x04;\x01\x02q=\x01\x08seen;\x01\x02p={\x01\x0eupdated=\x0142018-01-09 12:
 06:33.240000;\x01\x10geopoint=[\x03\xca\xca\'\x12\xe9\x8dH@;\x03\xdd\xa1\x9b\xdcs\xe3K@;];\x01\x12direction=\x03\x00\x00\x00\x00\x00\x00\x00\x00;\x01\x16taxi_status=\x01\x0epending;\x01\x08time=\x0142018-01-09 12:06:33.000000;\x01\x12avg_speed=\x03\x00\x00\x00\x00\x00\x00\x00\x00;};};{\x01\x02i=\x02\x00;\x01\x02h=\x04;\x01\x02c=\x0142018-01-09 12:06:35.135000;\x01\x02s=\x01\x10assigned;\x01\x02g=\x02\x02;};{\x01\x02c=\x0142018-01-09 12:06:35.135000;\x01\x02d=[\x03\xca\xca\'\x12\xe9\x8dH@;\x03\xdd\xa1\x9b\xdcs\xe3K@;];\x01\x02i=\x02\x00;\x01\x02h=\x04;\x01\x02l=\x03\x00\x00\x00\x00,d\xa3@;\x01\x02p={\x01\x0eupdated=\x0142018-01-09 09:06:34.000000;\x01\x10geopoint=[\x03\xca\xca\'\x12\xe9\x8dH@;\x03\xdd\xa1\x9b\xdcs\xe3K@;];\x01\x12direction=\x03\x00\x00\x00\x00\x00\x00\x00\x00;\x01\x16taxi_status=\x01\x0edriving;\x01\x08time=\x0142018-01-09 12:06:32.000000;\x01\x12avg_speed=\x03\x00\x00\x00\x00\x00\x00\x00\x00;};\x01\x02t=\x01\x0edriving;};{\x01\x02c=\x0142018-01-09 12:09:38.704000;\x
 01\x02d=[\x03\x9fg`\xa2\xc9\x8dH@;\x03MS\x80\xff\x18\xe4K@;];\x01\x02i=\x02\x00;\x01\x02h=\x04;\x01\x02l=\x03\x00\x00\x00\x000\xed\x86@;\x01\x02p={\x01\x0eupdated=\x0142018-01-09 09:09:38.000000;\x01\x10geopoint=[\x03\x9fg`\xa2\xc9\x8dH@;\x03MS\x80\xff\x18\xe4K@;];\x01\x12direction=\x03\x00\x00\x00\x00\x00ht@;\x01\x16taxi_status=\x01\x0ewaiting;\x01\x08time=\x0142018-01-09 12:09:34.000000;\x01\x12avg_speed=\x03\x00\x00\x00\x00\x00\x00@@;};\x01\x02t=\x01\x0ewaiting;};{\x01\x02a={\x01\x14comment_id=\x010REFUSE_TO_COMPLETE_ORDER;};\x01\x02c=\x0142018-01-09 12:13:39.243000;\x01\x02d=[\x03\x8c\x9a3\xcb\xb3\x8dH@;\x03IA}\xec*\xe4K@;];\x01\x02i=\x02\x00;\x01\x02h=\x04;\x01\x02q=\x01\x16autoreorder;\x01\x02s=\x01\x0epending;\x01\x02r=\x01\x0cmanual;\x01\x02t=#;};{\x01\x02i=\x02\x02;\x01\x02h=\x05;\x01\x02c=\x0142018-01-09 12:14:50.967000;\x01\x02q=\x01\x18seen_timeout;};{\x01\x02h=\x05;\x01\x02c=\x0142018-01-09 12:15:21.466000;\x01\x04fc=\x04;\x01\x02s=\x01\x12cancelled;};];\x01"assign_rout
 e_time=\x03\xe1z\x14\xaeG\x19b@;\x01\x18assign_surge=\x03\x00\x00\x00\x00\x00\x00\xf0?;\x01*corp_ride_report_sent=\x04;\x01 ride_report_sent=\x04;\x01\x10setcared=#;};\x01\x18source_point=[\x03A\x13\x176\xb9\x8dH@;\x03dr\x0f\xae%\xe4K@;];\x01\x12need_sync=\x05;};\x01\x14insurer_id=\x01@83d0d8e57b9242f7a7968653ecfe490b;\x01\x0etrigger={\x01\x02s={\x01\x16seentimeout={\x01\x16last_called=\x0142018-01-09 12:14:50.967000;};\x01\x14lookupinit={\x01\x16last_called=\x0142018-01-09 12:13:39.696000;};};};\x01\x0clookup={\x01\x08name=\x01"direct_assignment;\x01\x14generation=\x02\x06;\x01\x14need_start=\x05;\x01\nstate={};\x01\x06eta=\x0142018-01-09 12:13:39.696000;\x01\x0cparams={};\x01\x0eversion=\x02\x04;\x01\x16restart_eta=#;\x01\x12start_eta=\x0142018-01-09 12:13:39.243000;\x01$generation_updated=\x0142018-01-09 12:13:39.696000;};\x01\x16autoreorder={\x01\x12decisions=[{\x01\x0ecreated=\x0142018-01-09 12:13:39.243000;};];};\x01\x06_id=\x01@7452c580e33c4422ae581a9f48a9828a;\x01\x0echanges
 ={\x01\x0eobjects=[{\x01\x04ci=\x01@a23e364afa6d4543942c1c42af945a5c;\x01\x02s=\x01\x0eapplied;\x01\x04vl=\x04;\x01\x02c=\x0142018-01-09 12:10:41.011000;\x01\x04vr=\x02\x08;\x01\x02n=\x01\x14user_ready;\x01\x04si={\x01\x02s=\x01\x12delivered;\x01\x02c=\x02\x00;};\x01\x02t=\x0142018-01-09 12:10:39.000000;\x01\x04id=\x01@624886643c0c48b8a41b921a5486d692;};{\x01\x04ci=\x01@a23e364afa6d4543942c1c42af945a5c;\x01\x02s=\x01\x0eapplied;\x01\x04vl=\x05;\x01\x02c=\x0142018-01-09 12:10:41.011000;\x01\x04vr=\x02\x08;\x01\x02n=\x01\x14user_ready;\x01\x04si={\x01\x02s=\x01\x12delivered;\x01\x02c=\x02\x02;\x01\x02t=\x0142018-01-09 12:10:41.621000;};\x01\x02t=\x0142018-01-09 12:10:39.000000;\x01\x04id=\x01@ca2315d469c14ffd80b74657d6148b1b;};];};\x01\norder={\x01\x0cstatus=\x01\x12cancelled;\x01\x16fixed_price={\x01\nprice=\x03\x00\x00\x00\x00\x00@P@;\x01\x16destination=[\x03\xfb\xea\xaa@-\x8cH@;\x03\xa5\x84`U\xbd\xe2K@;];\x01.show_price_in_taximeter=\x05;\x01&max_distance_from_b=\x02\xe8\x07;};\x01
 \x16terminal_id=#;\x01\n_type=\x01\x08soon;\x01\x08cost=#;\x01\x1cstatus_updated=\x0142018-01-09 12:15:21.466000;\x01\x16referral_id=#;\x01\x08city=\x01\x18\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c;\x01\x0euser_id=\x01@a23e364afa6d4543942c1c42af945a5c;\x01$referral_timestamp=#;\x01\x16application=\x01\x0eandroid;\x01\x04nz=\x01\nkazan;\x01\x0eversion=\x02\x0e;\x01\x08calc={\x01\x10distance=\x03R\xb8\x1e\x85\xebJ\x9c@;\x01\x1eallowed_tariffs={\x01\x10__park__={\x01\x06vip=\x03\x00\x00\x00\x00\x00\xb0r@;\x01\x0ceconom=\x03\x00\x00\x00\x00\x00@P@;\x01\x10business=\x03\x00\x00\x00\x00\x00\x80\\@;};};\x01\x18recalculated=\x04;\x01\x08time=\x03\x00\x00@3(\xban@;\x012extra_distance_multiplier=\x03\x00\x00\x00\x00\x00\x00\xf0?;};\x01\x18payment_tech={\x01\x1chold_initiated=\x04;\x01.main_card_persistent_id=#;\x01(main_card_billing_id=#;\x01(main_card_payment_id=#;\x01\x10need_cvn=\x04;\x01\x08debt=\x04;\x01\x08type=\x01\x08cash;\x01\x1alast_known_ip=\x01$::ffff:85.140.2.34;};\x01\x1a
 user_phone_id=\x0105814aacb21586f10fe1657bd;\x01\x1coperator_login=#;\x01\x10user_uid=\x01\x12577064411;\x01\x12dont_call=\x04;\x01\x06rsk=\x01@1915db7bcfe04b3c8935924686be346e;\x01\x12vendor_id=#;\x01\x16user_locale=\x01\x04ru;\x01\x16taxi_status=#;\x01\x14user_ready=\x05;\x01\x12device_id=\x01P22f06c3cd04bf93d7b8864c32a759888f2d8b07d;\x01\x0ecreated=\x0142018-01-09 12:06:27.763000;\x01\x0erequest={\x01\x0ecomment=\x01\x00;\x01\x14source_raw={\x01\x18use_geopoint=\x04;\x01\x16description=\x01\x86\x01\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f;\x01\x18thoroughfare=\x01>\xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0;\x01\x10locality=\x01\x18\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c;\x01\x0ecountry
 =\x01\x18\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f;\x01\x10geopoint=[\x03A\x13\x176\xb9\x8dH@;\x03dr\x0f\xae%\xe4K@;];\x01\x08type=\x01\x0eaddress;\x01\x16object_type=\x01\x18\xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb5;\x01\x10fullname=\x01\xd0\x01\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0, 39;\x01\x1apremisenumber=\x01\x0439;\x01\nexact=\x05;\x01\x14short_text=\x01F\xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0, 39;\x01\x06oid=\x01\x1056267164;};\x01\x1aservice_level=\x02d;\x01\x18requirements={};\x01\noffer=\x01@475f8565697e42eea803b00f3cdb2277;\x01\x04sp=\x03\x00\x00
 \x00\x00\x00\x00\xf0?;\x01\x06due=\x0142018-01-09 12:10:00.000000;\x01\x0epayment={\x01\x08type=\x01\x08cash;\x01"payment_method_id=#;};\x01\x0csource={\x01\x18use_geopoint=\x04;\x01\x16description=\x01\x86\x01\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f;\x01\x18thoroughfare=\x01>\xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0;\x01\x10locality=\x01\x18\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c;\x01\x0ecountry=\x01\x18\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f;\x01\x10geopoint=[\x03A\x13\x176\xb9\x8dH@;\x03dr\x0f\xae%\xe4K@;];\x01\x08type=\x01\x0eaddress;\x01\x16object_type=\x01\x18\xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb5;\x01\x10fullname=\x01\xd0\x01\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0
 \xb8\xd1\x8f, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0, 39;\x01\x1apremisenumber=\x01\x0439;\x01\nexact=\x05;\x01\x14short_text=\x01F\xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0, 39;\x01\x06oid=\x01\x1056267164;};\x01\x08corp={\x01\x16cost_center=#;};\x01\x1cexcluded_parks=[];\x01*ignore_excluded_parks=\x05;\x01\x18destinations=[{\x01\x18use_geopoint=\x04;\x01\x16description=\x01\x86\x01\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb
 8\xd1\x8f;\x01\x18thoroughfare=\x016\xd0\x9f\xd0\xbe\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x8f \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0;\x01\x10locality=\x01\x18\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c;\x01\x0ecountry=\x01\x18\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f;\x01\x10geopoint=[\x03\xfb\xea\xaa@-\x8cH@;\x03\xa5\x84`U\xbd\xe2K@;];\x01\x08type=\x01\x0eaddress;\x01\x16object_type=\x01\x18\xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb5;\x01\x10fullname=\x01\xc6\x01\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd0\x9f\xd0\xbe\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x8f \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0, 2;\x01\x1apremisenumber=\x01\x022;\x01\nexact=\x05;\x01\x14short_text=\x01<\xd0\x9f\xd0\xbe\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x8f \
 xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0, 2;\x01\x06oid=\x01\x1056257878;};];\x01\nclass=[\x01\x0ceconom;];\x01\x1esource_geoareas=[\x01 kazan_activation;\x01\nkazan;\x01\nKazan;];\x010driverclientchat_enabled=\x04;};\x01\x16experiments=[\x01,address_change_logging;\x01&antifraud_fix_price;\x01&autoreorder_android;\x012autoreorder_notifications;\x016change_card_during_the_ride;\x01"direct_assignment;\x01,dynamic_transfer_price;\x01$feedback_user_chat;\x01\x1cfiscal_receipt;\x01\x16fixed_price;\x01\x18forced_surge;\x01\x16hunger_time;\x01\x0enew_stq;\x01"open_near_point_a;\x01$order_show_comment;\x01\x1cpayment_change;\x01\x18pool_tooltip;\x01\x18route_adjust;\x01 route_adjust_eta;\x01\x14routing_42;\x01$surge_add_business;\x01\x1csurge_distance;\x01\x14surgeprice;\x01$taximeter_complete;\x01\x14trash_test;\x01*user_position_enabled;];\x01\x14user_agent=\x01\x80\x01yandex-taxi/3.50.1.15759 Android/5.1.1 (Micromax; Micromax Q415);\x01\x10dont_sms=\x05;};\x01\x0ereorder={\x01\x16suggest
 ions=[];\x01\x12decisions=[];};\x01\x14candidates=[{\x01\x04ci=\x01@f8b9e6bc1b264e62a731ae6843234dc8;\x01\x08dist=\x03\x9e\xef\xa7\xc6K{\x86@;\x01\npoint=[\x03\x05\t\x1f\x84\xdf\x8dH@;\x03\xf2[\xf8\xeax\xe3K@;];\x01\x04is=\x05;\x01\x10alias_id=\x01@dbae3b14bf7f4037bfe6aeca0a853ee5;\x01\x06ost=\x0142018-01-09 12:06:29.075000;\x01\x16experiments=[\x014proxy_gps_set_to_geotracks;\x01\x18show_traning;\x01$order_show_comment;\x01\x1aassign_new_ui;\x01Fclientdriver_chat_recognize_message;\x016partner_program_burger_king;];\x01\x04ar=\x03\x00\x00\x00\x00\x00\x00\xe0?;\x01\x12dp_values={\x01\x02c=\x02\x02;\x01\x02r=\x02\x01;};\x01\x1cadjusted_point={\x01\x12avg_speed=\x02\x00;\x01\x12direction=\x02\x01;\x01\x10geopoint=[\x03\x05\t\x1f\x84\xdf\x8dH@;\x03\xf2[\xf8\xeax\xe3K@;];\x01\x08time=\x02\xee\xc0\xa5\xa5\x0b;};\x01\x1cdriver_license=\x01\x141625458154;\x01\x04cr=\x03\xc3\xf5(\\\x8f\xc2\xed?;\x010driverclientchat_enabled=\x05;\x01\x04dr=#;\x01"taximeter_version=\x01\x088.44;\x01\x04rd=\x
 05;\x01\x10dbcar_id=\x01@cfae94a1d3c74db6845c54833ebc88f2;\x01\x04dp=#;\x01\x12gprs_time=\x03\xa6\x9b\xc4 \xb0\xb22@;\x01\x10setcared=\x0142018-01-09 12:06:29.075000;\x01\x04dm=#;\x01\ndb_id=\x01@eafd8352bb7249a0800739e70548f3ce;\x01"requestcar_status=\x01\x10finished;\x01\x12car_model=\x01$LADA (\xd0\x92\xd0\x90\xd0\x97) 2114;\x01\x14car_number=\x01\x18\xd0\xa0204\xd0\x90\xd0\x90116;\x01\x1etariff_currency=\x01\x06RUB;\x01\x1ecancel_attempts=\x02\x06;\x01\nphone=\x01\x18+79600673457;\x01\x02z=[\x01@dc4adce8fe134691a678c05174574905;];\x01\x04dv=#;\x01\x12line_dist=\x03\x0e~\xf3\t\xa8w\x82@;\x01\x04hd=\x05;\x01\x12car_color=\x01\x18\xd1\x87\xd0\xb5\xd1\x80\xd0\xbd\xd1\x8b\xd0\xb9;\x012last_failed_cancelrequest=\x0142018-01-09 12:15:30.782000;\x01\x12tariff_id=\x01@f8b9e6bc1b264e62a731ae6843234dc8;\x01\x08name=\x01X\xd0\x91\xd1\x83\xd1\x88\xd1\x83\xd0\xb5\xd0\xb2 \xd0\xa1\xd0\xb5\xd1\x80\xd0\xb3\xd0\xb5\xd0\xb9 \xd0\xa1\xd0\xb5\xd1\x80\xd0\xb3\xd0\xb5\xd0\xb5\xd0\xb2\xd0\xb8\xd1\x87;\
 x01\x0ecreated=\x0142018-01-09 12:06:28.745000;\x01\x1acancel_status=\x01\x10finished;\x01$driver_experiments=[\x01\x1aassign_new_ui;\x01Fclientdriver_chat_recognize_message;\x01$order_show_comment;\x016partner_program_burger_king;\x014proxy_gps_set_to_geotracks;\x01\x18show_traning;];\x01\x12driver_id=\x01V1956793037_05c6b0500fe545459c151ce3a98c7107;\x01\x08time=\x03\xf6(\\\x8f\xc2\xc5^@;\x01\x1ccar_color_code=\x01\x0c040001;\x01\x18tariff_class=\x01\x0ceconom;};{\x01"requestcar_status=\x01\x10finished;\x01\x04hd=\x05;\x01\x10setcared=\x0142018-01-09 12:13:53.743000;\x01\x1acancel_status=\x01\x10finished;\x01\x06ost=\x0142018-01-09 12:13:53.743000;};];};\x01\x0eupdated=\x01&2018-04-19 20:35:16;\x01\x1aorder_created=\x01&2018-01-09 12:06:27;\x01\x04id=\x01@7452c580e33c4422ae581a9f48a9828a;\x01\x16etl_updated=\x01&2018-04-19 20:40:07;};',
            'decode_content': False,
            'return_content': True,
            'timeout': 60000,
            'use_heavy_proxy': True}

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/driver.py:
 in make_request(command_name = 'insert_rows', params = {'input_format': {'attributes': {'boolean_as_string': False, 'ign...es': False, 'format': 'binary'}, 'value': 'yson'}, 'path': '//home/taxi-dwh/raw/mdb/order_proc/2018-01-01', 'update': 'true'}, data = '{\x01\x06doc={\x01\x0cstatus=\x01\x10finished;\x01\x0eupdated=\x0142018-04-...9f48a9828a;\x01\x16etl_updated=\x01&2018-04-19 20:40:07;};', is_data_compressed = False, return_content = True, response_format = None, use_heavy_proxy = True, timeout = 60000, allow_retries = None, decode_content = False, batch_yson_dumps = True, client = <yt.wrapper.client.YtClient object>)

     113             allow_retries=allow_retries,
     114             decode_content=decode_content,
  -> 115             client=client)
     116     else:
     117         raise YtError("Incorrect backend type: " + backend)

Vars:
  client = <yt.wrapper.client.YtClient at 0x7f8668ab3f90>

------------------------------
/home/robot-taxi-stat/<decorator-gen-2>:
 in make_request(command_name = 'insert_rows', params = {'input_format': {'attributes': {'boolean_as_string': False, 'ign...es': False, 'format': 'binary'}, 'value': 'yson'}, 'path': '//home/taxi-dwh/raw/mdb/order_proc/2018-01-01', 'update': 'true'}, data = '{\x01\x06doc={\x01\x0cstatus=\x01\x10finished;\x01\x0eupdated=\x0142018-04-...9f48a9828a;\x01\x16etl_updated=\x01&2018-04-19 20:40:07;};', is_data_compressed = False, return_content = True, response_format = None, use_heavy_proxy = True, timeout = 60000, client = <yt.wrapper.client.YtClient object>, allow_retries = None, decode_content = False)


Vars:

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/common.py:
 in forbidden_inside_job(func = <function make_request>, *args = ('insert_rows', {'input_format': {'attributes': {'boolean_as_string': False, 'ign...es': False, 'format': 'binary'}, 'value': 'yson'}, 'path': '//home/taxi-dwh/raw/mdb/order_proc/2018-01-01', 'update': 'true'}, '{\x01\x06doc={\x01\x0cstatus=\x01\x10finished;\x01\x0eupdated=\x0142018-04-...9f48a9828a;\x01\x16etl_updated=\x01&2018-04-19 20:40:07;};', False, True, None, True, 60000, <yt.wrapper.client.YtClient object>, None, False), **kwargs = {})

     243                       'you can override this behaviour by turning on '
     244                       '"allow_http_requests_to_yt_from_job" option in config.')
  -> 245     return func(*args, **kwargs)
     246
     247 class DoNotReplaceAction(argparse.Action):

Vars:
  func = <function yt.wrapper.http_driver.make_request>
  args = ('insert_rows',
          {'input_format': {'attributes': {'boolean_as_string': False, 'ignore_inner_attributes': False, 'always_create_attributes': False, 'format': 'binary'}, 'value': 'yson'},
           'path': '//home/taxi-dwh/raw/mdb/order_proc/2018-01-01',
           'update': 'true'},
          '{\x01\x06doc={\x01\x0cstatus=\x01\x10finished;\x01\x0eupdated=\x0142018-04-19 20:35:16.650000;\x01\x12performer={\x01\x1ecandidate_index=#;\x01\x12need_sync=\x04;\x01\x12presetcar=\x04;\x01\x10alias_id=#;\x01\x12driver_id=#;\x01\x0epark_id=#;};\x01\x0ecreated=\x0142018-01-09 12:06:27.869000;\x01\x0ealiases=[{\x01\x14generation=\x02\x02;\x01\x1cdue_optimistic=#;\x01\x04id=\x01@dbae3b14bf7f4037bfe6aeca0a853ee5;\x01\x06due=\x0142018-01-09 12:10:00.000000;};];\x01\x14order_link=\x01@60918985e03b4e968f5f167ec11f95db;\x01\x14processing={\x01\x0eversion=\x02";};\x01\x14order_info={\x01\x16with_coupon=\x04;\x01\x14statistics={\x01\x1cstatus_updates=[{\x01\x02q=\x01\x0ccreate;\x01\x02h=\x04;\x01\x02c=\x0142018-01-09 12:06:27.869000;\x01\x02s=\x01\x0epending;};{\x01\x02c=\x0142018-01-09 12:06:33.240000;\x01\x02d=[\x03\xca\xca\'\x12\xe9\x8dH@;\x03\xdd\xa1\x9b\xdcs\xe3K@;];\x01\x02i=\x02\x00;\x01\x02h=\x04;\x01\x02q=\x01\x08seen;\x01\x02p={\x01\x0eupdated=\x0142018-01-09 12:06:33.2400
 00;\x01\x10geopoint=[\x03\xca\xca\'\x12\xe9\x8dH@;\x03\xdd\xa1\x9b\xdcs\xe3K@;];\x01\x12direction=\x03\x00\x00\x00\x00\x00\x00\x00\x00;\x01\x16taxi_status=\x01\x0epending;\x01\x08time=\x0142018-01-09 12:06:33.000000;\x01\x12avg_speed=\x03\x00\x00\x00\x00\x00\x00\x00\x00;};};{\x01\x02i=\x02\x00;\x01\x02h=\x04;\x01\x02c=\x0142018-01-09 12:06:35.135000;\x01\x02s=\x01\x10assigned;\x01\x02g=\x02\x02;};{\x01\x02c=\x0142018-01-09 12:06:35.135000;\x01\x02d=[\x03\xca\xca\'\x12\xe9\x8dH@;\x03\xdd\xa1\x9b\xdcs\xe3K@;];\x01\x02i=\x02\x00;\x01\x02h=\x04;\x01\x02l=\x03\x00\x00\x00\x00,d\xa3@;\x01\x02p={\x01\x0eupdated=\x0142018-01-09 09:06:34.000000;\x01\x10geopoint=[\x03\xca\xca\'\x12\xe9\x8dH@;\x03\xdd\xa1\x9b\xdcs\xe3K@;];\x01\x12direction=\x03\x00\x00\x00\x00\x00\x00\x00\x00;\x01\x16taxi_status=\x01\x0edriving;\x01\x08time=\x0142018-01-09 12:06:32.000000;\x01\x12avg_speed=\x03\x00\x00\x00\x00\x00\x00\x00\x00;};\x01\x02t=\x01\x0edriving;};{\x01\x02c=\x0142018-01-09 12:09:38.704000;\x01\x02d=[\
 x03\x9fg`\xa2\xc9\x8dH@;\x03MS\x80\xff\x18\xe4K@;];\x01\x02i=\x02\x00;\x01\x02h=\x04;\x01\x02l=\x03\x00\x00\x00\x000\xed\x86@;\x01\x02p={\x01\x0eupdated=\x0142018-01-09 09:09:38.000000;\x01\x10geopoint=[\x03\x9fg`\xa2\xc9\x8dH@;\x03MS\x80\xff\x18\xe4K@;];\x01\x12direction=\x03\x00\x00\x00\x00\x00ht@;\x01\x16taxi_status=\x01\x0ewaiting;\x01\x08time=\x0142018-01-09 12:09:34.000000;\x01\x12avg_speed=\x03\x00\x00\x00\x00\x00\x00@@;};\x01\x02t=\x01\x0ewaiting;};{\x01\x02a={\x01\x14comment_id=\x010REFUSE_TO_COMPLETE_ORDER;};\x01\x02c=\x0142018-01-09 12:13:39.243000;\x01\x02d=[\x03\x8c\x9a3\xcb\xb3\x8dH@;\x03IA}\xec*\xe4K@;];\x01\x02i=\x02\x00;\x01\x02h=\x04;\x01\x02q=\x01\x16autoreorder;\x01\x02s=\x01\x0epending;\x01\x02r=\x01\x0cmanual;\x01\x02t=#;};{\x01\x02i=\x02\x02;\x01\x02h=\x05;\x01\x02c=\x0142018-01-09 12:14:50.967000;\x01\x02q=\x01\x18seen_timeout;};{\x01\x02h=\x05;\x01\x02c=\x0142018-01-09 12:15:21.466000;\x01\x04fc=\x04;\x01\x02s=\x01\x12cancelled;};];\x01"assign_route_time=\x0
 3\xe1z\x14\xaeG\x19b@;\x01\x18assign_surge=\x03\x00\x00\x00\x00\x00\x00\xf0?;\x01*corp_ride_report_sent=\x04;\x01 ride_report_sent=\x04;\x01\x10setcared=#;};\x01\x18source_point=[\x03A\x13\x176\xb9\x8dH@;\x03dr\x0f\xae%\xe4K@;];\x01\x12need_sync=\x05;};\x01\x14insurer_id=\x01@83d0d8e57b9242f7a7968653ecfe490b;\x01\x0etrigger={\x01\x02s={\x01\x16seentimeout={\x01\x16last_called=\x0142018-01-09 12:14:50.967000;};\x01\x14lookupinit={\x01\x16last_called=\x0142018-01-09 12:13:39.696000;};};};\x01\x0clookup={\x01\x08name=\x01"direct_assignment;\x01\x14generation=\x02\x06;\x01\x14need_start=\x05;\x01\nstate={};\x01\x06eta=\x0142018-01-09 12:13:39.696000;\x01\x0cparams={};\x01\x0eversion=\x02\x04;\x01\x16restart_eta=#;\x01\x12start_eta=\x0142018-01-09 12:13:39.243000;\x01$generation_updated=\x0142018-01-09 12:13:39.696000;};\x01\x16autoreorder={\x01\x12decisions=[{\x01\x0ecreated=\x0142018-01-09 12:13:39.243000;};];};\x01\x06_id=\x01@7452c580e33c4422ae581a9f48a9828a;\x01\x0echanges={\x01\x0e
 objects=[{\x01\x04ci=\x01@a23e364afa6d4543942c1c42af945a5c;\x01\x02s=\x01\x0eapplied;\x01\x04vl=\x04;\x01\x02c=\x0142018-01-09 12:10:41.011000;\x01\x04vr=\x02\x08;\x01\x02n=\x01\x14user_ready;\x01\x04si={\x01\x02s=\x01\x12delivered;\x01\x02c=\x02\x00;};\x01\x02t=\x0142018-01-09 12:10:39.000000;\x01\x04id=\x01@624886643c0c48b8a41b921a5486d692;};{\x01\x04ci=\x01@a23e364afa6d4543942c1c42af945a5c;\x01\x02s=\x01\x0eapplied;\x01\x04vl=\x05;\x01\x02c=\x0142018-01-09 12:10:41.011000;\x01\x04vr=\x02\x08;\x01\x02n=\x01\x14user_ready;\x01\x04si={\x01\x02s=\x01\x12delivered;\x01\x02c=\x02\x02;\x01\x02t=\x0142018-01-09 12:10:41.621000;};\x01\x02t=\x0142018-01-09 12:10:39.000000;\x01\x04id=\x01@ca2315d469c14ffd80b74657d6148b1b;};];};\x01\norder={\x01\x0cstatus=\x01\x12cancelled;\x01\x16fixed_price={\x01\nprice=\x03\x00\x00\x00\x00\x00@P@;\x01\x16destination=[\x03\xfb\xea\xaa@-\x8cH@;\x03\xa5\x84`U\xbd\xe2K@;];\x01.show_price_in_taximeter=\x05;\x01&max_distance_from_b=\x02\xe8\x07;};\x01\x16termin
 al_id=#;\x01\n_type=\x01\x08soon;\x01\x08cost=#;\x01\x1cstatus_updated=\x0142018-01-09 12:15:21.466000;\x01\x16referral_id=#;\x01\x08city=\x01\x18\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c;\x01\x0euser_id=\x01@a23e364afa6d4543942c1c42af945a5c;\x01$referral_timestamp=#;\x01\x16application=\x01\x0eandroid;\x01\x04nz=\x01\nkazan;\x01\x0eversion=\x02\x0e;\x01\x08calc={\x01\x10distance=\x03R\xb8\x1e\x85\xebJ\x9c@;\x01\x1eallowed_tariffs={\x01\x10__park__={\x01\x06vip=\x03\x00\x00\x00\x00\x00\xb0r@;\x01\x0ceconom=\x03\x00\x00\x00\x00\x00@P@;\x01\x10business=\x03\x00\x00\x00\x00\x00\x80\\@;};};\x01\x18recalculated=\x04;\x01\x08time=\x03\x00\x00@3(\xban@;\x012extra_distance_multiplier=\x03\x00\x00\x00\x00\x00\x00\xf0?;};\x01\x18payment_tech={\x01\x1chold_initiated=\x04;\x01.main_card_persistent_id=#;\x01(main_card_billing_id=#;\x01(main_card_payment_id=#;\x01\x10need_cvn=\x04;\x01\x08debt=\x04;\x01\x08type=\x01\x08cash;\x01\x1alast_known_ip=\x01$::ffff:85.140.2.34;};\x01\x1auser_phone
 _id=\x0105814aacb21586f10fe1657bd;\x01\x1coperator_login=#;\x01\x10user_uid=\x01\x12577064411;\x01\x12dont_call=\x04;\x01\x06rsk=\x01@1915db7bcfe04b3c8935924686be346e;\x01\x12vendor_id=#;\x01\x16user_locale=\x01\x04ru;\x01\x16taxi_status=#;\x01\x14user_ready=\x05;\x01\x12device_id=\x01P22f06c3cd04bf93d7b8864c32a759888f2d8b07d;\x01\x0ecreated=\x0142018-01-09 12:06:27.763000;\x01\x0erequest={\x01\x0ecomment=\x01\x00;\x01\x14source_raw={\x01\x18use_geopoint=\x04;\x01\x16description=\x01\x86\x01\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f;\x01\x18thoroughfare=\x01>\xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0;\x01\x10locality=\x01\x18\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c;\x01\x0ecountry=\x01\x18\
 xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f;\x01\x10geopoint=[\x03A\x13\x176\xb9\x8dH@;\x03dr\x0f\xae%\xe4K@;];\x01\x08type=\x01\x0eaddress;\x01\x16object_type=\x01\x18\xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb5;\x01\x10fullname=\x01\xd0\x01\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0, 39;\x01\x1apremisenumber=\x01\x0439;\x01\nexact=\x05;\x01\x14short_text=\x01F\xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0, 39;\x01\x06oid=\x01\x1056267164;};\x01\x1aservice_level=\x02d;\x01\x18requirements={};\x01\noffer=\x01@475f8565697e42eea803b00f3cdb2277;\x01\x04sp=\x03\x00\x00\x00\x00\x
 00\x00\xf0?;\x01\x06due=\x0142018-01-09 12:10:00.000000;\x01\x0epayment={\x01\x08type=\x01\x08cash;\x01"payment_method_id=#;};\x01\x0csource={\x01\x18use_geopoint=\x04;\x01\x16description=\x01\x86\x01\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f;\x01\x18thoroughfare=\x01>\xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0;\x01\x10locality=\x01\x18\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c;\x01\x0ecountry=\x01\x18\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f;\x01\x10geopoint=[\x03A\x13\x176\xb9\x8dH@;\x03dr\x0f\xae%\xe4K@;];\x01\x08type=\x01\x0eaddress;\x01\x16object_type=\x01\x18\xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb5;\x01\x10fullname=\x01\xd0\x01\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x
 8f, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0, 39;\x01\x1apremisenumber=\x01\x0439;\x01\nexact=\x05;\x01\x14short_text=\x01F\xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0 \xd0\x9d\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xb0, 39;\x01\x06oid=\x01\x1056267164;};\x01\x08corp={\x01\x16cost_center=#;};\x01\x1cexcluded_parks=[];\x01*ignore_excluded_parks=\x05;\x01\x18destinations=[{\x01\x18use_geopoint=\x04;\x01\x16description=\x01\x86\x01\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f;
 \x01\x18thoroughfare=\x016\xd0\x9f\xd0\xbe\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x8f \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0;\x01\x10locality=\x01\x18\xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c;\x01\x0ecountry=\x01\x18\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f;\x01\x10geopoint=[\x03\xfb\xea\xaa@-\x8cH@;\x03\xa5\x84`U\xbd\xe2K@;];\x01\x08type=\x01\x0eaddress;\x01\x16object_type=\x01\x18\xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb5;\x01\x10fullname=\x01\xc6\x01\xd0\xa0\xd0\xbe\xd1\x81\xd1\x81\xd0\xb8\xd1\x8f, \xd0\xa0\xd0\xb5\xd1\x81\xd0\xbf\xd1\x83\xd0\xb1\xd0\xbb\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xa2\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd, \xd0\x9a\xd0\xb0\xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8c, \xd0\x9f\xd0\xbe\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x8f \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb0, 2;\x01\x1apremisenumber=\x01\x022;\x01\nexact=\x05;\x01\x14short_text=\x01<\xd0\x9f\xd0\xbe\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x8f \xd1\x83\xd
 0\xbb\xd0\xb8\xd1\x86\xd0\xb0, 2;\x01\x06oid=\x01\x1056257878;};];\x01\nclass=[\x01\x0ceconom;];\x01\x1esource_geoareas=[\x01 kazan_activation;\x01\nkazan;\x01\nKazan;];\x010driverclientchat_enabled=\x04;};\x01\x16experiments=[\x01,address_change_logging;\x01&antifraud_fix_price;\x01&autoreorder_android;\x012autoreorder_notifications;\x016change_card_during_the_ride;\x01"direct_assignment;\x01,dynamic_transfer_price;\x01$feedback_user_chat;\x01\x1cfiscal_receipt;\x01\x16fixed_price;\x01\x18forced_surge;\x01\x16hunger_time;\x01\x0enew_stq;\x01"open_near_point_a;\x01$order_show_comment;\x01\x1cpayment_change;\x01\x18pool_tooltip;\x01\x18route_adjust;\x01 route_adjust_eta;\x01\x14routing_42;\x01$surge_add_business;\x01\x1csurge_distance;\x01\x14surgeprice;\x01$taximeter_complete;\x01\x14trash_test;\x01*user_position_enabled;];\x01\x14user_agent=\x01\x80\x01yandex-taxi/3.50.1.15759 Android/5.1.1 (Micromax; Micromax Q415);\x01\x10dont_sms=\x05;};\x01\x0ereorder={\x01\x16suggestions=[];\x
 01\x12decisions=[];};\x01\x14candidates=[{\x01\x04ci=\x01@f8b9e6bc1b264e62a731ae6843234dc8;\x01\x08dist=\x03\x9e\xef\xa7\xc6K{\x86@;\x01\npoint=[\x03\x05\t\x1f\x84\xdf\x8dH@;\x03\xf2[\xf8\xeax\xe3K@;];\x01\x04is=\x05;\x01\x10alias_id=\x01@dbae3b14bf7f4037bfe6aeca0a853ee5;\x01\x06ost=\x0142018-01-09 12:06:29.075000;\x01\x16experiments=[\x014proxy_gps_set_to_geotracks;\x01\x18show_traning;\x01$order_show_comment;\x01\x1aassign_new_ui;\x01Fclientdriver_chat_recognize_message;\x016partner_program_burger_king;];\x01\x04ar=\x03\x00\x00\x00\x00\x00\x00\xe0?;\x01\x12dp_values={\x01\x02c=\x02\x02;\x01\x02r=\x02\x01;};\x01\x1cadjusted_point={\x01\x12avg_speed=\x02\x00;\x01\x12direction=\x02\x01;\x01\x10geopoint=[\x03\x05\t\x1f\x84\xdf\x8dH@;\x03\xf2[\xf8\xeax\xe3K@;];\x01\x08time=\x02\xee\xc0\xa5\xa5\x0b;};\x01\x1cdriver_license=\x01\x141625458154;\x01\x04cr=\x03\xc3\xf5(\\\x8f\xc2\xed?;\x010driverclientchat_enabled=\x05;\x01\x04dr=#;\x01"taximeter_version=\x01\x088.44;\x01\x04rd=\x05;\x01\x1
 0dbcar_id=\x01@cfae94a1d3c74db6845c54833ebc88f2;\x01\x04dp=#;\x01\x12gprs_time=\x03\xa6\x9b\xc4 \xb0\xb22@;\x01\x10setcared=\x0142018-01-09 12:06:29.075000;\x01\x04dm=#;\x01\ndb_id=\x01@eafd8352bb7249a0800739e70548f3ce;\x01"requestcar_status=\x01\x10finished;\x01\x12car_model=\x01$LADA (\xd0\x92\xd0\x90\xd0\x97) 2114;\x01\x14car_number=\x01\x18\xd0\xa0204\xd0\x90\xd0\x90116;\x01\x1etariff_currency=\x01\x06RUB;\x01\x1ecancel_attempts=\x02\x06;\x01\nphone=\x01\x18+79600673457;\x01\x02z=[\x01@dc4adce8fe134691a678c05174574905;];\x01\x04dv=#;\x01\x12line_dist=\x03\x0e~\xf3\t\xa8w\x82@;\x01\x04hd=\x05;\x01\x12car_color=\x01\x18\xd1\x87\xd0\xb5\xd1\x80\xd0\xbd\xd1\x8b\xd0\xb9;\x012last_failed_cancelrequest=\x0142018-01-09 12:15:30.782000;\x01\x12tariff_id=\x01@f8b9e6bc1b264e62a731ae6843234dc8;\x01\x08name=\x01X\xd0\x91\xd1\x83\xd1\x88\xd1\x83\xd0\xb5\xd0\xb2 \xd0\xa1\xd0\xb5\xd1\x80\xd0\xb3\xd0\xb5\xd0\xb9 \xd0\xa1\xd0\xb5\xd1\x80\xd0\xb3\xd0\xb5\xd0\xb5\xd0\xb2\xd0\xb8\xd1\x87;\x01\x0ecre
 ated=\x0142018-01-09 12:06:28.745000;\x01\x1acancel_status=\x01\x10finished;\x01$driver_experiments=[\x01\x1aassign_new_ui;\x01Fclientdriver_chat_recognize_message;\x01$order_show_comment;\x016partner_program_burger_king;\x014proxy_gps_set_to_geotracks;\x01\x18show_traning;];\x01\x12driver_id=\x01V1956793037_05c6b0500fe545459c151ce3a98c7107;\x01\x08time=\x03\xf6(\\\x8f\xc2\xc5^@;\x01\x1ccar_color_code=\x01\x0c040001;\x01\x18tariff_class=\x01\x0ceconom;};{\x01"requestcar_status=\x01\x10finished;\x01\x04hd=\x05;\x01\x10setcared=\x0142018-01-09 12:13:53.743000;\x01\x1acancel_status=\x01\x10finished;\x01\x06ost=\x0142018-01-09 12:13:53.743000;};];};\x01\x0eupdated=\x01&2018-04-19 20:35:16;\x01\x1aorder_created=\x01&2018-01-09 12:06:27;\x01\x04id=\x01@7452c580e33c4422ae581a9f48a9828a;\x01\x16etl_updated=\x01&2018-04-19 20:40:07;};',
          False,
          True,
          None,
          True,
          60000,
          <yt.wrapper.client.YtClient at 0x7f8668ab3f90>,
          None,
          False)
  kwargs = {}

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/http_driver.py:
 in make_request(command_name = 'insert_rows', params = {'input_format': {'attributes': {'boolean_as_string': False, 'ign...es': False, 'format': 'binary'}, 'value': 'yson'}, 'path': '//home/taxi-dwh/raw/mdb/order_proc/2018-01-01', 'update': 'true'}, data = <generator object __call__>, is_data_compressed = False, return_content = True, response_format = None, use_heavy_proxy = True, timeout = 60000, client = <yt.wrapper.client.YtClient object>, allow_retries = False, decode_content = False)

     270         is_ping=(command_name == "ping_tx"),
     271         proxy_provider=proxy_provider,
  -> 272         client=client)
     273
     274     def process_error(response):

Vars:
  client = <yt.wrapper.client.YtClient at 0x7f8668ab3f90>

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/http_helpers.py:
 in make_request_with_retries(method = 'PUT', url = 'http://{proxy}/api/v3/insert_rows', **kwargs = {'auth': <yt.wrapper.http_driver.TokenAuth object>, 'client': <yt.wrapper.client.YtClient object>, 'data': <generator object __call__>, 'headers': {'Accept-Encoding': 'gzip, identity', 'Content-Encoding': 'gzip', 'User-Agent': 'Python wrapper 0.8.27-0', 'X-Started-By': '{"pid"=34397;"user"="robot-taxi-stat";}', 'X-YT-Correlation-Id': '6ec61586-ca91fe3d-8b0b7c9f-cf1fa36f', 'X-YT-Header-Format': '<format=text>yson', 'X-YT-Parameters': '{"path"="//home/taxi-dwh/raw/mdb/order_proc/2018...te_attributes"=%false;"format"="binary";>"yson";}'}, 'is_ping': False, 'log_body': False, 'make_retries': False, 'params': {'input_format': {'attributes': {'boolean_as_string': False, 'ign...es': False, 'format': 'binary'}, 'value': 'yson'}, 'path': '//home/taxi-dwh/raw/mdb/order_proc/2018-01-01', 'update': 'true'}, 'proxy_provider': <yt.wrapper.http_driver.HeavyProxyProvider object>, 'response_format': No
 ne, ...})

     288     This function is for backward compatibility and convenience of use.
     289     """
  -> 290     return RequestRetrier(method=method, url=url, **kwargs).run()
     291
     292

Vars:
  global RequestRetrier = yt.wrapper.http_helpers.RequestRetrier
  method = 'PUT'
  url = 'http://{proxy}/api/v3/insert_rows'
  kwargs = {'auth': <yt.wrapper.http_driver.TokenAuth at 0x7f857202c150>,
            'client': <yt.wrapper.client.YtClient at 0x7f8668ab3f90>,
            'data': <generator object __call__ at 0x7f858cd8cd70>,
            'headers': {'Accept-Encoding': 'gzip, identity',
             'Content-Encoding': 'gzip',
             'User-Agent': 'Python wrapper 0.8.27-0',
             'X-Started-By': '{"pid"=34397;"user"="robot-taxi-stat";}',
             'X-YT-Correlation-Id': '6ec61586-ca91fe3d-8b0b7c9f-cf1fa36f',
             'X-YT-Header-Format': '<format=text>yson',
             'X-YT-Parameters': '{"path"="//home/taxi-dwh/raw/mdb/order_proc/2018-01-01";"update"="true";"input_format"=<"boolean_as_string"=%false;"ignore_inner_attributes"=%false;"always_create_attributes"=%false;"format"="binary";>"yson";}'},
            'is_ping': False,
            'log_body': False,
            'make_retries': False,
            'params': {'input_format': {'attributes': {'boolean_as_string': False, 'ignore_inner_attributes': False, 'always_create_attributes': False, 'format': 'binary'}, 'value': 'yson'},
             'path': '//home/taxi-dwh/raw/mdb/order_proc/2018-01-01',
             'update': 'true'},
            'proxy_provider': <yt.wrapper.http_driver.HeavyProxyProvider at 0x7f86537c64d0>,
            'response_format': None,
            'retry_action': None,
            'stream': False,
            'timeout': 60000}
  ).run is undefined

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/retries.py:
 in run(self = <yt.wrapper.http_helpers.RequestRetrier object>)

      57                 if self.chaos_monkey_enabled and random.randint(1, 5) == 1:
      58                     raise YtRetriableError()
   -> 59                 return self.action()
      60             except self.exceptions as exception:
      61                 if attempt == retry_count:

Vars:
  self = <yt.wrapper.http_helpers.RequestRetrier at 0x7f857202cd90>
  self.action = <bound method RequestRetrier.action of <yt.wrapper.http_helpers.RequestRetrier object at 0x7f857202cd90>>

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/http_helpers.py:
 in action(self = <yt.wrapper.http_helpers.RequestRetrier object>)

     258         logger.debug("Response headers %r", hide_token(dict(response.headers)))
     259
  -> 260         _raise_for_status(response, request_info)
     261         return response
     262

Vars:
  global _raise_for_status = <function yt.wrapper.http_helpers._raise_for_status>
  response = <Response [400]>
  request_info = {'headers': {'Accept-Encoding': 'gzip, identity',
                   'Content-Encoding': 'gzip',
                   'User-Agent': 'Python wrapper 0.8.27-0',
                   'X-Started-By': '{"pid"=34397;"user"="robot-taxi-stat";}',
                   'X-YT-Correlation-Id': '6ec61586-ca91fe3d-8b0b7c9f-cf1fa36f',
                   'X-YT-Header-Format': '<format=text>yson',
                   'X-YT-Parameters': '{"path"="//home/taxi-dwh/raw/mdb/order_proc/2018-01-01";"update"="true";"input_format"=<"boolean_as_string"=%false;"ignore_inner_attributes"=%false;"always_create_attributes"=%false;"format"="binary";>"yson";}'},
                  'params': {'input_format': {'attributes': {'boolean_as_string': False, 'ignore_inner_attributes': False, 'always_create_attributes': False, 'format': 'binary'}, 'value': 'yson'},
                   'path': '//home/taxi-dwh/raw/mdb/order_proc/2018-01-01',
                   'update': 'true'},
                  'url': 'http://n0396-sas.hahn.yt.yandex.net/api/v3/insert_rows'}

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/http_helpers.py:
 in _raise_for_status(response = <Response [400]>, request_info = {'headers': {'Accept-Encoding': 'gzip, identity', 'Content-Encoding': 'gzip', 'User-Agent': 'Python wrapper 0.8.27-0', 'X-Started-By': '{"pid"=34397;"user"="robot-taxi-stat";}', 'X-YT-Correlation-Id': '6ec61586-ca91fe3d-8b0b7c9f-cf1fa36f', 'X-YT-Header-Format': '<format=text>yson', 'X-YT-Parameters': '{"path"="//home/taxi-dwh/raw/mdb/order_proc/2018...te_attributes"=%false;"format"="binary";>"yson";}'}, 'params': {'input_format': {'attributes': {'boolean_as_string': False, 'ign...es': False, 'format': 'binary'}, 'value': 'yson'}, 'path': '//home/taxi-dwh/raw/mdb/order_proc/2018-01-01', 'update': 'true'}, 'url': 'http://n0396-sas.hahn.yt.yandex.net/api/v3/insert_rows'})

     159
     160     if not response.is_ok():
  -> 161         raise YtHttpResponseError(error=response.error(), **request_info)
     162
     163

Vars:
  global YtHttpResponseError = yt.wrapper.errors.YtHttpResponseError
  error is undefined
  response = <Response [400]>
  response.error = <bound method ?.error of <Response [400]>>
  request_info = {'headers': {'Accept-Encoding': 'gzip, identity',
                   'Content-Encoding': 'gzip',
                   'User-Agent': 'Python wrapper 0.8.27-0',
                   'X-Started-By': '{"pid"=34397;"user"="robot-taxi-stat";}',
                   'X-YT-Correlation-Id': '6ec61586-ca91fe3d-8b0b7c9f-cf1fa36f',
                   'X-YT-Header-Format': '<format=text>yson',
                   'X-YT-Parameters': '{"path"="//home/taxi-dwh/raw/mdb/order_proc/2018-01-01";"update"="true";"input_format"=<"boolean_as_string"=%false;"ignore_inner_attributes"=%false;"always_create_attributes"=%false;"format"="binary";>"yson";}'},
                  'params': {'input_format': {'attributes': {'boolean_as_string': False, 'ignore_inner_attributes': False, 'always_create_attributes': False, 'format': 'binary'}, 'value': 'yson'},
                   'path': '//home/taxi-dwh/raw/mdb/order_proc/2018-01-01',
                   'update': 'true'},
                  'url': 'http://n0396-sas.hahn.yt.yandex.net/api/v3/insert_rows'}


---------====== Detailed exception attributes ======-------------

_cached_fqdn = 'taxi-etl01h.taxi.yandex.net'
_get_fqdn = <function _get_fqdn>
args = ()
attributes = {'datetime': '2018-04-19T20:41:44.855610Z', 'headers': {'X-YT-Correlation-Id': '6ec61586-ca91fe3d-8b0b7...t>yson', 'User-Agent': 'Python wrapper 0.8.27-0'}, 'host': 'taxi-etl01h.taxi.yandex.net', 'params': {'path': '//home/taxi-dwh/raw/mdb/order_proc/201...s': False, 'format': 'binary'}, 'value': 'yson'}}, 'transparent': True, 'url': 'http://n0396-sas.hahn.yt.yandex.net/api/v3/insert_rows'}
code = 1
contains_code = <bound method YtHttpResponseError.contains_code of YtHttpResponseError()>
contains_text = <bound method YtHttpResponseError.contains_text of YtHttpResponseError()>
error = {u'attributes': {u'address': u'n6358-sas.hahn.yt.yandex.net:9012', u'connection_id': u'20b-16a22aea-6bb0c911-4ebcf470', u'datetime': u'2018-04-19T20:41:44.842076Z', u'fid': 18445142183021960716L, u'host': u'n6358-sas.hahn.yt.yandex.net', u'method': u'Write', u'pid': 290501, u'realm_id': u'7fb0-e967-3fe02bc-3f723b2e', u'request_id': u'553078-3143181e-941bc7a9-2ce9a54', u'service': u'TabletService', ...}, u'code': 1703, u'inner_errors': [], u'message': u'Node is out of tablet memory, all writes disabled'}
headers = {'Accept-Encoding': 'gzip, identity', 'Content-Encoding': 'gzip', 'User-Agent': 'Python wrapper 0.8.27-0', 'X-Started-By': '{"pid"=34397;"user"="robot-taxi-stat";}', 'X-YT-Correlation-Id': '6ec61586-ca91fe3d-8b0b7c9f-cf1fa36f', 'X-YT-Header-Format': '<format=text>yson', 'X-YT-Parameters': '{"path"="//home/taxi-dwh/raw/mdb/order_proc/2018...te_attributes"=%false;"format"="binary";>"yson";}'}
inner_errors = [{u'attributes': {u'address': u'n6358-sas.hahn.yt.yandex.net:9012', u'connection_id': u'20b-16a22aea-6bb0c911-4ebcf470', u'datetime': u'2018-04-19T20:41:44.842076Z', u'fid': 18445142183021960716L, u'host': u'n6358-sas.hahn.yt.yandex.net', u'method': u'Write', u'pid': 290501, u'realm_id': u'7fb0-e967-3fe02bc-3f723b2e', u'request_id': u'553078-3143181e-941bc7a9-2ce9a54', u'service': u'TabletService', ...}, u'code': 1703, u'inner_errors': [], u'message': u'Node is out of tablet memory, all writes disabled'}]
is_access_denied = <bound method YtHttpResponseError.is_access_denied of YtHttpResponseError()>
is_chunk_unavailable = <bound method YtHttpResponseError.is_chunk_unavailable of YtHttpResponseError()>
is_concurrent_operations_limit_reached = <bound method YtHttpResponseError.is_concurrent_operations_limit_reached of YtHttpResponseError()>
is_concurrent_transaction_lock_conflict = <bound method YtHttpResponseError.is_concurrent_transaction_lock_conflict of YtHttpResponseError()>
is_master_communication_error = <bound method YtHttpResponseError.is_master_communication_error of YtHttpResponseError()>
is_no_such_transaction = <bound method YtHttpResponseError.is_no_such_transaction of YtHttpResponseError()>
is_request_queue_size_limit_exceeded = <bound method YtHttpResponseError.is_request_queue_size_limit_exceeded of YtHttpResponseError()>
is_request_rate_limit_exceeded = <bound method YtHttpResponseError.is_request_rate_limit_exceeded of YtHttpResponseError()>
is_request_timed_out = <bound method YtHttpResponseError.is_request_timed_out of YtHttpResponseError()>
is_resolve_error = <bound method YtHttpResponseError.is_resolve_error of YtHttpResponseError()>
is_shell_exited = <bound method YtHttpResponseError.is_shell_exited of YtHttpResponseError()>
message = 'Received HTTP response with error'
params = {'input_format': {'attributes': {'boolean_as_string': False, 'ign...es': False, 'format': 'binary'}, 'value': 'yson'}, 'path': '//home/taxi-dwh/raw/mdb/order_proc/2018-01-01', 'update': 'true'}
simplify = <bound method YtHttpResponseError.simplify of YtHttpResponseError()>
url = 'http://n0396-sas.hahn.yt.yandex.net/api/v3/insert_rows'
