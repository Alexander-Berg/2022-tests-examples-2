##HEADER
accident_id: '635eda0e-b458-466b-8c34-40e05857ee02'
run_id: '12345'
task: 'fraud'
creation_dttm: '20180402000001'
##DESCRIPTION
Exception message: //home/taxi-fraud/import/production/driver has no child "2018-03-01"; consider using "recursive" option to force its creation

***** Details:
Received HTTP response with error
    origin taxi-etl01h.taxi.yandex.net in 2018-03-27T21:35:40.487361Z
    headers {
                      "X-YT-Correlation-Id": "7bf0fde3-c22f4706-b72165c7-3c748d19",
                      "X-YT-Parameters": "{\"path\"=\"//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec\";\"retry\"=\"false\";\"mutation_id\"=\"15278e2e-dc71289f-7bdea52b-9eeb833\";\"transaction_id\"=\"a506-f795-3fe0001-d99427bf\";\"input_format\"=<\"boolean_as_string\"=%false;\"ignore_inner_attributes\"=%false;\"always_create_attributes\"=%false;\"format\"=\"binary\";>\"yson\";}",
                      "Accept-Encoding": "gzip, identity",
                      "X-Started-By": "{\"pid\"=550929;\"user\"=\"robot-taxi-stat\";}",
                      "X-YT-Header-Format": "<format=text>yson",
                      "User-Agent": "Python wrapper 0.8.27-0"
                    }
    params {
                      "path": "//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec",
                      "retry": "false",
                      "mutation_id": "15278e2e-dc71289f-7bdea52b-9eeb833",
                      "input_format": "yson",
                      "transaction_id": "a506-f795-3fe0001-d99427bf"
                    }
    url http://hahn.yt.yandex.net/api/v3/set
    transparent True
//home/taxi-fraud/import/production/driver has no child "2018-03-01"; consider using "recursive" option to force its creation
    code 500
    origin m01-sas.hahn.yt.yandex.net in 2018-03-27T21:35:40.478361Z (pid 709729, tid 9298b184443c6faf, fid ffd73cb709cf8027)


Exception type: <class 'yt.wrapper.errors.YtHttpResponseError'>
Python version: Python 2.7.6: /usr/bin/python


---------------====== Original traceback ======------------------

Traceback (most recent call last):
  File "/usr/lib/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/robot-taxi-stat/etl/layer/yt/export/fraud/driver/loader.py", line 305, in <module>
    FraudDMLoader(_fraud_windows).load()
  File "/home/robot-taxi-stat/etl/layer/yt/export/fraud/driver/loader.py", line 257, in load
    self._job.run()
  File "/usr/lib/python2.7/dist-packages/nile/api/v1/job.py", line 154, in run
    execution_plan.run()
  File "/usr/lib/python2.7/dist-packages/nile/drivers/yt/execution_plan.py", line 108, in run
    self._schedule_operations()
  File "/usr/lib/python2.7/dist-packages/nile/drivers/yt/execution_plan.py", line 145, in _schedule_operations
    self._do_runtime_prepare(node)
  File "/usr/lib/python2.7/dist-packages/nile/drivers/yt/execution_plan.py", line 161, in _do_runtime_prepare
    self._set_compression_level(node.object)
  File "/usr/lib/python2.7/dist-packages/nile/drivers/yt/execution_plan.py", line 283, in _set_compression_level
    value=value
  File "/usr/lib/python2.7/dist-packages/nile/drivers/yt/driver.py", line 206, in set_attribute
    self.client.set_attribute(str(path), attribute, value)
  File "<decorator-gen-77>", line 2, in set_attribute
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/client_helpers.py", line 48, in decorator
    return original_func(*args, client=self, **kwargs)
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/cypress_commands.py", line 367, in set_attribute
    return set("%s/@%s" % (path, attribute), value, client=client)
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/cypress_commands.py", line 87, in set
    client=client)
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/transaction_commands.py", line 10, in _make_transactional_request
    return make_request(command_name, params, **kwargs)
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/driver.py", line 115, in make_request
    client=client)
  File "<decorator-gen-2>", line 2, in make_request
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/common.py", line 245, in forbidden_inside_job
    return func(*args, **kwargs)
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/http_driver.py", line 272, in make_request
    client=client)
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/http_helpers.py", line 290, in make_request_with_retries
    return RequestRetrier(method=method, url=url, **kwargs).run()
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/retries.py", line 59, in run
    return self.action()
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/http_helpers.py", line 260, in action
    _raise_for_status(response, request_info)
  File "/usr/lib/python2.7/dist-packages/yt/wrapper/http_helpers.py", line 161, in _raise_for_status
    raise YtHttpResponseError(error=response.error(), **request_info)
YtHttpResponseError: //home/taxi-fraud/import/production/driver has no child "2018-03-01"; consider using "recursive" option to force its creation

***** Details:
Received HTTP response with error
    origin taxi-etl01h.taxi.yandex.net in 2018-03-27T21:35:40.487361Z
    headers {
                      "X-YT-Correlation-Id": "7bf0fde3-c22f4706-b72165c7-3c748d19",
                      "X-YT-Parameters": "{\"path\"=\"//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec\";\"retry\"=\"false\";\"mutation_id\"=\"15278e2e-dc71289f-7bdea52b-9eeb833\";\"transaction_id\"=\"a506-f795-3fe0001-d99427bf\";\"input_format\"=<\"boolean_as_string\"=%false;\"ignore_inner_attributes\"=%false;\"always_create_attributes\"=%false;\"format\"=\"binary\";>\"yson\";}",
                      "Accept-Encoding": "gzip, identity",
                      "X-Started-By": "{\"pid\"=550929;\"user\"=\"robot-taxi-stat\";}",
                      "X-YT-Header-Format": "<format=text>yson",
                      "User-Agent": "Python wrapper 0.8.27-0"
                    }
    params {
                      "path": "//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec",
                      "retry": "false",
                      "mutation_id": "15278e2e-dc71289f-7bdea52b-9eeb833",
                      "input_format": "yson",
                      "transaction_id": "a506-f795-3fe0001-d99427bf"
                    }
    url http://hahn.yt.yandex.net/api/v3/set
    transparent True
//home/taxi-fraud/import/production/driver has no child "2018-03-01"; consider using "recursive" option to force its creation
    code 500
    origin m01-sas.hahn.yt.yandex.net in 2018-03-27T21:35:40.478361Z (pid 709729, tid 9298b184443c6faf, fid ffd73cb709cf8027)


---------------====== Detailed traceback ======------------------

Traceback (most recent call last):

------------------------------
/usr/lib/python2.7/runpy.py:
 in _run_module_as_main(mod_name = 'layer.yt.export.fraud.driver.loader', alter_argv = 1)

     160 sys.argv[0] = fname
     161 return _run_code(code, main_globals, None,
  -> 162 "__main__", fname, loader, pkg_name)
     163
     164 def run_module(mod_name, init_globals=None,

Vars:
  fname = '/home/robot-taxi-stat/etl/layer/yt/export/fraud/driver/loader.py'
  loader = <pkgutil.ImpLoader instance at 0x7f6eb2b60b00>
  pkg_name = 'layer.yt.export.fraud.driver'

------------------------------
/usr/lib/python2.7/runpy.py:
 in _run_code(code = <code object <module> at 0x7f6eb2b7b9b0, file "/.../layer/yt/export/fraud/driver/loader.py", line 3>, run_globals = {'DEFAULT_DAYS': [1, 7, 15], 'FraudDMLoader': <class '__main__.FraudDMLoader'>, 'FraudDriverStats': <class 'layer.yt.export.fraud.driver.table.FraudDriverStats'>, 'FraudWindow': <class '__main__.FraudWindow'>, 'OdsOrder': <class 'layer.yt.ods.mdb.order.table.OdsOrder'>, 'Period': <class 'lib.datetime_utils.Period'>, 'Pool': <enum 'Pool'>, 'RawSubventions': <class 'layer.yt.raw.mdb.subventions.table.RawSubventions'>, 'Record': <class 'nile.processing.record.Record'>, 'SnpAccUserPhone': <class 'layer.yt.dds.snp_acc_user_phone.table.SnpAccUserPhone'>, ...}, init_globals = None, mod_name = '__main__', mod_fname = '/home/robot-taxi-stat/etl/layer/yt/export/fraud/driver/loader.py', mod_loader = <pkgutil.ImpLoader instance>, pkg_name = 'layer.yt.export.fraud.driver')

      70 __loader__ = mod_loader,
      71 __package__ = pkg_name)
   -> 72 exec code in run_globals
      73 return run_globals
      74

Vars:
  code = <code object <module> at 0x7f6eb2b7b9b0, file "/home/robot-taxi-stat/etl/layer/yt/export/fraud/driver/loader.py", line 3>
  run_globals = {'DEFAULT_DAYS': [1, 7, 15],
                 'FraudDMLoader': __main__.FraudDMLoader,
                 'FraudDriverStats': layer.yt.export.fraud.driver.table.FraudDriverStats,
                 'FraudWindow': __main__.FraudWindow,
                 'OdsOrder': layer.yt.ods.mdb.order.table.OdsOrder,
                 'Period': lib.datetime_utils.Period,
                 'Pool': lib.nile.cluster_utils.Pool,
                 'RawSubventions': layer.yt.raw.mdb.subventions.table.RawSubventions,
                 'Record': nile.processing.record.Record,
                 'SnpAccUserPhone': layer.yt.dds.snp_acc_user_phone.table.SnpAccUserPhone,
                 'StgDrivers': layer.yt.stg.mdb.drivers.table.StgDrivers,
                 'StgParks': layer.yt.stg.mdb.parks.table.StgParks,
                 'StgTariffs': layer.yt.stg.mdb.tariffs.table.StgTariffs,
                 'StgUsers': layer.yt.stg.mdb.users.table.StgUsers,
                 'SubStats': layer.yt.export.fraud.driver.metric.SubStats,
                 'Window': lib.datetime_utils.Window,
                 'YTMeta': lib.yt.meta.YTMeta,
                 'YqlSelect': lib.yql.operation.YqlSelect,
                 '__builtins__': <module '__builtin__' (built-in)>,
                 '__doc__': None,
                 '__file__': '/home/robot-taxi-stat/etl/layer/yt/export/fraud/driver/loader.py',
                 '__loader__': <pkgutil.ImpLoader instance at 0x7f6eb2b60b00>,
                 '__name__': '__main__',
                 '__package__': 'layer.yt.export.fraud.driver',
                 '_fielddate': '2018-03-27',
                 '_fraud_windows': [<__main__.FraudWindow at 0x7f6eaaa3e150>,
                  <__main__.FraudWindow at 0x7f6eaaa3ea50>,
                  <__main__.FraudWindow at 0x7f6eaaa3e8d0>],
                 'cu': <module 'lib.nile.cluster_utils' from '/home/robot-taxi-stat/etl/lib/nile/cluster_utils.pyc'>,
                 'day': 15,
                 'dt': <module 'datetime' from '/usr/lib/python2.7/lib-dynload/datetime.x86_64-linux-gnu.so'>,
                 'dtu': <module 'lib.datetime_utils' from '/home/robot-taxi-stat/etl/lib/datetime_utils.pyc'>,
                 'last_created_dttm': datetime.datetime(2018, 3, 27, 20, 20),
                 'last_order_creation': <function __main__.last_order_creation>,
                 'ne': <module 'nile.api.v1.extractors' from '/usr/lib/python2.7/dist-packages/nile/api/v1/extractors.py'>,
                 'qf': <module 'qb2.api.v1.filters' from '/usr/lib/python2.7/dist-packages/qb2/api/v1/filters.pyc'>,
                 'yt_etl': <module 'lib.yt.etl' from '/home/robot-taxi-stat/etl/lib/yt/etl.pyc'>,
                 'yt_op': <module 'lib.yt.operation' from '/home/robot-taxi-stat/etl/lib/yt/operation.pyc'>}

------------------------------
/home/robot-taxi-stat/etl/layer/yt/export/fraud/driver/loader.py:
 in <module>()

     301 period=Window().start(days=-day).apply(last_created_dttm),
     302 fielddate=_fielddate
     303 ) for day in DEFAULT_DAYS
     304 ]
  -> 305 FraudDMLoader(_fraud_windows).load()

Vars:
  FraudDMLoader = __main__.FraudDMLoader
  _fraud_windows = [<__main__.FraudWindow at 0x7f6eaaa3e150>,
                    <__main__.FraudWindow at 0x7f6eaaa3ea50>,
                    <__main__.FraudWindow at 0x7f6eaaa3e8d0>]
  ).load is undefined

------------------------------
/home/robot-taxi-stat/etl/layer/yt/export/fraud/driver/loader.py:
 in load(self = <__main__.FraudDMLoader object>)

     255 old_stream = self._job.table(meta.target_path())
     256 self._job.concat(old_stream, new_stream).put(meta.target_path())
  -> 257 self._job.run()
     258
     259

Vars:
  self = <__main__.FraudDMLoader at 0x7f6eaaa69350>
  self._job = Job 'driver fraud':
                  remote_input_table_output = RemoteInputTable(
                      path=Path('//home/taxi-dwh/stg/mdb/users/users'),
                      ignore_missing=False)
                  remote_input_table2_output = RemoteInputTable(
                      path=Path('//home/taxi-fraud/import/production/driver/2018-03-01'),
                      ignore_missing=False)
                  remote_input_table3_output = RemoteInputTable(
                      path=Path('//home/taxi-dwh/ods/mdb/order/2018-03-01'),
                      ignore_missing=False)
                  remote_input_table4_output = RemoteInputTable(
                      path=Path('//home/taxi-dwh/dds/snp_acc_user_phone'),
                      ignore_missing=False)
                  project_output = remote_input_table4_output | Project(date=first_utc_order_dttm, order_id=first_order_id, is_user_first_ride=<Extractor None = True>)
                  remote_input_table5_output = RemoteInputTable(
                      path=Path('//home/taxi-dwh/raw/mdb/subventions/2018-03-01'),
                      ignore_missing=False)
                  remote_input_table6_output = RemoteInputTable(
                      path=Path('//home/taxi-dwh/stg/mdb/drivers/drivers'),
                      ignore_missing=False)
                  remote_input_table7_output = RemoteInputTable(
                      path=Path('//home/taxi-dwh/stg/mdb/tariffs/tariffs'),
                      ignore_missing=False)
                  filter_output = remote_input_table3_output | Filter(log=generic-yson-log, fields=[], filters=[...])
                  project2_output = filter_output | Project(order_id, utc_order_created_dttm, driver_license, plan_cost, user_id, user_phone_id, park_id, city, coupon_nominal, tariff_id, travel_time=<Extractor None = extract_travel_time(utc_start_transporting_dttm, utc_complete_dttm)>, cost=order_cost_w_discount)
                  project3_output = remote_input_table_output | Project(id, device_id)
                  project4_output = remote_input_table6_output | Project(name, updated, driver_license)
                  group_fields_output = project4_output | GroupFields(fields=('driver_license',))
                  reduce_output = group_fields_output | Reduce(
                      operator=Operator(
                          function=GeneratorAdapter(
                              generator=<function __main__.reduce_last_updated_name>),
                          name='reduce_last_updated_name',
                          outputs=('output',),
                          input_format=Records(),
                          output_format=Records(),
                          files=frozenset(),
                          consumes_full_input=True,
                          hints=_Hints()),
                      files=(),
                      intensity='default',
                      memory_limit=None)
                  filter2_output = project_output | Filter(log=generic-yson-log, fields=[], filters=[...])
                  join_output = (project2_output, filter2_output) | Join(
                      group_by_left=('order_id',),
                      group_by_right=('order_id',),
                      type='left',
                      hints={'assume_small_left': False,
                       'assume_small_right': True,
                       'assume_unique_left': True,
                       'assume_unique_right': True},
                      memory_limit=2048)
                  filter3_output = remote_input_table5_output | Filter(log=generic-yson-log, fields=[], filters=[...])
                  project5_output = filter3_output | Project(order_id=<Extractor None = <lambda>(doc)>, subvention_version=<Extractor None = <lambda>(doc)>, subvention_value=<Extractor None = <lambda>(doc)>)
                  group_fields2_output = project5_output | GroupFields(fields=('order_id',))
                  top_output = group_fields2_output | Top(TopAggregator(subvention_version, <record>))
                  join2_output = (join_output, top_output) | Join(
                      group_by_left=('order_id',),
                      group_by_right=('order_id',),
                      type='left',
                      hints={'assume_small_left': False,
                       'assume_small_right': False,
                       'assume_unique_left': True,
                       'assume_unique_right': False},
                      memory_limit=None)
                  map_output = remote_input_table7_output | Map(
                      operator=Operator(
                          function=GeneratorAdapter(
                              generator=<function __main__.map_create_minimals_dict>),
                          name='map_create_minimals_dict',
                          outputs=('output',),
                          input_format=Records(),
                          output_format=Records(),
                          files=frozenset(),
                          consumes_full_input=True,
                          hints=_Hints()),
                      files=(),
                      intensity='data',
                      memory_limit=None,
                      ordered=False,
                      enable_row_index=False)
                  group_fields3_output = map_output | GroupFields(fields=('category_id',))
                  top2_output = group_fields3_output | Top(TopAggregator(minimal, <record>))
                  join3_output = (join2_output, top2_output) | Join(
                      group_by_left=('tariff_id',),
                      group_by_right=('category_id',),
                      type='inner',
                      hints={'assume_small_left': False,
                       'assume_small_right': True,
                       'assume_unique_left': False,
                       'assume_unique_right': True},
                      memory_limit=2048)
                  join4_output = (join3_output, project3_output) | Join(
                      group_by_left=('user_id',),
                      group_by_right=('id',),
                      type='left',
                      hints={'assume_small_left': False,
                       'assume_small_right': False,
                       'assume_unique_left': False,
                       'assume_unique_right': False},
                      memory_limit=None)
                  group_fields4_output = join4_output | GroupFields(fields=('driver_license', 'city'))
                  reduce2_output = group_fields4_output | Reduce(
                      operator=Operator(
                          function=GeneratorAdapter(
                              generator=<function __main__.reduce_drivers>),
                          name='reduce_drivers',
                          outputs=('output',),
                          input_format=Records(),
                          output_format=Records(),
                          files=frozenset(),
                          consumes_full_input=True,
                          hints=_Hints()),
                      files=(),
                      intensity='cpu',
                      memory_limit=None)
                  join5_output = (reduce2_output, reduce_output) | Join(
                      group_by_left=('driver_license',),
                      group_by_right=('driver_license',),
                      type='left',
                      hints={'assume_small_left': False,
                       'assume_small_right': False,
                       'assume_unique_left': False,
                       'assume_unique_right': False},
                      memory_limit=None)
                  sort_output = join5_output | Sort(fields=('utc_calc_dttm', 'driver_license', 'window_days'))
                  concat_output = (sort_output, remote_input_table2_output) | Concat()
                  concat_output | RemoteOutputTable(
                      path=Path('//home/taxi-fraud/import/production/driver/2018-03-01'),
                      allow_override=True)

  self._job.run = <bound method Job.run of Job(driver=YTDriver(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch', clean_cache=False), name='driver fraud', uuid_by_name=False, environment=Environment(templates={'tmp': '$tmp_root/by-uuid/$job_uuid', 'job_root': '$home/$job_name', 'title': 'Nile job $job_name (step $current_step / $total_steps)', 'tmp_root': 'tmp/nile/$user_name', 'job_name': 'driver fraud', 'checkpoints_root': '$tmp/checkpoints', 'tmp_pretty': '$tmp_root/by-name/$job_name', 'user_name': u'robot-taxi-stat', 'job_uuid': 'baf06384-3200-11e8-bf37-21c5f3a4adf0', 'tmp_files': '$tmp/files'}, files=frozenset([]), run_command_prefix=None, default_memory_limit=512, default_add_to_archive=True, default_mode='records', publish_settings={'default_allow_change_job': False, 'default_statface_job': None}, base_files=frozenset([]), operations_environment={}, base_package_paths=('/usr/lib/python2.7/dist-packages/nile/wheelhouse', '/usr/lib/python2.7/dist-packages/cyson/whee
 lhouse', '/usr/lib/python2.7/dist-packages/tdigest_bindings/wheelhouse', '/usr/lib/python2.7/dist-packages/qb2/wheelhouse', '/usr/lib/python2.7/dist-packages/signurl_bindings/wheelhouse', '/usr/lib/python2.7/dist-packages/metrikatraficsource_bindings/wheelhouse'), reference_date='2018-03-26', packages=frozenset([Package(requirement='pytz', path=None, add_to_archive=None), Package(requirement='transliterate', path=None, add_to_archive=None), Package(requirement='enum34', path=None, add_to_archive=None), DevelopPackage(path='/home/robot-taxi-stat/etl', add_to_archive=None)]), base_packages=frozenset(['qb2', 'signurl_bindings', 'nile', 'cyson', 'metrikatraficsource_bindings', 'python_tdigest_bindings', 'decorator']), yt_spec_defaults={}, auto_increase_memory_limit=True, package_paths=(), parallel_operations_limit=10, compression_level=Shape({'final_tables': 'normal', 'tmp_tables': 'lightest'}), merge_strategy=Shape({'final_tables': 'always', 'tmp_tables': 'default'}), python_binary='py
 thon'), default_cluster_environment=Environment(templates={'checkpoints_root': '$tmp/checkpoints', 'tmp': '$tmp_root/by-uuid/$job_uuid', 'title': 'Nile job $job_name (step $current_step / $total_steps)', 'tmp_pretty': '$tmp_root/by-name/$job_name', 'tmp_root': 'tmp/nile/$user_name', 'user_name': u'robot-taxi-stat', 'tmp_files': '$tmp/files'}, files=frozenset([]), run_command_prefix=None, default_memory_limit=512, default_add_to_archive=True, default_mode='records', publish_settings={'default_allow_change_job': False, 'default_statface_job': None}, base_files=frozenset([]), operations_environment={}, base_package_paths=('/usr/lib/python2.7/dist-packages/nile/wheelhouse', '/usr/lib/python2.7/dist-packages/cyson/wheelhouse', '/usr/lib/python2.7/dist-packages/tdigest_bindings/wheelhouse', '/usr/lib/python2.7/dist-packages/qb2/wheelhouse', '/usr/lib/python2.7/dist-packages/signurl_bindings/wheelhouse', '/usr/lib/python2.7/dist-packages/metrikatraficsource_bindings/wheelhouse'), reference
 _date='2018-03-26', packages=frozenset([]), base_packages=frozenset(['qb2', 'signurl_bindings', 'nile', 'cyson', 'metrikatraficsource_bindings', 'python_tdigest_bindings', 'decorator']), yt_spec_defaults={}, auto_increase_memory_limit=True, package_paths=(), parallel_operations_limit=1, compression_level=Shape({'final_tables': 'normal', 'tmp_tables': 'lightest'}), merge_strategy=Shape({'final_tables': 'always', 'tmp_tables': 'default'}), python_binary='python'))>

------------------------------
/usr/lib/python2.7/dist-packages/nile/api/v1/job.py:
 in run(self = Job(driver=YTDriver(proxy='hahn.yt.yandex.net', ...mp_tables': 'default'}), python_binary='python')), checkpoints = (), store_checkpoints = True, hide_command = False, skip_publish = False)

     152 with CustomSysArgv(sys_argv):
     153 try:
  -> 154 execution_plan.run()
     155 except Exception:
     156 exc_info = sys.exc_info()

Vars:
  execution_plan = <nile.drivers.yt.execution_plan.YTExecutionPlan at 0x7f6e9a766b50>
  execution_plan.run = <bound method YTExecutionPlan.run of <nile.drivers.yt.execution_plan.YTExecutionPlan object at 0x7f6e9a766b50>>

------------------------------
/usr/lib/python2.7/dist-packages/nile/drivers/yt/execution_plan.py:
 in run(self = <nile.drivers.yt.execution_plan.YTExecutionPlan object>)

     106 try:
     107 while self.queues_manager.has_more_work:
  -> 108 self._schedule_operations()
     109 self._observe_until_someone_exits()
     110 except KeyboardInterrupt:

Vars:
  self = <nile.drivers.yt.execution_plan.YTExecutionPlan at 0x7f6e9a766b50>
  self._schedule_operations = <bound method YTExecutionPlan._schedule_operations of <nile.drivers.yt.execution_plan.YTExecutionPlan object at 0x7f6e9a766b50>>

------------------------------
/usr/lib/python2.7/dist-packages/nile/drivers/yt/execution_plan.py:
 in _schedule_operations(self = <nile.drivers.yt.execution_plan.YTExecutionPlan object>)

     143 )
     144
  -> 145 self._do_runtime_prepare(node)
     146
     147 progress = node.object.get_progress(

Vars:
  self = <nile.drivers.yt.execution_plan.YTExecutionPlan at 0x7f6e9a766b50>
  self._do_runtime_prepare = <bound method YTExecutionPlan._do_runtime_prepare of <nile.drivers.yt.execution_plan.YTExecutionPlan object at 0x7f6e9a766b50>>
  node = NodeRef(140113033734288, type=YTMerge)

------------------------------
/usr/lib/python2.7/dist-packages/nile/drivers/yt/execution_plan.py:
 in _do_runtime_prepare(self = <nile.drivers.yt.execution_plan.YTExecutionPlan object>, node = NodeRef(140113033734288, type=YTMerge))

     159
     160 def _do_runtime_prepare(self, node):
  -> 161 self._set_compression_level(node.object)
     162
     163 def _observe_until_someone_exits(self):

Vars:
  self = <nile.drivers.yt.execution_plan.YTExecutionPlan at 0x7f6e9a766b50>
  self._set_compression_level = <bound method YTExecutionPlan._set_compression_level of <nile.drivers.yt.execution_plan.YTExecutionPlan object at 0x7f6e9a766b50>>
  node = NodeRef(140113033734288, type=YTMerge)
  node.object = YTMerge(
                    driver=YTDriver(
                        proxy='hahn.yt.yandex.net',
                        token='...',
                        pool='taxi-dwh-batch',
                        clean_cache=False),
                    environment=Environment(
                        templates={'checkpoints_root': '$tmp/checkpoints',
                         'job_name': 'driver fraud',
                         'job_root': '$home/$job_name',
                         'job_uuid': 'baf06384-3200-11e8-bf37-21c5f3a4adf0',
                         'title': 'Nile job $job_name (step $current_step / $total_steps)',
                         'tmp': '$tmp_root/by-uuid/$job_uuid',
                         'tmp_files': '$tmp/files',
                         'tmp_pretty': '$tmp_root/by-name/$job_name',
                         'tmp_root': 'tmp/nile/$user_name',
                         'user_name': u'robot-taxi-stat'},
                        files=frozenset(),
                        run_command_prefix=None,
                        default_memory_limit=512,
                        default_add_to_archive=True,
                        default_mode='records',
                        publish_settings={'default_allow_change_job': False,
                         'default_statface_job': None},
                        base_files=frozenset(),
                        operations_environment={},
                        base_package_paths=('/usr/lib/python2.7/dist-packages/nile/wheelhouse',
                         '/usr/lib/python2.7/dist-packages/cyson/wheelhouse',
                         '/usr/lib/python2.7/dist-packages/tdigest_bindings/wheelhouse',
                         '/usr/lib/python2.7/dist-packages/qb2/wheelhouse',
                         '/usr/lib/python2.7/dist-packages/signurl_bindings/wheelhouse',
                         '/usr/lib/python2.7/dist-packages/metrikatraficsource_bindings/wheelhouse'),
                        reference_date='2018-03-26',
                        packages=frozenset({DevelopPackage(
                                       path='/home/robot-taxi-stat/etl',
                                       add_to_archive=None),
                                   Package(
                                       requirement='enum34',
                                       path=None,
                                       add_to_archive=None),
                                   Package(requirement='pytz', path=None, add_to_archive=None),
                                   Package(
                                       requirement='transliterate',
                                       path=None,
                                       add_to_archive=None)}),
                        base_packages=frozenset({'cyson',
                                   'decorator',
                                   'metrikatraficsource_bindings',
                                   'nile',
                                   'python_tdigest_bindings',
                                   'qb2',
                                   'signurl_bindings'}),
                        yt_spec_defaults={},
                        auto_increase_memory_limit=True,
                        package_paths=(),
                        parallel_operations_limit=10,
                        compression_level=Shape(
                            {'final_tables': 'normal', 'tmp_tables': 'lightest'}),
                        merge_strategy=Shape(
                            {'final_tables': 'always', 'tmp_tables': 'default'}),
                        python_binary='python'),
                    operation=Merge(),
                    source_tables=[RemoteInputTable(
                         path=Path('//home/taxi-fraud/import/production/driver/2018-03-01'),
                         ignore_missing=False),
                     PreparedTempOutputTable(
                         path=Path('tmp/nile/robot-taxi-stat/by-uuid/baf06384-3200-11e8-bf37-21c5f3a4adf0/tmp-7'),
                         row_count_limit=None,
                         compression_level='lightest')],
                    destination_tables=[PreparedRemoteOutputTable(
                         path=Path('//home/taxi-fraud/import/production/driver/2018-03-01'),
                         allow_override=True,
                         append=False,
                         row_count_limit=None,
                         compression_level='normal')])

------------------------------
/usr/lib/python2.7/dist-packages/nile/drivers/yt/execution_plan.py:
 in _set_compression_level(self = <nile.drivers.yt.execution_plan.YTExecutionPlan object>, command = YTMerge(driver=YTDriver(proxy='hahn.yt.yandex.ne...w_count_limit=None, compression_level='normal')]))

     281 path,
     282 attribute=name,
  -> 283 value=value
     284 )
     285

Vars:
  value = 'none'

------------------------------
/usr/lib/python2.7/dist-packages/nile/drivers/yt/driver.py:
 in set_attribute(self = YTDriver(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch', clean_cache=False), path = YTPath(path='home/taxi-fraud/import/production/d...tes={'_allow_override': True, 'append': 'false'}), attribute = 'erasure_codec', value = 'none', **options = {})

     204 warn_unused_options(self, self.set_attribute, options)
     205 path = self._coerce_path(path)
  -> 206 self.client.set_attribute(str(path), attribute, value)
     207
     208 def remove_attribute(

Vars:
  self = YTDriver(
             proxy='hahn.yt.yandex.net',
             token='...',
             pool='taxi-dwh-batch',
             clean_cache=False)
  self.client = YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch')
  self.client.set_attribute = <bound method YTClient.set_attribute of YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch')>
  builtin str = str
  path = YTPath(
             path='home/taxi-fraud/import/production/driver/2018-03-01',
             client=YTClient(
                 proxy='hahn.yt.yandex.net',
                 token='...',
                 pool='taxi-dwh-batch'),
             simplify=True,
             append=False,
             attributes={'_allow_override': True, 'append': 'false'})
  attribute = 'erasure_codec'
  value = 'none'

------------------------------
/home/robot-taxi-stat/<decorator-gen-77>:
 in set_attribute(self = YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch'), path = '//home/taxi-fraud/import/production/driver/2018-03-01', attribute = 'erasure_codec', value = 'none')


Vars:

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/client_helpers.py:
 in decorator(self = YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch'), *args = ('//home/taxi-fraud/import/production/driver/2018-03-01', 'erasure_codec', 'none'), **kwargs = {})

      46 original_func = func
      47 def decorator(self, *args, **kwargs):
   -> 48 return original_func(*args, client=self, **kwargs)
      49
      50 is_class = False

Vars:
  original_func = <function yt.wrapper.cypress_commands.set_attribute>
  args = ('//home/taxi-fraud/import/production/driver/2018-03-01',
          'erasure_codec',
          'none')
  client is undefined
  self = YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch')
  kwargs = {}

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/cypress_commands.py:
 in set_attribute(path = '//home/taxi-fraud/import/production/driver/2018-03-01', attribute = 'erasure_codec', value = 'none', client = YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch'))

     365 :param value: value.
     366 """
  -> 367 return set("%s/@%s" % (path, attribute), value, client=client)
     368
     369 def list_attributes(path, attribute_path="", client=None):

Vars:
  global set = <function yt.wrapper.cypress_commands.set>
  path = '//home/taxi-fraud/import/production/driver/2018-03-01'
  attribute = 'erasure_codec'
  value = 'none'
  client = YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch')

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/cypress_commands.py:
 in set(path = '//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec', value = '"none"', format = <"boolean_as_string"=%false;"ignore_inner_attrib...eate_attributes"=%false;"format"="binary";>"yson", client = YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch'))

      85 },
      86 data=value,
   -> 87 client=client)
      88
      89 def copy(source_path, destination_path,

Vars:
  client = YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch')

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/transaction_commands.py:
 in _make_transactional_request(command_name = 'set', params = {'input_format': {'attributes': {'boolean_as_string': False, 'ign...es': False, 'format': 'binary'}, 'value': 'yson'}, 'path': //home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec}, **kwargs = {'client': YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch'), 'data': '"none"'})

       8
       9 def _make_transactional_request(command_name, params, **kwargs):
   -> 10 return make_request(command_name, params, **kwargs)
      11
      12 def _make_formatted_transactional_request(command_name, params, format, **kwargs):

Vars:
  global make_request = <function yt.wrapper.driver.make_request>
  command_name = 'set'
  params = {'input_format': {'attributes': {'boolean_as_string': False, 'ignore_inner_attributes': False, 'always_create_attributes': False, 'format': 'binary'}, 'value': 'yson'},
            'path': //home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec}
  kwargs = {'client': YTClient(
                proxy='hahn.yt.yandex.net',
                token='...',
                pool='taxi-dwh-batch'),
            'data': '"none"'}

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/driver.py:
 in make_request(command_name = 'set', params = {'input_format': {'attributes': {'boolean_as_string': False, 'ign...es': False, 'format': 'binary'}, 'value': 'yson'}, 'mutation_id': '15278e2e-dc71289f-7bdea52b-9eeb833', 'path': '//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec', 'retry': 'false', 'transaction_id': 'a506-f795-3fe0001-d99427bf'}, data = '"none"', is_data_compressed = False, return_content = True, response_format = None, use_heavy_proxy = False, timeout = None, allow_retries = None, decode_content = True, batch_yson_dumps = True, client = YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch'))

     113 allow_retries=allow_retries,
     114 decode_content=decode_content,
  -> 115 client=client)
     116 else:
     117 raise YtError("Incorrect backend type: " + backend)

Vars:
  client = YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch')

------------------------------
/home/robot-taxi-stat/<decorator-gen-2>:
 in make_request(command_name = 'set', params = {'input_format': {'attributes': {'boolean_as_string': False, 'ign...es': False, 'format': 'binary'}, 'value': 'yson'}, 'mutation_id': '15278e2e-dc71289f-7bdea52b-9eeb833', 'path': '//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec', 'retry': 'false', 'transaction_id': 'a506-f795-3fe0001-d99427bf'}, data = '"none"', is_data_compressed = False, return_content = True, response_format = None, use_heavy_proxy = False, timeout = None, client = YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch'), allow_retries = None, decode_content = True)


Vars:

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/common.py:
 in forbidden_inside_job(func = <function make_request>, *args = ('set', {'input_format': {'attributes': {'boolean_as_string': False, 'ign...es': False, 'format': 'binary'}, 'value': 'yson'}, 'mutation_id': '15278e2e-dc71289f-7bdea52b-9eeb833', 'path': '//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec', 'retry': 'false', 'transaction_id': 'a506-f795-3fe0001-d99427bf'}, '"none"', False, True, None, False, None, YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch'), None, True), **kwargs = {})

     243 'you can override this behaviour by turning on '
     244 '"allow_http_requests_to_yt_from_job" option in config.')
  -> 245 return func(*args, **kwargs)
     246
     247 class DoNotReplaceAction(argparse.Action):

Vars:
  func = <function yt.wrapper.http_driver.make_request>
  args = ('set',
          {'input_format': {'attributes': {'boolean_as_string': False, 'ignore_inner_attributes': False, 'always_create_attributes': False, 'format': 'binary'}, 'value': 'yson'},
           'mutation_id': '15278e2e-dc71289f-7bdea52b-9eeb833',
           'path': '//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec',
           'retry': 'false',
           'transaction_id': 'a506-f795-3fe0001-d99427bf'},
          '"none"',
          False,
          True,
          None,
          False,
          None,
          YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch'),
          None,
          True)
  kwargs = {}

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/http_driver.py:
 in make_request(command_name = 'set', params = {'input_format': {'attributes': {'boolean_as_string': False, 'ign...es': False, 'format': 'binary'}, 'value': 'yson'}, 'mutation_id': '15278e2e-dc71289f-7bdea52b-9eeb833', 'path': '//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec', 'retry': 'false', 'transaction_id': 'a506-f795-3fe0001-d99427bf'}, data = '"none"', is_data_compressed = False, return_content = True, response_format = None, use_heavy_proxy = False, timeout = (5000, 20000), client = YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch'), allow_retries = True, decode_content = True)

     270 is_ping=(command_name == "ping_tx"),
     271 proxy_provider=proxy_provider,
  -> 272 client=client)
     273
     274 def process_error(response):

Vars:
  client = YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch')

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/http_helpers.py:
 in make_request_with_retries(method = 'PUT', url = 'http://hahn.yt.yandex.net/api/v3/set', **kwargs = {'auth': <yt.wrapper.http_driver.TokenAuth object>, 'client': YTClient(proxy='hahn.yt.yandex.net', token='...', pool='taxi-dwh-batch'), 'data': '"none"', 'headers': {'Accept-Encoding': 'gzip, identity', 'User-Agent': 'Python wrapper 0.8.27-0', 'X-Started-By': '{"pid"=550929;"user"="robot-taxi-stat";}', 'X-YT-Correlation-Id': '7bf0fde3-c22f4706-b72165c7-3c748d19', 'X-YT-Header-Format': '<format=text>yson', 'X-YT-Parameters': '{"path"="//home/taxi-fraud/import/production/dri...te_attributes"=%false;"format"="binary";>"yson";}'}, 'is_ping': False, 'log_body': False, 'make_retries': True, 'params': {'input_format': {'attributes': {'boolean_as_string': False, 'ign...es': False, 'format': 'binary'}, 'value': 'yson'}, 'mutation_id': '15278e2e-dc71289f-7bdea52b-9eeb833', 'path': '//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec', 'retry': 'false', 'transaction_id': 'a506
 -f795-3fe0001-d99427bf'}, 'proxy_provider': None, 'response_format': None, ...})

     288 This function is for backward compatibility and convenience of use.
     289 """
  -> 290 return RequestRetrier(method=method, url=url, **kwargs).run()
     291
     292

Vars:
  global RequestRetrier = yt.wrapper.http_helpers.RequestRetrier
  method = 'PUT'
  url = 'http://hahn.yt.yandex.net/api/v3/set'
  kwargs = {'auth': <yt.wrapper.http_driver.TokenAuth at 0x7f6e9b97c9d0>,
            'client': YTClient(
                proxy='hahn.yt.yandex.net',
                token='...',
                pool='taxi-dwh-batch'),
            'data': '"none"',
            'headers': {'Accept-Encoding': 'gzip, identity',
             'User-Agent': 'Python wrapper 0.8.27-0',
             'X-Started-By': '{"pid"=550929;"user"="robot-taxi-stat";}',
             'X-YT-Correlation-Id': '7bf0fde3-c22f4706-b72165c7-3c748d19',
             'X-YT-Header-Format': '<format=text>yson',
             'X-YT-Parameters': '{"path"="//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec";"retry"="false";"mutation_id"="15278e2e-dc71289f-7bdea52b-9eeb833";"transaction_id"="a506-f795-3fe0001-d99427bf";"input_format"=<"boolean_as_string"=%false;"ignore_inner_attributes"=%false;"always_create_attributes"=%false;"format"="binary";>"yson";}'},
            'is_ping': False,
            'log_body': False,
            'make_retries': True,
            'params': {'input_format': {'attributes': {'boolean_as_string': False, 'ignore_inner_attributes': False, 'always_create_attributes': False, 'format': 'binary'}, 'value': 'yson'},
             'mutation_id': '15278e2e-dc71289f-7bdea52b-9eeb833',
             'path': '//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec',
             'retry': 'false',
             'transaction_id': 'a506-f795-3fe0001-d99427bf'},
            'proxy_provider': None,
            'response_format': None,
            'retry_action': <function yt.wrapper.http_driver.<lambda>>,
            'stream': False,
            'timeout': (5000, 20000)}
  ).run is undefined

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/retries.py:
 in run(self = <yt.wrapper.http_helpers.RequestRetrier object>)

      57 if self.chaos_monkey_enabled and random.randint(1, 5) == 1:
      58 raise YtRetriableError()
   -> 59 return self.action()
      60 except self.exceptions as exception:
      61 if attempt == retry_count:

Vars:
  self = <yt.wrapper.http_helpers.RequestRetrier at 0x7f6e9b97c6d0>
  self.action = <bound method RequestRetrier.action of <yt.wrapper.http_helpers.RequestRetrier object at 0x7f6e9b97c6d0>>

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/http_helpers.py:
 in action(self = <yt.wrapper.http_helpers.RequestRetrier object>)

     258 logger.debug("Response headers %r", hide_token(dict(response.headers)))
     259
  -> 260 _raise_for_status(response, request_info)
     261 return response
     262

Vars:
  global _raise_for_status = <function yt.wrapper.http_helpers._raise_for_status>
  response = <Response [400]>
  request_info = {'headers': {'Accept-Encoding': 'gzip, identity',
                   'User-Agent': 'Python wrapper 0.8.27-0',
                   'X-Started-By': '{"pid"=550929;"user"="robot-taxi-stat";}',
                   'X-YT-Correlation-Id': '7bf0fde3-c22f4706-b72165c7-3c748d19',
                   'X-YT-Header-Format': '<format=text>yson',
                   'X-YT-Parameters': '{"path"="//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec";"retry"="false";"mutation_id"="15278e2e-dc71289f-7bdea52b-9eeb833";"transaction_id"="a506-f795-3fe0001-d99427bf";"input_format"=<"boolean_as_string"=%false;"ignore_inner_attributes"=%false;"always_create_attributes"=%false;"format"="binary";>"yson";}'},
                  'params': {'input_format': {'attributes': {'boolean_as_string': False, 'ignore_inner_attributes': False, 'always_create_attributes': False, 'format': 'binary'}, 'value': 'yson'},
                   'mutation_id': '15278e2e-dc71289f-7bdea52b-9eeb833',
                   'path': '//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec',
                   'retry': 'false',
                   'transaction_id': 'a506-f795-3fe0001-d99427bf'},
                  'url': 'http://hahn.yt.yandex.net/api/v3/set'}

------------------------------
/usr/lib/python2.7/dist-packages/yt/wrapper/http_helpers.py:
 in _raise_for_status(response = <Response [400]>, request_info = {'headers': {'Accept-Encoding': 'gzip, identity', 'User-Agent': 'Python wrapper 0.8.27-0', 'X-Started-By': '{"pid"=550929;"user"="robot-taxi-stat";}', 'X-YT-Correlation-Id': '7bf0fde3-c22f4706-b72165c7-3c748d19', 'X-YT-Header-Format': '<format=text>yson', 'X-YT-Parameters': '{"path"="//home/taxi-fraud/import/production/dri...te_attributes"=%false;"format"="binary";>"yson";}'}, 'params': {'input_format': {'attributes': {'boolean_as_string': False, 'ign...es': False, 'format': 'binary'}, 'value': 'yson'}, 'mutation_id': '15278e2e-dc71289f-7bdea52b-9eeb833', 'path': '//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec', 'retry': 'false', 'transaction_id': 'a506-f795-3fe0001-d99427bf'}, 'url': 'http://hahn.yt.yandex.net/api/v3/set'})

     159
     160 if not response.is_ok():
  -> 161 raise YtHttpResponseError(error=response.error(), **request_info)
     162
     163

Vars:
  global YtHttpResponseError = yt.wrapper.errors.YtHttpResponseError
  error is undefined
  response = <Response [400]>
  response.error = <bound method ?.error of <Response [400]>>
  request_info = {'headers': {'Accept-Encoding': 'gzip, identity',
                   'User-Agent': 'Python wrapper 0.8.27-0',
                   'X-Started-By': '{"pid"=550929;"user"="robot-taxi-stat";}',
                   'X-YT-Correlation-Id': '7bf0fde3-c22f4706-b72165c7-3c748d19',
                   'X-YT-Header-Format': '<format=text>yson',
                   'X-YT-Parameters': '{"path"="//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec";"retry"="false";"mutation_id"="15278e2e-dc71289f-7bdea52b-9eeb833";"transaction_id"="a506-f795-3fe0001-d99427bf";"input_format"=<"boolean_as_string"=%false;"ignore_inner_attributes"=%false;"always_create_attributes"=%false;"format"="binary";>"yson";}'},
                  'params': {'input_format': {'attributes': {'boolean_as_string': False, 'ignore_inner_attributes': False, 'always_create_attributes': False, 'format': 'binary'}, 'value': 'yson'},
                   'mutation_id': '15278e2e-dc71289f-7bdea52b-9eeb833',
                   'path': '//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec',
                   'retry': 'false',
                   'transaction_id': 'a506-f795-3fe0001-d99427bf'},
                  'url': 'http://hahn.yt.yandex.net/api/v3/set'}


---------====== Detailed exception attributes ======-------------

_cached_fqdn = 'taxi-etl01h.taxi.yandex.net'
_get_fqdn = <function _get_fqdn>
args = ()
attributes = {'datetime': '2018-03-27T21:35:40.487361Z', 'headers': {'X-YT-Correlation-Id': '7bf0fde3-c22f4706-b7216...t>yson', 'User-Agent': 'Python wrapper 0.8.27-0'}, 'host': 'taxi-etl01h.taxi.yandex.net', 'params': {'path': '//home/taxi-fraud/import/production/dr..., 'transaction_id': 'a506-f795-3fe0001-d99427bf'}, 'transparent': True, 'url': 'http://hahn.yt.yandex.net/api/v3/set'}
code = 1
contains_code = <bound method YtHttpResponseError.contains_code of YtHttpResponseError()>
contains_text = <bound method YtHttpResponseError.contains_text of YtHttpResponseError()>
error = {u'attributes': {u'datetime': u'2018-03-27T21:35:40.478361Z', u'fid': 18435270356505690151L, u'host': u'm01-sas.hahn.yt.yandex.net', u'pid': 709729, u'tid': 10563388107636109231L}, u'code': 500, u'inner_errors': [], u'message': u'//home/taxi-fraud/import/production/driver has...r using "recursive" option to force its creation'}
headers = {'Accept-Encoding': 'gzip, identity', 'User-Agent': 'Python wrapper 0.8.27-0', 'X-Started-By': '{"pid"=550929;"user"="robot-taxi-stat";}', 'X-YT-Correlation-Id': '7bf0fde3-c22f4706-b72165c7-3c748d19', 'X-YT-Header-Format': '<format=text>yson', 'X-YT-Parameters': '{"path"="//home/taxi-fraud/import/production/dri...te_attributes"=%false;"format"="binary";>"yson";}'}
inner_errors = [{u'attributes': {u'datetime': u'2018-03-27T21:35:40.478361Z', u'fid': 18435270356505690151L, u'host': u'm01-sas.hahn.yt.yandex.net', u'pid': 709729, u'tid': 10563388107636109231L}, u'code': 500, u'inner_errors': [], u'message': u'//home/taxi-fraud/import/production/driver has...r using "recursive" option to force its creation'}]
is_access_denied = <bound method YtHttpResponseError.is_access_denied of YtHttpResponseError()>
is_chunk_unavailable = <bound method YtHttpResponseError.is_chunk_unavailable of YtHttpResponseError()>
is_concurrent_operations_limit_reached = <bound method YtHttpResponseError.is_concurrent_operations_limit_reached of YtHttpResponseError()>
is_concurrent_transaction_lock_conflict = <bound method YtHttpResponseError.is_concurrent_transaction_lock_conflict of YtHttpResponseError()>
is_master_communication_error = <bound method YtHttpResponseError.is_master_communication_error of YtHttpResponseError()>
is_no_such_transaction = <bound method YtHttpResponseError.is_no_such_transaction of YtHttpResponseError()>
is_request_queue_size_limit_exceeded = <bound method YtHttpResponseError.is_request_queue_size_limit_exceeded of YtHttpResponseError()>
is_request_rate_limit_exceeded = <bound method YtHttpResponseError.is_request_rate_limit_exceeded of YtHttpResponseError()>
is_request_timed_out = <bound method YtHttpResponseError.is_request_timed_out of YtHttpResponseError()>
is_resolve_error = <bound method YtHttpResponseError.is_resolve_error of YtHttpResponseError()>
is_shell_exited = <bound method YtHttpResponseError.is_shell_exited of YtHttpResponseError()>
message = 'Received HTTP response with error'
params = {'input_format': {'attributes': {'boolean_as_string': False, 'ign...es': False, 'format': 'binary'}, 'value': 'yson'}, 'mutation_id': '15278e2e-dc71289f-7bdea52b-9eeb833', 'path': '//home/taxi-fraud/import/production/driver/2018-03-01/@erasure_codec', 'retry': 'false', 'transaction_id': 'a506-f795-3fe0001-d99427bf'}
simplify = <bound method YtHttpResponseError.simplify of YtHttpResponseError()>
url = 'http://hahn.yt.yandex.net/api/v3/set'
