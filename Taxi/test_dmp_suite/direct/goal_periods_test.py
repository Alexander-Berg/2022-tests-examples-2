from dmp_suite.direct.utils import get_goal_periods


def test_goal_periods():
    assert get_goal_periods('2020-09-01', '2020-10-01') == [
        ('2020-09-01', '2020-09-30', ['38770793']),
        ('2020-10-01', '2020-10-01', ['137400820', '38770793']),
    ]

    assert get_goal_periods('2020-10-01', '2020-10-01') == [
        ('2020-10-01', '2020-10-01', ['137400820', '38770793']),
    ]

    assert get_goal_periods('2020-10-11', '2020-10-11') == [
        ('2020-10-11', '2020-10-11', ['137400820', '38770793']),
    ]

    assert get_goal_periods('2020-10-12', '2020-10-12') == [
        ('2020-10-12', '2020-10-12', ['137836663']),
    ]

    assert get_goal_periods('2020-09-30', '2020-09-30') == [
        ('2020-09-30', '2020-09-30', ['38770793']),
    ]

    assert get_goal_periods('2020-01-01', '2020-12-31') == [
        ('2020-01-01', '2020-09-30', ['38770793']),
        ('2020-10-01', '2020-10-11', ['137400820', '38770793']),
        ('2020-10-12', '2020-12-31', ['137836663']),
    ]
