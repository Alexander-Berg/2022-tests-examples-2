[
  {
    "data": {
      "ancestor_doc_kind": "shift_ended"
    },
    "event_at": "2018-05-12T05:00:00.000000+00:00",
    "external_event_ref": "2018-05-11/payment_subvention_handled",
    "external_obj_id": "taxi/shift_ended/subvention_agreement/1/personal/group_id/p_goal_rule_group_id",
    "journal_entries": [
      {
        "account_id": 0,
        "amount": "1000",
        "event_at": "2018-05-12T05:00:00.000000+00:00"
      },
      {
        "account_id": 1,
        "amount": "1000",
        "event_at": "2018-05-12T05:00:00.000000+00:00"
      }
    ],
    "kind": "payment_subvention_journal",
    "service": "billing-subventions",
    "status": "new",
    "tags": [
      "system://parent_doc_id/12345678",
      "journal_ancestor_doc_id/12345678"
    ]
  },
  {
    "data": {
      "ancestor_doc_kind": "shift_ended",
      "antifraud_query": {
        "after": "2018-05-12T08:00:00.000000+03:00",
        "data": {
          "driver": {
            "driver_license_personal_ids": [
              "8hd93jdlakhf84030ejd9390z"
            ],
            "driver_licenses": [
              "some_driver_license"
            ],
            "unique_driver_id": "111111111111111111111111"
          },
          "min_num_orders": 20,
          "rule": {
            "days_span": 1,
            "kind": "goal",
            "last_shift_date": "2018-05-11",
            "zone_name": "moscow"
          },
          "subvention": {
            "amount": "1000.0000",
            "currency": "RUB"
          },
          "tzinfo": "Europe/Moscow"
        },
        "kind": "driver"
      },
      "antifraud_version": 2,
      "eye": {
        "forward": {
          "tags": [
            "taxi/shift_ended/unique_driver_id/111111111111111111111111/2018-05-11/do_x_get_y"
          ]
        }
      },
      "future_external_obj_id": "taxi/shift_ended/subvention_agreement/1/personal/group_id/p_goal_rule_group_id",
      "future_journal_external_obj_id": "taxi/shift_ended/subvention_agreement/1/personal/group_id/p_goal_rule_group_id",
      "future_journal_tags": [
        "journal_ancestor_doc_id/12345678"
      ],
      "future_support_info": {
        "data": {
          "details": {
            "num_orders": []
          },
          "incomplete_fields": [],
          "last_shift_date": "2018-05-11",
          "num_orders": 20,
          "payout": {
            "expenses": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "0",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_commission",
                  "value": {
                    "amount": "0",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "0",
                "currency": "RUB"
              }
            },
            "gross": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "1000.0000",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_bonus",
                  "value": {
                    "amount": "1000.0000",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "1000.0000",
                "currency": "RUB"
              }
            },
            "net": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "1000.0000",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_bonus_commission_diff",
                  "value": {
                    "amount": "1000.0000",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "1000.0000",
                "currency": "RUB"
              }
            }
          },
          "rule": {
            "id": "group_id/p_goal_rule_group_id"
          },
          "unfit_details": {
            "num_orders": []
          },
          "unfit_num_orders": 0
        },
        "kind": "taxi/v1/do_x_get_y"
      },
      "future_support_info_if_fraud": {
        "data": {
          "details": {
            "num_orders": []
          },
          "incomplete_fields": [],
          "last_shift_date": "2018-05-11",
          "num_orders": 20,
          "payout": {
            "expenses": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "0",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_commission",
                  "value": {
                    "amount": "0",
                    "currency": "RUB"
                  }
                },
                {
                  "args": [
                    {
                      "amount": "0",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_fraud",
                  "value": {
                    "amount": "0",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "0",
                "currency": "RUB"
              }
            },
            "gross": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "1000.0000",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_bonus",
                  "value": {
                    "amount": "1000.0000",
                    "currency": "RUB"
                  }
                },
                {
                  "args": [
                    {
                      "amount": "0",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_fraud",
                  "value": {
                    "amount": "0",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "0",
                "currency": "RUB"
              }
            },
            "net": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "1000.0000",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_bonus_commission_diff",
                  "value": {
                    "amount": "1000.0000",
                    "currency": "RUB"
                  }
                },
                {
                  "args": [
                    {
                      "amount": "0",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_fraud",
                  "value": {
                    "amount": "0",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "0",
                "currency": "RUB"
              }
            }
          },
          "rule": {
            "id": "group_id/p_goal_rule_group_id"
          },
          "unfit_details": {
            "num_orders": []
          },
          "unfit_num_orders": 0
        },
        "kind": "taxi/v1/do_x_get_y"
      },
      "initial_check": true,
      "journal_entries": {
        "block": [
          {
            "account_id": 2,
            "amount": "1000",
            "event_at": "2018-05-12T05:00:00.000000+00:00"
          }
        ],
        "execute": [
          {
            "account_id": 3,
            "amount": "1000",
            "event_at": "2018-05-12T05:00:00.000000+00:00"
          }
        ],
        "unhold_verification": [
          {
            "account_id": 1,
            "amount": "-1000",
            "event_at": "2018-05-12T05:00:00.000000+00:00"
          }
        ]
      },
      "notifications": [
        {
          "data": {
            "order_id": "123456789",
            "performer": {
              "db_id": "db_id",
              "park_id": "clid",
              "uuid": "uuid"
            },
            "step_id": {
              "type_conversion": "identity",
              "value": "p_goal_rule_id"
            }
          },
          "kind": "goal"
        }
      ],
      "parent_doc_id": 12345678,
      "subventions_input": {
        "accepted_by_driver_at": "2018-07-02T00:30:00.750000+00:00",
        "activity_points": 0,
        "base_doc_id": 12345678,
        "billing_client_id": "billing_client_id",
        "billing_v2_id": null,
        "closed_without_accept": false,
        "comment": null,
        "completed_by_dispatcher": false,
        "contract_id": "123457",
        "create_via_py2": false,
        "currency_data": {
          "for_contract": {
            "currency": "RUB",
            "rate_from_local": "1"
          },
          "for_offer_contract": {
            "currency": "USD",
            "rate_from_local": null
          }
        },
        "db_id": "db_id",
        "discount_details": {
          "amendments": [],
          "discount": "0 RUB"
        },
        "driver_license": "AXH903VV",
        "dry_mode": true,
        "due": "2018-07-02T00:00:00.750000+00:00",
        "force_hold": false,
        "has_co_branding": true,
        "has_lightbox": false,
        "has_sticker": false,
        "hold_config": {
          "delay": 0
        },
        "is_cargo": false,
        "order_alias_id": "alias_id",
        "order_completed_at": "2018-07-02T00:40:00.750000+00:00",
        "order_id": "123456789",
        "order_payment_type": "cash",
        "park": {
          "automate_marketing_payments": true,
          "city": {
            "country_code": "rus",
            "donate_discounts_multiplier": null,
            "donate_multiplier": null,
            "id": "Соликамск",
            "tzinfo": "Asia/Yekaterinburg"
          },
          "contract_currency": "RUB",
          "contract_currency_rate": "1",
          "offer_confirmed_at": null,
          "offer_contract_currency": "USD",
          "offer_contract_currency_rate": null,
          "pay_donations_without_offer": false
        },
        "park_id": "clid",
        "rule_details": [
          {
            "extra": {},
            "is_once": true,
            "limit_ref": null,
            "payment_type": "add",
            "rule_id": {
              "group_id": "p_goal_rule_group_id",
              "id": "p_goal_rule_id"
            },
            "rule_type": "do_x_get_y",
            "subvention_geoareas": [],
            "value": "1000 RUB"
          }
        ],
        "rule_group": "goal",
        "sub_commission": "0 RUB",
        "subvention_geoareas": [
          "moscow"
        ],
        "tags": [
          "some_tag"
        ],
        "tariff_class": "econom",
        "tlog_due": "2018-05-11T00:00:00.000000+03:00",
        "unique_driver_id": "0123456789ab0123456789ab",
        "unrealized_sub_commission": "0 RUB",
        "uuid": "uuid",
        "value": "1000.0000 RUB",
        "zone_name": "moscow"
      }
    },
    "event_at": "2018-05-12T05:00:00.000000+00:00",
    "external_event_ref": "2018-05-11/antifraud_request",
    "external_obj_id": "antifraud_check/taxi/shift_ended/subvention_agreement/1/personal/group_id/p_goal_rule_group_id",
    "journal_entries": [],
    "kind": "subvention_antifraud_check",
    "service": "billing-subventions",
    "status": "new",
    "tags": [
      "system://parent_doc_id/12345678"
    ]
  },
  {
    "data": {
      "antifraud_action": "delay",
      "check_id": "initial_antifraud_check_doc_id/1",
      "subventions_input": {
        "db_id": "db_id",
        "due": "2018-07-02T00:00:00.750000+00:00",
        "order_alias_id": "alias_id",
        "rule_details": [
          {
            "extra": {},
            "is_once": true,
            "limit_ref": null,
            "payment_type": "add",
            "rule_id": {
              "group_id": "p_goal_rule_group_id",
              "id": "p_goal_rule_id"
            },
            "rule_type": "do_x_get_y",
            "subvention_geoareas": [],
            "value": "1000.0000 RUB"
          }
        ],
        "sub_commission": "0 RUB",
        "uuid": "uuid"
      }
    },
    "event_at": "2018-05-12T05:00:00.000000+00:00",
    "external_event_ref": "1/antifraud_entries",
    "external_obj_id": "taxi/write_subvention_antifraud_entries/goal/alias_id/alias_id",
    "journal_entries": [],
    "kind": "write_subvention_antifraud_entries",
    "service": "billing-subventions",
    "status": "new",
    "tags": []
  },
  {
    "data": {
      "ancestor_doc_kind": "shift_ended"
    },
    "event_at": "2018-05-12T05:00:00.000000+00:00",
    "external_event_ref": "2018-05-11/subvention_handled",
    "external_obj_id": "taxi/shift_ended/subvention_agreement/1/personal/group_id/p_goal_rule_group_id",
    "journal_entries": [],
    "kind": "subvention_journal",
    "service": "billing-subventions",
    "status": "complete",
    "tags": [
      "system://parent_doc_id/12345678",
      "journal_ancestor_doc_id/12345678"
    ]
  }
]
