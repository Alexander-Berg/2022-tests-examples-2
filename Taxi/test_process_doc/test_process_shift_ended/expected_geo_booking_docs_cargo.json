[
  {
    "data": {
      "ancestor_doc_kind": "shift_ended"
    },
    "event_at": "2018-05-12T05:00:00.000000+00:00",
    "external_event_ref": "2018-05-11/payment_subvention_handled",
    "external_obj_id": "taxi/shift_ended/subvention_agreement/1/default/_id/geo_booking_rule_id",
    "journal_entries": [
      {
        "account_id": 0,
        "amount": "8600.0",
        "event_at": "2018-05-12T05:00:00.000000+00:00"
      },
      {
        "account_id": 1,
        "amount": "8600.0",
        "event_at": "2018-05-12T05:00:00.000000+00:00"
      }
    ],
    "kind": "payment_subvention_journal",
    "service": "billing-subventions",
    "status": "new",
    "tags": [
      "system://parent_doc_id/12345678",
      "journal_ancestor_doc_id/12345678"
    ]
  },
  {
    "data": {
      "ancestor_doc_kind": "shift_ended",
      "antifraud_query": {
        "after": "2018-05-12T08:00:00.000000+03:00",
        "data": {
          "driver": {
            "driver_license_personal_ids": [
              "8hd93jdlakhf84030ejd9390z"
            ],
            "driver_licenses": [
              "12AB345678"
            ],
            "unique_driver_id": "111111111111111111111111"
          },
          "min_num_orders": 0,
          "rule": {
            "days_span": 1,
            "kind": "geo_booking",
            "last_shift_date": "2018-11-30",
            "zone_name": "moscow"
          },
          "subvention": {
            "amount": "8600.0000",
            "currency": "RUB"
          },
          "tzinfo": "Europe/Moscow"
        },
        "kind": "driver"
      },
      "antifraud_version": 2,
      "eye": {
        "forward": {
          "tags": [
            "taxi/shift_ended/unique_driver_id/111111111111111111111111/2018-05-11/geo_booking"
          ]
        }
      },
      "future_external_obj_id": "taxi/shift_ended/subvention_agreement/1/default/_id/geo_booking_rule_id",
      "future_journal_external_obj_id": "taxi/shift_ended/subvention_agreement/1/default/_id/geo_booking_rule_id",
      "future_journal_tags": [
        "journal_ancestor_doc_id/12345678"
      ],
      "future_support_info": {
        "data": {
          "free_minutes": 500,
          "income": {
            "expenses": {
              "amount": "0",
              "currency": "RUB"
            },
            "gross": {
              "amount": "10",
              "currency": "RUB"
            },
            "net": {
              "amount": "10",
              "currency": "RUB"
            }
          },
          "on_order_minutes": 200,
          "payout": {
            "expenses": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "0",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_zero_geo_booking_commission",
                  "value": {
                    "amount": "0",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "0",
                "currency": "RUB"
              }
            },
            "gross": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "8600.0",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_bonus",
                  "value": {
                    "amount": "8600.0",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "8600.0",
                "currency": "RUB"
              }
            },
            "net": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "8600.0",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_bonus_commission_diff",
                  "value": {
                    "amount": "8600.0",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "8600.0",
                "currency": "RUB"
              }
            }
          },
          "rule": {
            "id": "geo_booking_rule_id",
            "online_cost": {
              "amount": "8600.0",
              "currency": "RUB"
            },
            "rate_free_per_minute": "15",
            "rate_on_order_per_minute": "15",
            "type": "booking_geo_on_top"
          }
        },
        "kind": "taxi/v1/geo_booking"
      },
      "future_support_info_if_fraud": {
        "data": {
          "free_minutes": 500,
          "income": {
            "expenses": {
              "amount": "0",
              "currency": "RUB"
            },
            "gross": {
              "amount": "10",
              "currency": "RUB"
            },
            "net": {
              "amount": "10",
              "currency": "RUB"
            }
          },
          "on_order_minutes": 200,
          "payout": {
            "expenses": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "0",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_zero_geo_booking_commission",
                  "value": {
                    "amount": "0",
                    "currency": "RUB"
                  }
                },
                {
                  "args": [
                    {
                      "amount": "0",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_fraud",
                  "value": {
                    "amount": "0",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "0",
                "currency": "RUB"
              }
            },
            "gross": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "8600.0",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_bonus",
                  "value": {
                    "amount": "8600.0",
                    "currency": "RUB"
                  }
                },
                {
                  "args": [
                    {
                      "amount": "0",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_fraud",
                  "value": {
                    "amount": "0",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "0",
                "currency": "RUB"
              }
            },
            "net": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "8600.0",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_bonus_commission_diff",
                  "value": {
                    "amount": "8600.0",
                    "currency": "RUB"
                  }
                },
                {
                  "args": [
                    {
                      "amount": "0",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_fraud",
                  "value": {
                    "amount": "0",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "0",
                "currency": "RUB"
              }
            }
          },
          "rule": {
            "id": "geo_booking_rule_id",
            "online_cost": {
              "amount": "8600.0",
              "currency": "RUB"
            },
            "rate_free_per_minute": "15",
            "rate_on_order_per_minute": "15",
            "type": "booking_geo_on_top"
          }
        },
        "kind": "taxi/v1/geo_booking"
      },
      "initial_check": true,
      "journal_entries": {
        "block": [
          {
            "account_id": 2,
            "amount": "8600.0",
            "event_at": "2018-05-12T05:00:00.000000+00:00"
          }
        ],
        "execute": [
          {
            "account_id": 3,
            "amount": "8600.0",
            "event_at": "2018-05-12T05:00:00.000000+00:00"
          }
        ],
        "unhold_verification": [
          {
            "account_id": 1,
            "amount": "-8600.0",
            "event_at": "2018-05-12T05:00:00.000000+00:00"
          }
        ]
      },
      "notifications": [
        {
          "data": {
            "bonus": {
              "amount": "8600.0",
              "currency": "RUB"
            },
            "date": "2018-05-11",
            "goal_is_fulfilled": true,
            "id": "geo_booking_rule_id",
            "income": {
              "amount": "10",
              "currency": "RUB"
            },
            "key": "2018-05-11/unique_driver_id/111111111111111111111111/subvention_agreement/1/default/_id/geo_booking_rule_id",
            "performer": {
              "db_id": "db_id",
              "park_id": "clid",
              "uuid": "uuid"
            },
            "rule_id": {
              "type_conversion": "identity",
              "value": "geo_booking_rule_id"
            },
            "zone_name": "moscow"
          },
          "kind": "geo_booking"
        }
      ],
      "parent_doc_id": 12345678,
      "subventions_input": {
        "accepted_by_driver_at": null,
        "activity_points": null,
        "agglomeration": "mesto_vozniknoveniya_potrebnosti",
        "base_doc_id": 12345678,
        "billing_client_id": "billing_client_id",
        "billing_v2_id": null,
        "closed_without_accept": null,
        "comment": {
          "date": "2018-05-11",
          "free_minutes": 500,
          "income": {
            "amount": "10",
            "currency": "RUB"
          },
          "on_order_minutes": 200,
          "payment_type": "add",
          "rule_kind": "geo_booking"
        },
        "completed_by_dispatcher": null,
        "contract_id": "123456",
        "create_via_py2": false,
        "currency_data": {
          "for_contract": {
            "currency": "RUB",
            "rate_from_local": "1"
          },
          "for_offer_contract": {
            "currency": "USD",
            "rate_from_local": "0.016"
          }
        },
        "db_id": "db_id",
        "discount_details": {
          "amendments": [],
          "discount": "0 RUB"
        },
        "driver_license": "12AB345678",
        "dry_mode": true,
        "due": "2018-05-11T00:00:00.000000+03:00",
        "force_hold": false,
        "has_co_branding": null,
        "has_lightbox": null,
        "has_sticker": null,
        "hold_config": {
          "delay": 0
        },
        "is_cargo": true,
        "order_alias_id": "noorder/4216d0d67c04ba145b435f68268ade",
        "order_id": "noorder/4216d0d67c04ba145b435f68268ade",
        "order_payment_type": "add",
        "park": {
          "automate_marketing_payments": true,
          "city": {
            "country_code": "rus",
            "donate_discounts_multiplier": null,
            "donate_multiplier": null,
            "id": "Соликамск",
            "tzinfo": "Asia/Yekaterinburg"
          },
          "contract_currency": "RUB",
          "contract_currency_rate": "1",
          "offer_confirmed_at": null,
          "offer_contract_currency": "USD",
          "offer_contract_currency_rate": "0.016",
          "pay_donations_without_offer": false
        },
        "park_id": "clid",
        "related_orders_ids": [
          "some_order_id"
        ],
        "rule_details": [
          {
            "extra": {},
            "is_once": false,
            "limit_ref": null,
            "payment_type": "add",
            "rule_id": {
              "group_id": "geo_booking_rule_group_id",
              "id": "geo_booking_rule_id"
            },
            "rule_type": "booking_geo_on_top",
            "subvention_geoareas": [
              "msk"
            ],
            "value": "8600 RUB"
          }
        ],
        "rule_group": "geobooking",
        "sub_commission": "0 RUB",
        "subvention_geoareas": [],
        "tags": [],
        "tariff_class": null,
        "unique_driver_id": "5bab4bf979b9e5513fe5ec4a",
        "unrealized_sub_commission": "0 RUB",
        "uuid": "uuid",
        "value": "8600.0000 RUB",
        "zone_name": "moscow"
      }
    },
    "event_at": "2018-05-12T05:00:00.000000+00:00",
    "external_event_ref": "2018-05-11/antifraud_request",
    "external_obj_id": "antifraud_check/taxi/shift_ended/subvention_agreement/1/default/_id/geo_booking_rule_id",
    "journal_entries": [],
    "kind": "subvention_antifraud_check",
    "service": "billing-subventions",
    "status": "new",
    "tags": [
      "system://parent_doc_id/12345678"
    ]
  },
  {
    "data": {
      "antifraud_action": "delay",
      "check_id": "initial_antifraud_check_doc_id/1",
      "subventions_input": {
        "db_id": "db_id",
        "due": "2018-05-11T00:00:00.000000+03:00",
        "order_alias_id": "noorder/4216d0d67c04ba145b435f68268ade",
        "rule_details": [
          {
            "extra": {},
            "is_once": false,
            "limit_ref": null,
            "payment_type": "add",
            "rule_id": {
              "group_id": "geo_booking_rule_group_id",
              "id": "geo_booking_rule_id"
            },
            "rule_type": "booking_geo_on_top",
            "subvention_geoareas": [
              "msk"
            ],
            "value": "8600.0000 RUB"
          }
        ],
        "sub_commission": "0 RUB",
        "uuid": "uuid"
      }
    },
    "event_at": "2018-05-12T05:00:00.000000+00:00",
    "external_event_ref": "1/antifraud_entries",
    "external_obj_id": "taxi/write_subvention_antifraud_entries/geobooking/alias_id/noorder/4216d0d67c04ba145b435f68268ade",
    "journal_entries": [],
    "kind": "write_subvention_antifraud_entries",
    "service": "billing-subventions",
    "status": "new",
    "tags": []
  },
  {
    "data": {
      "ancestor_doc_kind": "shift_ended"
    },
    "event_at": "2018-05-12T05:00:00.000000+00:00",
    "external_event_ref": "2018-05-11/subvention_handled",
    "external_obj_id": "taxi/shift_ended/subvention_agreement/1/default/_id/geo_booking_rule_id",
    "journal_entries": [],
    "kind": "subvention_journal",
    "service": "billing-subventions",
    "status": "complete",
    "tags": [
      "system://parent_doc_id/12345678",
      "journal_ancestor_doc_id/12345678"
    ]
  }
]
