[
  {
    "data": {
      "ancestor_doc_kind": "shift_ended"
    },
    "event_at": "2018-05-12T05:00:00.000000+00:00",
    "external_event_ref": "2018-05-11/payment_subvention_handled",
    "external_obj_id": "taxi/shift_ended/subvention_agreement/1/default/_id/driver_fix",
    "journal_entries": [
      {
        "account_id": 0,
        "amount": "10.0000",
        "event_at": "2018-05-12T05:00:00.000000+00:00"
      },
      {
        "account_id": 1,
        "amount": "10.0000",
        "event_at": "2018-05-12T05:00:00.000000+00:00"
      }
    ],
    "kind": "payment_subvention_journal",
    "service": "billing-subventions",
    "status": "new",
    "tags": [
      "system://parent_doc_id/12345678",
      "journal_ancestor_doc_id/12345678"
    ]
  },
  {
    "data": {
      "ancestor_doc_kind": "shift_ended",
      "antifraud_query": {
        "after": "2018-05-12T08:00:00.000000+03:00",
        "data": {
          "check_on": "2018-05-11T21:30:00.000000+00:00",
          "currency": "RUB",
          "driver": {
            "driver_license_personal_ids": [
              "8hd93jdlakhf84030ejd9390z"
            ],
            "driver_licenses": [
              "12AB345678"
            ],
            "unique_driver_id": "111111111111111111111111"
          },
          "guarantee": "30",
          "min_num_orders": 0,
          "payment": "20",
          "rule": {
            "days_span": 1,
            "kind": "driver_fix",
            "last_shift_date": "2018-05-11",
            "zone_name": "moscow"
          },
          "subvention": {
            "amount": "10.0000",
            "currency": "RUB"
          },
          "tzinfo": "Europe/Moscow"
        },
        "kind": "driver"
      },
      "antifraud_version": 2,
      "eye": {
        "forward": {
          "tags": [
            "taxi/shift_ended/unique_driver_id/111111111111111111111111/2018-05-11/driver_fix"
          ]
        }
      },
      "future_external_obj_id": "taxi/shift_ended/subvention_agreement/1/default/_id/driver_fix",
      "future_journal_external_obj_id": "taxi/shift_ended/subvention_agreement/1/default/_id/driver_fix",
      "future_journal_tags": [
        "journal_ancestor_doc_id/12345678"
      ],
      "future_support_info": {
        "data": {
          "discounts": {
            "balance": {
              "amount": "0",
              "currency": "RUB"
            }
          },
          "driver_payout": {
            "amount": "29.0000",
            "currency": "RUB"
          },
          "guarantee": {
            "balance": {
              "amount": "30",
              "currency": "RUB"
            },
            "details": {
              "intervals": [
                {
                  "duration_min": "2",
                  "rate_per_min": "1"
                },
                {
                  "duration_min": "7",
                  "rate_per_min": "2"
                },
                {
                  "duration_min": "5",
                  "rate_per_min": "3"
                }
              ]
            }
          },
          "income": {
            "balance": {
              "amount": "20",
              "currency": "RUB"
            },
            "entries": [
              {
                "alias_id": "some_alias_id"
              }
            ]
          },
          "payout": {
            "expenses": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "0.8333333333333333333333333333",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_driver_fix_commission",
                  "value": {
                    "amount": "0.8333333333333333333333333333",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "0.8333333333333333333333333333",
                "currency": "RUB"
              }
            },
            "gross": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "10",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_bonus",
                  "value": {
                    "amount": "10",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "10",
                "currency": "RUB"
              }
            },
            "net": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "9.166666666666666666666666667",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_bonus_commission_diff",
                  "value": {
                    "amount": "9.166666666666666666666666667",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "9.166666666666666666666666667",
                "currency": "RUB"
              }
            }
          },
          "promocodes/marketing": {
            "balance": {
              "amount": "0",
              "currency": "RUB"
            }
          },
          "promocodes/support": {
            "balance": {
              "amount": "0",
              "currency": "RUB"
            }
          },
          "rule": {
            "id": "driver_fix"
          },
          "time/free_minutes": {
            "balance": {
              "amount": "3",
              "currency": "XXX"
            }
          },
          "time/on_order_minutes": {
            "balance": {
              "amount": "0",
              "currency": "XXX"
            },
            "entries": [
              {
                "alias_id": "some_alias_id"
              }
            ]
          },
          "total_income": {
            "expenses": {
              "amount": "0",
              "currency": "RUB"
            },
            "gross": {
              "amount": "20",
              "currency": "RUB"
            },
            "net": {
              "amount": "20",
              "currency": "RUB"
            }
          }
        },
        "kind": "taxi/v1/driver_fix"
      },
      "future_support_info_if_fraud": {
        "data": {
          "discounts": {
            "balance": {
              "amount": "0",
              "currency": "RUB"
            }
          },
          "driver_payout": {
            "amount": "16.6000",
            "currency": "RUB"
          },
          "guarantee": {
            "balance": {
              "amount": "30",
              "currency": "RUB"
            },
            "details": {
              "intervals": [
                {
                  "duration_min": "2",
                  "rate_per_min": "1"
                },
                {
                  "duration_min": "7",
                  "rate_per_min": "2"
                },
                {
                  "duration_min": "5",
                  "rate_per_min": "3"
                }
              ]
            }
          },
          "income": {
            "balance": {
              "amount": "20",
              "currency": "RUB"
            },
            "entries": [
              {
                "alias_id": "some_alias_id"
              }
            ]
          },
          "payout": {
            "expenses": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "2.833333333333333333333333333",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_fraud",
                  "value": {
                    "amount": "2.833333333333333333333333333",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "2.833333333333333333333333333",
                "currency": "RUB"
              }
            },
            "gross": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "0",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_fraud",
                  "value": {
                    "amount": "0",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "0",
                "currency": "RUB"
              }
            },
            "net": {
              "calculations": [
                {
                  "args": [
                    {
                      "amount": "-2.833333333333333333333333333",
                      "currency": "RUB"
                    }
                  ],
                  "details": {},
                  "op": "set",
                  "reason": "set_from_fraud",
                  "value": {
                    "amount": "-2.833333333333333333333333333",
                    "currency": "RUB"
                  }
                }
              ],
              "value": {
                "amount": "-2.833333333333333333333333333",
                "currency": "RUB"
              }
            }
          },
          "promocodes/marketing": {
            "balance": {
              "amount": "0",
              "currency": "RUB"
            }
          },
          "promocodes/support": {
            "balance": {
              "amount": "0",
              "currency": "RUB"
            }
          },
          "rule": {
            "id": "driver_fix"
          },
          "time/free_minutes": {
            "balance": {
              "amount": "3",
              "currency": "XXX"
            }
          },
          "time/on_order_minutes": {
            "balance": {
              "amount": "0",
              "currency": "XXX"
            },
            "entries": [
              {
                "alias_id": "some_alias_id"
              }
            ]
          },
          "total_income": {
            "expenses": {
              "amount": "0",
              "currency": "RUB"
            },
            "gross": {
              "amount": "20",
              "currency": "RUB"
            },
            "net": {
              "amount": "20",
              "currency": "RUB"
            }
          }
        },
        "kind": "taxi/v1/driver_fix"
      },
      "initial_check": true,
      "journal_entries": {
        "block": [
          {
            "account_id": 2,
            "amount": "10.0000",
            "event_at": "2018-05-12T05:00:00.000000+00:00"
          }
        ],
        "execute": [
          {
            "account_id": 3,
            "amount": "10.0000",
            "event_at": "2018-05-12T05:00:00.000000+00:00"
          }
        ],
        "unhold_verification": [
          {
            "account_id": 1,
            "amount": "-10.0000",
            "event_at": "2018-05-12T05:00:00.000000+00:00"
          }
        ]
      },
      "notifications": [],
      "parent_doc_id": 12345678,
      "payout_info": {
        "amount_for_park_commission": "30",
        "driver_income_info": {
          "free_minutes": "3",
          "on_order_minutes": "0",
          "payout": "29.00000000000000000000000000 RUB"
        },
        "driver_work_mode": "driver_fix",
        "payments": [
          {
            "amount": "0.16",
            "billing_client_id": "billing_client_id",
            "contract_id": "123457",
            "currency": "USD",
            "invoice_date": "2018-05-10T21:00:00.000000+00:00",
            "payload": {
              "agglomeration": "mesto_vozniknoveniya_potrebnosti",
              "alias_id": "noorder/d2093905e4659b9abf06be7231bc4d",
              "detailed_product": "subsidy_driver_fix",
              "due": "2018-05-10T21:00:00.000000+00:00",
              "is_payable": true,
              "order_id": "noorder/d2093905e4659b9abf06be7231bc4d",
              "payload": {
                "amount_details": {
                  "base_amount": "10.0000",
                  "base_currency": "RUB",
                  "contract_currency_rate": "0.01600",
                  "donate_multiplier": "1.0000"
                },
                "base_doc_id": 12345678,
                "driver_details": {
                  "clid": "clid",
                  "db_id": "db_id",
                  "uuid": "uuid"
                },
                "nearest_zone": "moscow",
                "related_orders_ids": [
                  "some_order_id"
                ],
                "rule_db_id": "driver_fix"
              }
            },
            "payment_kind": "subvention"
          },
          {
            "amount": "0.8333",
            "billing_client_id": "billing_client_id",
            "contract_id": "123456",
            "currency": "RUB",
            "invoice_date": "2018-05-10T21:00:00.000000+00:00",
            "payload": {
              "agglomeration": "mesto_vozniknoveniya_potrebnosti",
              "alias_id": "noorder/d2093905e4659b9abf06be7231bc4d",
              "detailed_product": "driver_fix_commission",
              "due": "2018-05-10T21:00:00.000000+00:00",
              "order_id": "noorder/d2093905e4659b9abf06be7231bc4d",
              "payload": {
                "amount_details": {
                  "base_amount": "0.8333",
                  "base_currency": "RUB",
                  "contract_currency_rate": "1.00000",
                  "vat": "0.1667"
                },
                "base_doc_id": 12345678,
                "driver_details": {
                  "clid": "clid",
                  "db_id": "db_id",
                  "uuid": "uuid"
                },
                "nearest_zone": "moscow",
                "related_orders_ids": [
                  "some_order_id"
                ],
                "subvention_rule_db_id": "driver_fix"
              },
              "payment_type": "driver_fix"
            },
            "payment_kind": "commission/driver_fix"
          }
        ]
      },
      "payout_info_if_fraud": {
        "amount_for_park_commission": "20",
        "driver_income_info": {
          "free_minutes": "0",
          "on_order_minutes": "0",
          "payout": "16.60000000000000000000000000 RUB"
        },
        "driver_work_mode": "driver_fix",
        "payments": [
          {
            "amount": "2.8333",
            "billing_client_id": "billing_client_id",
            "contract_id": "123456",
            "currency": "RUB",
            "invoice_date": "2018-05-10T21:00:00.000000+00:00",
            "payload": {
              "agglomeration": "mesto_vozniknoveniya_potrebnosti",
              "alias_id": "noorder/d2093905e4659b9abf06be7231bc4d",
              "detailed_product": "driver_fix_commission_for_fraud",
              "due": "2018-05-10T21:00:00.000000+00:00",
              "order_id": "noorder/d2093905e4659b9abf06be7231bc4d",
              "payload": {
                "amount_details": {
                  "base_amount": "2.8333",
                  "base_currency": "RUB",
                  "contract_currency_rate": "1.00000",
                  "vat": "0.5667"
                },
                "base_doc_id": 12345678,
                "driver_details": {
                  "clid": "clid",
                  "db_id": "db_id",
                  "uuid": "uuid"
                },
                "nearest_zone": "moscow",
                "related_orders_ids": [
                  "some_order_id"
                ],
                "subvention_rule_db_id": "driver_fix"
              },
              "payment_type": "driver_fix"
            },
            "payment_kind": "commission/driver_fix"
          }
        ]
      },
      "subventions_input": {
        "accepted_by_driver_at": null,
        "activity_points": null,
        "agglomeration": "mesto_vozniknoveniya_potrebnosti",
        "base_doc_id": 12345678,
        "billing_client_id": "billing_client_id",
        "billing_v2_id": null,
        "closed_without_accept": null,
        "comment": null,
        "completed_by_dispatcher": null,
        "create_via_py2": false,
        "currency_data": {
          "for_contract": {
            "currency": "RUB",
            "rate_from_local": "1"
          },
          "for_offer_contract": {
            "currency": "USD",
            "rate_from_local": "0.016"
          }
        },
        "db_id": "db_id",
        "discount_details": {
          "amendments": [],
          "discount": "0 RUB"
        },
        "driver_license": "12AB345678",
        "dry_mode": true,
        "due": "2018-05-10T21:00:00.000000+00:00",
        "force_hold": false,
        "has_co_branding": null,
        "has_lightbox": null,
        "has_sticker": null,
        "hold_config": {
          "delay": 0
        },
        "is_cargo": false,
        "order_alias_id": "noorder/d2093905e4659b9abf06be7231bc4d",
        "order_id": "noorder/d2093905e4659b9abf06be7231bc4d",
        "order_payment_type": "driver_fix",
        "park": {
          "automate_marketing_payments": true,
          "city": {
            "country_code": "rus",
            "donate_discounts_multiplier": null,
            "donate_multiplier": null,
            "id": "Соликамск",
            "tzinfo": "Asia/Yekaterinburg"
          },
          "contract_currency": "RUB",
          "contract_currency_rate": "1",
          "offer_confirmed_at": null,
          "offer_contract_currency": "USD",
          "offer_contract_currency_rate": "0.016",
          "pay_donations_without_offer": false
        },
        "park_id": "clid",
        "rule_details": [
          {
            "extra": {},
            "is_once": false,
            "limit_ref": null,
            "payment_type": "add",
            "rule_id": {
              "group_id": "driver_fix_group_id",
              "id": "driver_fix"
            },
            "rule_type": "driver_fix",
            "subvention_geoareas": [
              "moscow_center"
            ],
            "value": "10.0000 RUB"
          }
        ],
        "rule_group": "driver_fix",
        "sub_commission": "0 RUB",
        "subvention_geoareas": [],
        "tags": [],
        "tariff_class": null,
        "unique_driver_id": "5bab4bf979b9e5513fe5ec4a",
        "unrealized_sub_commission": "0 RUB",
        "uuid": "uuid",
        "value": "10.0000 RUB",
        "zone_name": "moscow"
      }
    },
    "event_at": "2018-05-12T05:00:00.000000+00:00",
    "external_event_ref": "2018-05-11/antifraud_request",
    "external_obj_id": "antifraud_check/taxi/shift_ended/subvention_agreement/1/default/_id/driver_fix",
    "journal_entries": [],
    "kind": "subvention_antifraud_check",
    "service": "billing-subventions",
    "status": "new",
    "tags": [
      "system://parent_doc_id/12345678"
    ]
  },
  {
    "data": {
      "antifraud_action": "delay",
      "check_id": "initial_antifraud_check_doc_id/1",
      "subventions_input": {
        "db_id": "db_id",
        "due": "2018-05-10T21:00:00.000000+00:00",
        "order_alias_id": "noorder/d2093905e4659b9abf06be7231bc4d",
        "rule_details": [
          {
            "extra": {},
            "is_once": false,
            "limit_ref": null,
            "payment_type": "add",
            "rule_id": {
              "group_id": "driver_fix_group_id",
              "id": "driver_fix"
            },
            "rule_type": "driver_fix",
            "subvention_geoareas": [
              "moscow_center"
            ],
            "value": "10.0000 RUB"
          }
        ],
        "sub_commission": "0 RUB",
        "uuid": "uuid"
      }
    },
    "event_at": "2018-05-12T05:00:00.000000+00:00",
    "external_event_ref": "1/antifraud_entries",
    "external_obj_id": "taxi/write_subvention_antifraud_entries/driver_fix/alias_id/noorder/d2093905e4659b9abf06be7231bc4d",
    "journal_entries": [],
    "kind": "write_subvention_antifraud_entries",
    "service": "billing-subventions",
    "status": "new",
    "tags": []
  },
  {
    "data": {
      "ancestor_doc_kind": "shift_ended"
    },
    "event_at": "2018-05-12T05:00:00.000000+00:00",
    "external_event_ref": "2018-05-11/subvention_handled",
    "external_obj_id": "taxi/shift_ended/subvention_agreement/1/default/_id/driver_fix",
    "journal_entries": [],
    "kind": "subvention_journal",
    "service": "billing-subventions",
    "status": "complete",
    "tags": [
      "system://parent_doc_id/12345678",
      "journal_ancestor_doc_id/12345678"
    ]
  }
]
