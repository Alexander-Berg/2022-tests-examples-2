{
  "expected_created_yt_tables": [
    {
      "path": "//testsuite/unittests/features/billing-fin-payouts/export_batches_data/2022-03",
      "schema": [
        {
          "demand": "required",
          "name": "export_id",
          "sort_order": "ascending",
          "type": "int64"
        },
        {
          "name": "export_created_at_utc",
          "type": "string"
        },
        {
          "name": "batch_id",
          "type": "int64"
        },
        {
          "name": "transaction_id",
          "type": "int64"
        },
        {
          "name": "part_count",
          "type": "int32"
        },
        {
          "name": "branch_type",
          "type": "string"
        },
        {
          "name": "payload",
          "type": "any"
        },
        {
          "name": "firm_id",
          "type": "int32"
        },
        {
          "name": "client_id",
          "type": "string"
        },
        {
          "name": "contract_id",
          "type": "string"
        },
        {
          "name": "person_id",
          "type": "string"
        },
        {
          "name": "contract_alias",
          "type": "string"
        },
        {
          "name": "currency",
          "type": "string"
        },
        {
          "name": "amount_w_vat",
          "type": "string"
        },
        {
          "name": "amount_w_vat_applied",
          "type": "string"
        },
        {
          "name": "amount_w_vat_saldo",
          "type": "string"
        },
        {
          "name": "accounting_date",
          "type": "string"
        },
        {
          "name": "accounting_period",
          "type": "string"
        },
        {
          "name": "netting_sign",
          "type": "int8"
        }
      ]
    },
    {
      "path": "//testsuite/unittests/features/billing-fin-payouts/dry_export_batches_data/2022-03",
      "schema": [
        {
          "demand": "required",
          "name": "export_id",
          "sort_order": "ascending",
          "type": "int64"
        },
        {
          "name": "export_created_at_utc",
          "type": "string"
        },
        {
          "name": "batch_id",
          "type": "int64"
        },
        {
          "name": "transaction_id",
          "type": "int64"
        },
        {
          "name": "part_count",
          "type": "int32"
        },
        {
          "name": "branch_type",
          "type": "string"
        },
        {
          "name": "payload",
          "type": "any"
        },
        {
          "name": "firm_id",
          "type": "int32"
        },
        {
          "name": "client_id",
          "type": "string"
        },
        {
          "name": "contract_id",
          "type": "string"
        },
        {
          "name": "person_id",
          "type": "string"
        },
        {
          "name": "contract_alias",
          "type": "string"
        },
        {
          "name": "currency",
          "type": "string"
        },
        {
          "name": "amount_w_vat",
          "type": "string"
        },
        {
          "name": "amount_w_vat_applied",
          "type": "string"
        },
        {
          "name": "amount_w_vat_saldo",
          "type": "string"
        },
        {
          "name": "accounting_date",
          "type": "string"
        },
        {
          "name": "accounting_period",
          "type": "string"
        },
        {
          "name": "netting_sign",
          "type": "int8"
        }
      ]
    },
    {
      "path": "//testsuite/unittests/features/billing-fin-payouts/dry_export_batches_data/2022-04",
      "schema": [
        {
          "demand": "required",
          "name": "export_id",
          "sort_order": "ascending",
          "type": "int64"
        },
        {
          "name": "export_created_at_utc",
          "type": "string"
        },
        {
          "name": "batch_id",
          "type": "int64"
        },
        {
          "name": "transaction_id",
          "type": "int64"
        },
        {
          "name": "part_count",
          "type": "int32"
        },
        {
          "name": "branch_type",
          "type": "string"
        },
        {
          "name": "payload",
          "type": "any"
        },
        {
          "name": "firm_id",
          "type": "int32"
        },
        {
          "name": "client_id",
          "type": "string"
        },
        {
          "name": "contract_id",
          "type": "string"
        },
        {
          "name": "person_id",
          "type": "string"
        },
        {
          "name": "contract_alias",
          "type": "string"
        },
        {
          "name": "currency",
          "type": "string"
        },
        {
          "name": "amount_w_vat",
          "type": "string"
        },
        {
          "name": "amount_w_vat_applied",
          "type": "string"
        },
        {
          "name": "amount_w_vat_saldo",
          "type": "string"
        },
        {
          "name": "accounting_date",
          "type": "string"
        },
        {
          "name": "accounting_period",
          "type": "string"
        },
        {
          "name": "netting_sign",
          "type": "int8"
        }
      ]
    }
  ],
  "expected_get_calls": [],
  "expected_lock_calls": [
    {
      "//testsuite/unittests/features/billing-fin-payouts": "@export_batches_data_cursor"
    }
  ],
  "expected_set_calls": [
    {
      "//testsuite/unittests/features/billing-fin-payouts/@export_batches_data_cursor": 4
    }
  ],
  "expected_uploaded_data": {
    "//testsuite/unittests/features/billing-fin-payouts/dry_export_batches_data/2022-03": [
      {
        "accounting_date": "2022-03-20",
        "accounting_period": "2022-03",
        "amount_w_vat": "36.04",
        "amount_w_vat_applied": "36.04",
        "amount_w_vat_saldo": "0.00",
        "batch_id": 3,
        "branch_type": "expenses",
        "client_id": "1349547813",
        "contract_alias": "ОФ-1567291/20",
        "contract_id": "3714633",
        "currency": "RUB",
        "export_created_at_utc": "2022-03-04T01:32:46.166692+00:00",
        "export_id": 3,
        "firm_id": 13,
        "netting_sign": 1,
        "part_count": 0,
        "payload": {
          "account_info": {
            "account": "ЛСТ-12345678"
          }
        },
        "person_id": "13506136",
        "transaction_id": 6222878
      }
    ],
    "//testsuite/unittests/features/billing-fin-payouts/dry_export_batches_data/2022-04": [
      {
        "accounting_date": "2022-04-20",
        "accounting_period": "2022-04",
        "amount_w_vat": "36.04",
        "amount_w_vat_applied": "36.04",
        "amount_w_vat_saldo": "0.00",
        "batch_id": 3,
        "branch_type": "expenses",
        "client_id": "1349547813",
        "contract_alias": "ОФ-1567291/20",
        "contract_id": "3714633",
        "currency": "RUB",
        "export_created_at_utc": "2022-04-04T01:32:46.166692+00:00",
        "export_id": 4,
        "firm_id": 13,
        "netting_sign": 1,
        "part_count": 0,
        "payload": {
          "account_info": {
            "account": "ЛСТ-12345678"
          }
        },
        "person_id": "13506136",
        "transaction_id": 6222879
      }
    ],
    "//testsuite/unittests/features/billing-fin-payouts/export_batches_data/2022-03": [
      {
        "accounting_date": "2022-03-20",
        "accounting_period": "2022-03",
        "amount_w_vat": "13.78",
        "amount_w_vat_applied": "13.78",
        "amount_w_vat_saldo": "0.00",
        "batch_id": 1,
        "branch_type": "expenses",
        "client_id": "1349515601",
        "contract_alias": "ОФ-1553027/20",
        "contract_id": "3697980",
        "currency": "RUB",
        "export_created_at_utc": "2022-03-03T01:17:41.119996+00:00",
        "export_id": 1,
        "firm_id": 13,
        "netting_sign": 1,
        "part_count": 0,
        "payload": {
          "account_info": {
            "account": "ЛСТ-12345678"
          }
        },
        "person_id": "13489397",
        "transaction_id": 6222872
      },
      {
        "accounting_date": "2022-03-20",
        "accounting_period": "2022-03",
        "amount_w_vat": "36.04",
        "amount_w_vat_applied": "36.04",
        "amount_w_vat_saldo": "0.00",
        "batch_id": 2,
        "branch_type": "expenses",
        "client_id": "1349547813",
        "contract_alias": "ОФ-1567291/20",
        "contract_id": "3714633",
        "currency": "RUB",
        "export_created_at_utc": "2022-03-04T01:32:46.166692+00:00",
        "export_id": 2,
        "firm_id": 13,
        "netting_sign": 1,
        "part_count": 0,
        "payload": {
          "account_info": {
            "account": "ЛСТ-12345678"
          }
        },
        "person_id": "13506136",
        "transaction_id": 6222877
      }
    ]
  }
}
