{
  "expected_created_yt_tables": [
    {
      "path": "//testsuite/unittests/features/billing-fin-payouts/dry_interface_expenses/2022-03",
      "schema": [
        {
          "demand": "required",
          "name": "export_id",
          "sort_order": "ascending",
          "type": "int64"
        },
        {
          "name": "export_created_at_utc",
          "type": "string"
        },
        {
          "name": "transaction_id",
          "type": "int64"
        },
        {
          "name": "accounting_date",
          "type": "string"
        },
        {
          "name": "client_id",
          "type": "string"
        },
        {
          "name": "contract_id",
          "type": "string"
        },
        {
          "name": "currency",
          "type": "string"
        },
        {
          "name": "tlog_amount",
          "type": "string"
        },
        {
          "name": "amount",
          "type": "string"
        },
        {
          "name": "tlog_table_name",
          "type": "string"
        },
        {
          "name": "tlog_table_row_index",
          "type": "int64"
        },
        {
          "name": "accounting_period",
          "type": "string"
        },
        {
          "name": "payload",
          "type": "any"
        },
        {
          "name": "dry_run",
          "type": "boolean"
        },
        {
          "name": "payment_processor",
          "type": "string"
        },
        {
          "name": "batch_group_key",
          "type": "string"
        },
        {
          "name": "external_ref",
          "type": "string"
        }
      ]
    },
    {
      "path": "//testsuite/unittests/features/billing-fin-payouts/dry_interface_expenses/2022-04",
      "schema": [
        {
          "demand": "required",
          "name": "export_id",
          "sort_order": "ascending",
          "type": "int64"
        },
        {
          "name": "export_created_at_utc",
          "type": "string"
        },
        {
          "name": "transaction_id",
          "type": "int64"
        },
        {
          "name": "accounting_date",
          "type": "string"
        },
        {
          "name": "client_id",
          "type": "string"
        },
        {
          "name": "contract_id",
          "type": "string"
        },
        {
          "name": "currency",
          "type": "string"
        },
        {
          "name": "tlog_amount",
          "type": "string"
        },
        {
          "name": "amount",
          "type": "string"
        },
        {
          "name": "tlog_table_name",
          "type": "string"
        },
        {
          "name": "tlog_table_row_index",
          "type": "int64"
        },
        {
          "name": "accounting_period",
          "type": "string"
        },
        {
          "name": "payload",
          "type": "any"
        },
        {
          "name": "dry_run",
          "type": "boolean"
        },
        {
          "name": "payment_processor",
          "type": "string"
        },
        {
          "name": "batch_group_key",
          "type": "string"
        },
        {
          "name": "external_ref",
          "type": "string"
        }
      ]
    },
    {
      "path": "//testsuite/unittests/features/billing-fin-payouts/interface_expenses/2022-03",
      "schema": [
        {
          "demand": "required",
          "name": "export_id",
          "sort_order": "ascending",
          "type": "int64"
        },
        {
          "name": "export_created_at_utc",
          "type": "string"
        },
        {
          "name": "transaction_id",
          "type": "int64"
        },
        {
          "name": "accounting_date",
          "type": "string"
        },
        {
          "name": "client_id",
          "type": "string"
        },
        {
          "name": "contract_id",
          "type": "string"
        },
        {
          "name": "currency",
          "type": "string"
        },
        {
          "name": "tlog_amount",
          "type": "string"
        },
        {
          "name": "amount",
          "type": "string"
        },
        {
          "name": "tlog_table_name",
          "type": "string"
        },
        {
          "name": "tlog_table_row_index",
          "type": "int64"
        },
        {
          "name": "accounting_period",
          "type": "string"
        },
        {
          "name": "payload",
          "type": "any"
        },
        {
          "name": "dry_run",
          "type": "boolean"
        },
        {
          "name": "payment_processor",
          "type": "string"
        },
        {
          "name": "batch_group_key",
          "type": "string"
        },
        {
          "name": "external_ref",
          "type": "string"
        }
      ]
    },
    {
      "path": "//testsuite/unittests/features/billing-fin-payouts/interface_expenses/2022-04",
      "schema": [
        {
          "demand": "required",
          "name": "export_id",
          "sort_order": "ascending",
          "type": "int64"
        },
        {
          "name": "export_created_at_utc",
          "type": "string"
        },
        {
          "name": "transaction_id",
          "type": "int64"
        },
        {
          "name": "accounting_date",
          "type": "string"
        },
        {
          "name": "client_id",
          "type": "string"
        },
        {
          "name": "contract_id",
          "type": "string"
        },
        {
          "name": "currency",
          "type": "string"
        },
        {
          "name": "tlog_amount",
          "type": "string"
        },
        {
          "name": "amount",
          "type": "string"
        },
        {
          "name": "tlog_table_name",
          "type": "string"
        },
        {
          "name": "tlog_table_row_index",
          "type": "int64"
        },
        {
          "name": "accounting_period",
          "type": "string"
        },
        {
          "name": "payload",
          "type": "any"
        },
        {
          "name": "dry_run",
          "type": "boolean"
        },
        {
          "name": "payment_processor",
          "type": "string"
        },
        {
          "name": "batch_group_key",
          "type": "string"
        },
        {
          "name": "external_ref",
          "type": "string"
        }
      ]
    }
  ],
  "expected_get_calls": [],
  "expected_lock_calls": [
    {
      "//testsuite/unittests/features/billing-fin-payouts": "@interface_expenses_cursor"
    }
  ],
  "expected_set_calls": [
    {
      "//testsuite/unittests/features/billing-fin-payouts/@interface_expenses_cursor": 6
    }
  ],
  "expected_uploaded_data": {
    "//testsuite/unittests/features/billing-fin-payouts/dry_interface_expenses/2022-03": [
      {
        "accounting_date": "2022-03-03T09:53:52.200001",
        "accounting_period": "2022-03",
        "amount": "111111",
        "batch_group_key": "batch_group_key",
        "client_id": "654321123",
        "contract_id": "123123",
        "currency": "RUB",
        "dry_run": true,
        "export_created_at_utc": "2022-03-03T09:53:52.200001+00:00",
        "export_id": 1,
        "external_ref": "dafault_external_ref",
        "payload": [
          {
            "attr": 123
          }
        ],
        "payment_processor": "YA_BANK",
        "tlog_amount": "13",
        "tlog_table_name": "qweqwe",
        "tlog_table_row_index": 123,
        "transaction_id": 12345
      },
      {
        "accounting_date": "2022-03-04T09:53:52.200001",
        "accounting_period": "2022-03",
        "amount": "11111",
        "batch_group_key": "batch_group_key",
        "client_id": "64321123",
        "contract_id": "12123",
        "currency": "RUB",
        "dry_run": true,
        "export_created_at_utc": "2022-03-04T09:53:52.200001+00:00",
        "export_id": 2,
        "external_ref": "dafault_external_ref",
        "payload": {},
        "payment_processor": "YA_BANK",
        "tlog_amount": "113",
        "tlog_table_name": "qweqwe",
        "tlog_table_row_index": 1223,
        "transaction_id": 123456
      },
      {
        "accounting_date": "2022-03-05T09:53:52.200001",
        "accounting_period": "2022-03",
        "amount": "111311",
        "batch_group_key": "batch_group_key",
        "client_id": "65434421123",
        "contract_id": "1223123",
        "currency": "RUB",
        "dry_run": true,
        "export_created_at_utc": "2022-03-05T09:53:52.200001+00:00",
        "export_id": 3,
        "external_ref": "dafault_external_ref",
        "payload": {},
        "payment_processor": "YA_BANK",
        "tlog_amount": "123",
        "tlog_table_name": "qweqwe",
        "tlog_table_row_index": 1253,
        "transaction_id": 1234567
      }
    ],
    "//testsuite/unittests/features/billing-fin-payouts/dry_interface_expenses/2022-04": [
      {
        "accounting_date": "2022-03-03T09:53:52.200001",
        "accounting_period": "2022-03",
        "amount": "111111",
        "batch_group_key": "batch_group_key",
        "client_id": "654321123",
        "contract_id": "123123",
        "currency": "RUB",
        "dry_run": true,
        "export_created_at_utc": "2022-03-31T21:00:00.000000+00:00",
        "export_id": 5,
        "external_ref": "dafault_external_ref",
        "payload": [
          {
            "attr": 123
          }
        ],
        "payment_processor": "YA_BANK",
        "tlog_amount": "13",
        "tlog_table_name": "qweqwe",
        "tlog_table_row_index": 123,
        "transaction_id": 123456789
      }
    ],
    "//testsuite/unittests/features/billing-fin-payouts/interface_expenses/2022-03": [
      {
        "accounting_date": "2022-03-05T09:53:52.200001",
        "accounting_period": "2022-03",
        "amount": "111311",
        "batch_group_key": "batch_group_key",
        "client_id": "65434421123",
        "contract_id": "1223123",
        "currency": "RUB",
        "dry_run": false,
        "export_created_at_utc": "2022-03-05T09:53:52.200001+00:00",
        "export_id": 4,
        "external_ref": "dafault_external_ref",
        "payload": {},
        "payment_processor": "YA_BANK",
        "tlog_amount": "123",
        "tlog_table_name": "qweqwe",
        "tlog_table_row_index": 1253,
        "transaction_id": 1234568
      }
    ],
    "//testsuite/unittests/features/billing-fin-payouts/interface_expenses/2022-04": [
      {
        "accounting_date": "2022-04-05T09:53:52.200001",
        "accounting_period": "2022-04",
        "amount": "111311",
        "batch_group_key": "batch_group_key",
        "client_id": "65434421123",
        "contract_id": "1223123",
        "currency": "RUB",
        "dry_run": false,
        "export_created_at_utc": "2022-04-05T09:53:52.200001+00:00",
        "export_id": 6,
        "external_ref": "dafault_external_ref",
        "payload": {},
        "payment_processor": "YA_BANK",
        "tlog_amount": "123",
        "tlog_table_name": "qweqwe",
        "tlog_table_row_index": 1253,
        "transaction_id": 1234569
      }
    ]
  }
}
