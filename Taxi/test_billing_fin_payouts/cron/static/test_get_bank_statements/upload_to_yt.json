{
  "existing_nodes": {
    "//testsuite/unittests/features/billing-fin-payouts/bank-statements/account_id_1": null,
    "//testsuite/unittests/features/billing-fin-payouts/bank-statements/account_id_1/@_cursor": {
      "file_id": "a3d3117c0e6f4bbdb065d4fe1f75ee44",
      "statement_date": "2022-06-02",
      "statement_id": "2c43e9c8ca72405199ffba9b2370a59e",
      "status": "RECEIVED"
    },
    "//testsuite/unittests/features/billing-fin-payouts/bank-statements/account_id_1/account_id_1_01.06.2022": null,
    "//testsuite/unittests/features/billing-fin-payouts/bank-statements/account_id_1/account_id_1_headers": null,
    "//testsuite/unittests/features/billing-fin-payouts/bank-statements/account_id_1/account_id_1_headers/@row_count": 10
  },
  "expected_created_yt_tables": [
    {
      "path": "//testsuite/unittests/features/billing-fin-payouts/bank-statements/account_id_1/account_id_1_02.06.2022",
      "schema": [
        {
          "demand": "required",
          "name": "ID",
          "sort_order": "ascending",
          "type": "int64"
        },
        {
          "name": "ACCOUNT",
          "type": "string"
        },
        {
          "name": "BIC",
          "type": "string"
        },
        {
          "name": "INN",
          "type": "string"
        },
        {
          "name": "SUMM",
          "type": "double"
        },
        {
          "name": "DIRECTION",
          "type": "string"
        },
        {
          "name": "DOC_DATE",
          "type": "string"
        },
        {
          "name": "DOC_NUMBER",
          "type": "string"
        },
        {
          "name": "GROUND",
          "type": "string"
        },
        {
          "name": "NAME",
          "type": "string"
        },
        {
          "name": "GUID",
          "type": "string"
        },
        {
          "name": "LS_NUMBER",
          "type": "string"
        },
        {
          "name": "CONTRACT_ID",
          "type": "string"
        }
      ]
    },
    {
      "path": "//testsuite/unittests/features/billing-fin-payouts/bank-statements/account_id_1/account_id_1_headers",
      "schema": [
        {
          "demand": "required",
          "name": "ID",
          "sort_order": "ascending",
          "type": "int64"
        },
        {
          "name": "ACCOUNT",
          "type": "string"
        },
        {
          "name": "STATEMENT_DATE",
          "type": "string"
        },
        {
          "name": "OPENING_BALANCE",
          "type": "double"
        },
        {
          "name": "CLOSING_BALANCE",
          "type": "double"
        },
        {
          "name": "CREDIT_TURNOVER",
          "type": "double"
        },
        {
          "name": "DEBIT_TURNOVER",
          "type": "double"
        }
      ]
    }
  ],
  "expected_exists_calls": [
    "//testsuite/unittests/features/billing-fin-payouts/bank-statements/account_id_1",
    "//testsuite/unittests/features/billing-fin-payouts/bank-statements/account_id_1/@_cursor",
    "//testsuite/unittests/features/billing-fin-payouts/bank-statements/account_id_1/account_id_1_02.06.2022"
  ],
  "expected_get_calls": [
    "//testsuite/unittests/features/billing-fin-payouts/bank-statements/account_id_1/@_cursor",
    "//testsuite/unittests/features/billing-fin-payouts/bank-statements/account_id_1/account_id_1_headers/@row_count"
  ],
  "expected_lock_calls": [],
  "expected_mkdir_calls": [],
  "expected_order_statement_request": null,
  "expected_set_calls": [
    {
      "//testsuite/unittests/features/billing-fin-payouts/bank-statements/account_id_1/@_cursor": {
        "file_id": "a3d3117c0e6f4bbdb065d4fe1f75ee44",
        "statement_date": "2022-06-02",
        "statement_id": "2c43e9c8ca72405199ffba9b2370a59e",
        "status": "COMPLETE"
      }
    }
  ],
  "expected_statement_status_request": null,
  "expected_uploaded_data": {
    "//testsuite/unittests/features/billing-fin-payouts/bank-statements/account_id_1/account_id_1_02.06.2022": [
      {
        "ACCOUNT": "40914810020000000038",
        "BIC": "044525677",
        "CONTRACT_ID": "12345633",
        "DIRECTION": "out",
        "DOC_DATE": "27.04.2022",
        "DOC_NUMBER": "669289",
        "GROUND": "Оплата по договору НДС = 0",
        "GUID": "taxi-123456733",
        "ID": 1,
        "INN": "7750004168",
        "LS_NUMBER": "ЛСТ -12345678-3",
        "NAME": "АО Яндекс Банк",
        "SUMM": 1500.0
      },
      {
        "ACCOUNT": "40914810020000000038",
        "BIC": "044525677",
        "CONTRACT_ID": "12345633",
        "DIRECTION": "out",
        "DOC_DATE": "27.04.2022",
        "DOC_NUMBER": "671118",
        "GROUND": "Новая опалата по договору НДС = 0",
        "GUID": "taxi-123456734",
        "ID": 2,
        "INN": "7750004168",
        "LS_NUMBER": "ЛСТ -12345678-3",
        "NAME": "АО Яндекс Банк",
        "SUMM": 11500.0
      },
      {
        "ACCOUNT": "40914810020000000038",
        "BIC": "044525677",
        "CONTRACT_ID": "12345633",
        "DIRECTION": "in",
        "DOC_DATE": "27.04.2022",
        "DOC_NUMBER": "671120",
        "GROUND": "Комиссия по договору НДС = 0",
        "GUID": "taxi-123456735",
        "ID": 3,
        "INN": "7750004168",
        "LS_NUMBER": "ЛСТ -12345678-3",
        "NAME": "АО Яндекс Банк",
        "SUMM": 115.15
      },
      {
        "ACCOUNT": "40702810600059170138",
        "BIC": "044525222",
        "CONTRACT_ID": "12345633",
        "DIRECTION": "in",
        "DOC_DATE": "27.04.2022",
        "DOC_NUMBER": "671140",
        "GROUND": "Пополнение счета в банке НДС = 0",
        "GUID": "taxi-123456736",
        "ID": 4,
        "INN": "0000000000",
        "LS_NUMBER": "ЛСТ -12345678-3",
        "NAME": "Яндекс Такси",
        "SUMM": 1000000.0
      },
      {
        "ACCOUNT": "40702810600059170138",
        "BIC": "044525222",
        "CONTRACT_ID": "12345633",
        "DIRECTION": "out",
        "DOC_DATE": "27.04.2022",
        "DOC_NUMBER": "671152",
        "GROUND": "Возврат излишне перечисленных денежных средств 400.40 НДС = 0",
        "GUID": "taxi-123456737",
        "ID": 5,
        "INN": "0000000000",
        "LS_NUMBER": null,
        "NAME": "Яндекс - Такси",
        "SUMM": 400.4
      }
    ],
    "//testsuite/unittests/features/billing-fin-payouts/bank-statements/account_id_1/account_id_1_headers": [
      {
        "ACCOUNT": "40702810000059170138",
        "CLOSING_BALANCE": 1338486.6,
        "CREDIT_TURNOVER": 1000115.15,
        "DEBIT_TURNOVER": 13400.4,
        "ID": 11,
        "OPENING_BALANCE": 351771.85,
        "STATEMENT_DATE": "27.04.2022"
      }
    ]
  },
  "order_statement_response": null,
  "statement_file": "40702810000059170138\t2022-04-27\t351771.85\t1338486.60\t13400.40\t1000115.15\r\n044525677\t7750004168\tАО Яндекс Банк\tОплата по договору НДС = 0\t40914810020000000038\t2022-04-27\t1500.00\t669289\tOUT\tcontract:12345633\taccount:ЛСТ -12345678-3\tguid:taxi-123456733\r\n044525677\t7750004168\tАО Яндекс Банк\tНовая опалата по договору НДС = 0\t40914810020000000038\t2022-04-27\t11500.00\t671118\tOUT\tcontract:12345633\taccount:ЛСТ -12345678-3\tguid:taxi-123456734\r\n044525677\t7750004168\tАО Яндекс Банк\tКомиссия по договору НДС = 0\t40914810020000000038\t2022-04-27\t115.15\t671120\tIN\tcontract:12345633\taccount:ЛСТ -12345678-3\tguid:taxi-123456735\r\n044525222\t0000000000\tЯндекс Такси\tПополнение счета в банке НДС = 0\t40702810600059170138\t2022-04-27\t1000000.00\t671140\tIN\tcontract:12345633\taccount:ЛСТ -12345678-3\tguid:taxi-123456736\r\n044525222\t0000000000\tЯндекс - Такси\tВозврат излишне перечисленных денежных средств 400.40 НДС = 0\t40702810600059170138\t2022-04-27\t400.40\t671152\tOUT\tcontract:12345633\tguid:taxi-123456737\r\n",
  "statement_status_response": null
}
