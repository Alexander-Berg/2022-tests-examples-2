{
  "expected_invoice_request": {
    "operations": [
      {
        "callbacks": [
          {
            "payload": {
              "arbitrary": "data"
            },
            "queue": "callback_with_payload"
          },
          {
            "queue": "callback_without_payload"
          }
        ],
        "created": {
          "$datetime": "2020-01-01T00:00:00.000"
        },
        "disable_automatic_composite_refund": true,
        "id": "operation-1234",
        "items_by_payment_type": [
          {
            "items": [
              {
                "amount": "123",
                "commission_category": 600,
                "fiscal_receipt_info": {
                  "cashregister_params": {
                    "receipt_footer": "C расширенной подпиской вы получаете возможность копить кешбэк баллами"
                  },
                  "personal_tin_id": null,
                  "title": "128_characters_of_gibberish_diqinkblhfdxaanesngzfkgmxmyifwwiknxvvyfsmhzaubzojhawgqiqfbhcqgqgcfujulkcjkkpuokkaoyqxijmtuqtejfudpsp",
                  "vat": "nds_20"
                },
                "item_id": "ride",
                "product_id": "132"
              }
            ],
            "payment_type": "card"
          }
        ],
        "login_id": "some_login_id",
        "mcc": 1234,
        "notification_payload": {
          "debt_id": "some_debt_id",
          "service": "eats"
        },
        "originator": "processing",
        "pass_params": {
          "a": "b"
        },
        "payment_timeout": 180,
        "payments": [
          {
            "billing_id": "card-1324",
            "method": "1324",
            "type": "card"
          }
        ],
        "status": "init",
        "trust_afs_params": {
          "afs": "params"
        },
        "ttl": 360,
        "type": "update",
        "user_ip": "127.0.0.1",
        "wallet_payload": {
          "foo": "bar"
        },
        "yandex_uid": "123"
      }
    ],
    "originator": "processing",
    "priority": 1,
    "products": {
      "ride": "132"
    },
    "version": 1
  },
  "expected_message": "Cannot change product_id for item ride",
  "request": {
    "callbacks": [
      {
        "payload": {
          "arbitrary": "data"
        },
        "queue": "callback_with_payload"
      },
      {
        "queue": "callback_without_payload"
      }
    ],
    "disable_automatic_composite_refund": true,
    "id": "product-change",
    "items_by_payment_type": [
      {
        "items": [
          {
            "amount": "123",
            "commission_category": 600,
            "fiscal_receipt_info": {
              "cashregister_params": {
                "receipt_footer": "C расширенной подпиской вы получаете возможность копить кешбэк баллами"
              },
              "title": "128_characters_of_gibberish_diqinkblhfdxaanesngzfkgmxmyifwwiknxvvyfsmhzaubzojhawgqiqfbhcqgqgcfujulkcjkkpuokkaoyqxijmtuqtejfudpsp",
              "vat": "nds_20"
            },
            "item_id": "ride",
            "product_id": "132"
          }
        ],
        "payment_type": "card"
      }
    ],
    "login_id": "some_login_id",
    "mcc": 1234,
    "notification_payload": {
      "debt_id": "some_debt_id",
      "service": "eats"
    },
    "operation_id": "operation-1234",
    "originator": "processing",
    "pass_params": {
      "a": "b"
    },
    "payment_timeout": 180,
    "payments": [
      {
        "billing_id": "card-1324",
        "method": "1324",
        "type": "card"
      }
    ],
    "trust_afs_params": {
      "afs": "params"
    },
    "ttl": 360,
    "user_ip": "127.0.0.1",
    "version": 0,
    "wallet_payload": {
      "foo": "bar"
    },
    "yandex_uid": "123"
  }
}
