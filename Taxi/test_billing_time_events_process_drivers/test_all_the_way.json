{
  "accounts_create_free_minutes_request": {
    "agreement_id": "subvention_agreement/1/default/_id/6/subscription/doc_id/28",
    "currency": "XXX",
    "entity_external_id": "taximeter_driver_id/dbid/uuid1",
    "expired": "2020-09-28T10:03:00+00:00",
    "sub_account": "dry/time/free_minutes"
  },
  "accounts_create_guarantee_request": {
    "agreement_id": "subvention_agreement/1/default/_id/6/subscription/doc_id/28",
    "currency": "USD",
    "entity_external_id": "taximeter_driver_id/dbid/uuid1",
    "expired": "2020-09-28T10:03:00+00:00",
    "sub_account": "dry/guarantee"
  },
  "accounts_create_unfit_free_minutes_request": {
    "agreement_id": "subvention_agreement/1/default/_id/6/subscription/doc_id/28",
    "currency": "XXX",
    "entity_external_id": "taximeter_driver_id/dbid/uuid1",
    "expired": "2020-09-28T10:03:00+00:00",
    "sub_account": "dry/unfit/time/free_minutes"
  },
  "accounts_search_free_minutes_request": {
    "agreement_id": "subvention_agreement/1/default/_id/6/subscription/doc_id/28",
    "currency": "XXX",
    "entity_external_id": "taximeter_driver_id/dbid/uuid1",
    "sub_account": "dry/time/free_minutes"
  },
  "accounts_search_guarantee_request": {
    "agreement_id": "subvention_agreement/1/default/_id/6/subscription/doc_id/28",
    "currency": "USD",
    "entity_external_id": "taximeter_driver_id/dbid/uuid1",
    "sub_account": "dry/guarantee"
  },
  "accounts_search_unfit_free_minutes_request": {
    "agreement_id": "subvention_agreement/1/default/_id/6/subscription/doc_id/28",
    "currency": "XXX",
    "entity_external_id": "taximeter_driver_id/dbid/uuid1",
    "sub_account": "dry/unfit/time/free_minutes"
  },
  "docs_execute_request": {
    "docs": [
      {
        "data": {
          "ancestor_doc_kind": "driver_geoarea_activity",
          "data": {
            "unfit_rules": [
              {
                "agreement_ref": "subvention_agreement/1/default/_id/6",
                "id": "6",
                "reasons": [
                  {
                    "data": {
                      "code": "interval",
                      "details": {
                        "allowed_values": [
                          "2020-05-11T20:00:00+00:00",
                          "2020-06-30T10:03:00+00:00"
                        ],
                        "values": [
                          "2020-06-30T10:03:00+00:00",
                          "2020-06-30T10:04:00+00:00"
                        ]
                      }
                    },
                    "kind": "intersection"
                  }
                ],
                "sub_account": "unfit/time/free_minutes"
              }
            ]
          }
        },
        "event_at": "2020-08-14T00:00:00.00001+00:00",
        "external_ref": "driver_geoarea_activity/2020-06-30T10:35:00.000000+00:00_2020-06-30T11:05:00.000000+00:00/9f58ace77c8ddcfcd1c1f835e8d74c352cc6d959/subvention_handled",
        "journal_entries": [
          {
            "account_id": 1,
            "amount": "18.0000",
            "details": {
              "intervals": [
                {
                  "duration_min": "1.0000",
                  "rate_per_min": "6.0000"
                },
                {
                  "duration_min": "1.0000",
                  "rate_per_min": "6.0000"
                },
                {
                  "duration_min": "1.0000",
                  "rate_per_min": "6.0000"
                }
              ]
            },
            "event_at": "2020-06-30T10:00:00+00:00"
          },
          {
            "account_id": 2,
            "amount": "3.0000",
            "event_at": "2020-06-30T10:00:00+00:00"
          }
        ],
        "kind": "subvention_journal",
        "service": "billing-time-events",
        "topic": "dry/taxi/geoarea_activity/unique_driver_id/8589869056"
      }
    ]
  },
  "docs_search_request": {
    "event_at_end": "2020-06-30T10:03:00+00:00",
    "external_obj_id": "taxi/driver_mode_subscription/dbid/uuid1"
  },
  "docs_search_response": {
    "docs": [
      {
        "created": "2020-05-01T00:00:00+00:00",
        "data": {
          "driver": {
            "driver_id": "uuid1",
            "park_id": "dbid"
          },
          "mode": "orders",
          "mode_rule": "uberdriver",
          "subscription": {
            "attr": "..."
          }
        },
        "doc_id": 6,
        "event_at": "2020-05-01T20:00:00+00:00",
        "external_event_ref": "external_ref/6",
        "external_obj_id": "taxi/driver_mode_subscription/dbid/uuid1",
        "kind": "driver_mode_subscription",
        "process_at": "2020-05-01T20:00:00.000000+00:00",
        "service": "billing-orders",
        "status": "complete",
        "tags": []
      },
      {
        "created": "2020-06-30T00:00:00.000000+00:00",
        "data": {
          "driver": {
            "driver_id": "uuid1",
            "park_id": "dbid"
          },
          "mode": "driver_fix",
          "settings": {
            "rule_id": "_id/6",
            "shift_close_time": "00:00:00+03:00"
          }
        },
        "doc_id": 28,
        "event_at": "2020-06-30T10:00:00+00:00",
        "external_event_ref": "external_ref/28",
        "external_obj_id": "taxi/driver_mode_subscription/dbid/uuid1",
        "kind": "driver_mode_subscription",
        "process_at": "2020-06-30T10:02:00+00:00",
        "service": "billing-orders",
        "status": "new",
        "tags": []
      }
    ]
  },
  "entities_create_request": {
    "external_id": "taximeter_driver_id/dbid/uuid1",
    "kind": "driver"
  },
  "entities_search_request": {
    "external_id": "taximeter_driver_id/dbid/uuid1"
  },
  "process_doc_request": {
    "doc": {
      "id": 1,
      "kind": "shift_ended"
    },
    "process_at": "2020-07-01T05:00:00.161+00:00"
  },
  "rules_select_request": {
    "limit": 2,
    "rule_ids": [
      "_id/6"
    ]
  },
  "rules_select_response": {
    "subventions": [
      {
        "commission_rate_if_fraud": "0.2",
        "currency": "USD",
        "cursor": "2020-05-11T20:00:00.000000+00:00",
        "end": "2020-06-30T10:03:00.000000+00:00",
        "geoareas": [
          "mkad"
        ],
        "group_id": "group_id/28",
        "hours": [
          0,
          23
        ],
        "is_personal": false,
        "log": [],
        "profile_payment_type_restrictions": "any",
        "profile_tariff_classes": [
          "comfort"
        ],
        "rates": [
          {
            "rate_per_minute": "6",
            "start": "23:59",
            "week_day": "sun"
          }
        ],
        "start": "2020-05-11T20:00:00.000000+00:00",
        "status": "enabled",
        "subvention_rule_id": "_id/6",
        "tags": [
          "driver_fix"
        ],
        "tariff_classes": [
          "econom"
        ],
        "tariff_zones": [
          "msk"
        ],
        "taxirate": "TAXIBILLING-3473",
        "time_zone": {
          "id": "Australia/Sydney",
          "offset": "+10:00"
        },
        "type": "driver_fix",
        "updated": "2020-05-11T20:00:00.000000+00:00",
        "visible_to_driver": true,
        "week_days": [
          "mon",
          "tue",
          "wed",
          "thu",
          "fri",
          "sat",
          "sun"
        ]
      }
    ]
  },
  "shifts_open_request": {
    "as_of": "2020-06-30T10:00:00+00:00",
    "driver": {
      "clid": "8128",
      "driver_profile_id": "uuid1",
      "park_id": "dbid",
      "unique_driver_id": "8589869056"
    },
    "driver_mode_subscription": {
      "doc_id": 28,
      "event_at": "2020-06-30T10:00:00+00:00",
      "mode": "driver_fix",
      "settings": {
        "rule_id": "_id/6",
        "shift_close_time": "21:00:00+00:00"
      }
    }
  },
  "stq_args": [
    0,
    {
      "$date": "2020-06-30T10:35:00Z"
    },
    {
      "$date": "2020-06-30T11:05:00Z"
    },
    [
      "dbid_uuid1"
    ],
    {
      "$date": "2020-06-30T10:00:00Z"
    },
    {
      "$date": "2020-06-30T10:03:00Z"
    }
  ]
}
