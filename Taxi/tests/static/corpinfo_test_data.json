{
  "expect_results": [
    {
      "cabinet_only_role": {
        "_id": "cabinet_role_id",
        "classes": [
          "econom"
        ],
        "limit": 1000,
        "name": "cabinet role"
      },
      "client": {
        "_id": "client_id",
        "comment": "comment",
        "contract_status": "active",
        "country": "rus",
        "is_active": true,
        "payment": {
          "is_blocked": false,
          "type": "none"
        }
      },
      "comment": "",
      "corp_payment_on": true,
      "order": {
        "classes": [
          "comfort"
        ],
        "cost_center": "order_cost_center",
        "has_corp_requirement": true
      },
      "result": {
        "client_comment": "comment",
        "client_id": "client_id",
        "cost_center": "order_cost_center",
        "user_id": "user_id"
      },
      "user": {
        "_id": "user_id",
        "client_id": "client_id",
        "cost_center": "user_cost_center",
        "is_active": true,
        "role": {
          "classes": [
            "econom",
            "comfort"
          ],
          "limit": 1000
        },
        "stat": {
          "2017-07": {
            "spent_with_vat": -5000000
          }
        }
      },
      "user_role": {
        "_id": "user_role_id",
        "classes": [
          "econom"
        ],
        "limit": 1000,
        "name": "user role"
      }
    }
  ],
  "throws_class_disabled": [
    {
      "cabinet_only_role": {
        "_id": "cabinet_role_id",
        "classes": [
          "econom"
        ],
        "limit": 1000,
        "name": "cabinet role"
      },
      "client": {
        "_id": "client_id",
        "contract_status": "active",
        "country": "rus",
        "is_active": true,
        "payment": {
          "is_blocked": false,
          "type": "none"
        }
      },
      "comment": "corp disabled for this class",
      "corp_payment_on": true,
      "order": {
        "classes": [
          "vip"
        ],
        "cost_center": "order_cost_center",
        "has_corp_requirement": true
      },
      "user": {
        "_id": "user_id",
        "client_id": "client_id",
        "is_active": true,
        "role": {
          "classes": [
            "econom",
            "comfort"
          ],
          "limit": 1000
        }
      },
      "user_role": {
        "_id": "user_role_id",
        "classes": [
          "econom"
        ],
        "limit": 1000,
        "name": "user role"
      }
    }
  ],
  "throws_deactivate_threshold_error": [
    {
      "cabinet_only_role": {
        "_id": "cabinet_role_id",
        "classes": [
          "econom"
        ],
        "limit": 1000,
        "name": "cabinet role"
      },
      "client": {
        "_id": "client_id",
        "contract_status": "active",
        "country": "rus",
        "is_active": true,
        "payment": {
          "is_blocked": true,
          "type": "prepaid"
        }
      },
      "comment": "prepaid and is_blocked",
      "corp_payment_on": true,
      "now": 1500125565,
      "order": {
        "classes": [
          "econom"
        ],
        "cost_center": "order_cost_center",
        "has_corp_requirement": true
      },
      "user": {
        "_id": "user_id",
        "client_id": "client_id",
        "is_active": true,
        "role": {
          "classes": [
            "econom",
            "comfort"
          ],
          "limit": 1000,
          "role_id": "user_dole_id"
        },
        "stat": {
          "2017-07": {
            "spent_with_vat": 10000001
          }
        }
      },
      "user_role": {
        "_id": "user_role_id",
        "classes": [
          "econom"
        ],
        "limit": 1000,
        "name": "user role"
      }
    }
  ],
  "throws_limit_exceeded": [
    {
      "cabinet_only_role": {
        "_id": "cabinet_role_id",
        "classes": [
          "econom"
        ],
        "limit": 1000,
        "name": "cabinet role"
      },
      "client": {
        "_id": "client_id",
        "contract_status": "active",
        "country": "rus",
        "is_active": true,
        "payment": {
          "is_blocked": true,
          "type": "none"
        }
      },
      "comment": "limit exceeded",
      "corp_payment_on": true,
      "now": 1500125565,
      "order": {
        "classes": [
          "econom"
        ],
        "cost_center": "order_cost_center",
        "has_corp_requirement": true
      },
      "user": {
        "_id": "user_id",
        "client_id": "client_id",
        "is_active": true,
        "role": {
          "classes": [
            "econom",
            "comfort"
          ],
          "limit": 1000,
          "role_id": "user_dole_id"
        },
        "stat": {
          "2017-07": {
            "spent_with_vat": 10000001
          }
        }
      },
      "user_role": {
        "_id": "user_role_id",
        "classes": [
          "econom"
        ],
        "limit": 1000,
        "name": "user role"
      }
    }
  ],
  "throws_not_found": [
    {
      "cabinet_only_role": {
        "_id": "cabinet_role_id",
        "classes": [
          "econom"
        ],
        "limit": 1000,
        "name": "cabinet role"
      },
      "client": {
        "_id": "client_id",
        "country": "rus",
        "is_active": true,
        "payment": {
          "is_blocked": false,
          "type": "none"
        }
      },
      "comment": "no client_id in order",
      "corp_payment_on": true,
      "order": {
        "cost_center": "order_cost_center",
        "has_corp_requirement": true
      },
      "user": {
        "_id": "user_id",
        "client_id": "client_id"
      },
      "user_role": {
        "_id": "user_role_id",
        "classes": [
          "econom"
        ],
        "limit": 1000,
        "name": "user role"
      }
    },
    {
      "cabinet_only_role": {
        "_id": "cabinet_role_id",
        "classes": [
          "econom"
        ],
        "limit": 1000,
        "name": "cabinet role"
      },
      "client": {
        "_id": "client_id",
        "country": "rus",
        "is_active": true,
        "payment": {
          "is_blocked": false,
          "type": "none"
        }
      },
      "comment": "not active: id user and client id mistatch",
      "corp_payment_on": true,
      "order": {
        "cost_center": "order_cost_center",
        "has_corp_requirement": true
      },
      "user": {
        "_id": "user_id",
        "client_id": "wrong client_id",
        "is_active": true
      },
      "user_role": {
        "_id": "user_role_id",
        "classes": [
          "econom"
        ],
        "limit": 1000,
        "name": "user role"
      }
    },
    {
      "cabinet_only_role": {
        "_id": "cabinet_role_id",
        "classes": [
          "econom"
        ],
        "limit": 1000,
        "name": "cabinet role"
      },
      "client": {
        "_id": "client_id",
        "country": "rus",
        "is_active": true,
        "payment": {
          "is_blocked": false,
          "type": "none"
        }
      },
      "comment": "not active",
      "corp_payment_on": true,
      "order": {
        "cost_center": "order_cost_center",
        "has_corp_requirement": true
      },
      "user": {
        "_id": "user_id",
        "client_id": "client_id",
        "is_active": false
      },
      "user_role": {
        "_id": "user_role_id",
        "classes": [
          "econom"
        ],
        "limit": 1000,
        "name": "user role"
      }
    },
    {
      "cabinet_only_role": {
        "_id": "cabinet_role_id",
        "classes": [
          "econom"
        ],
        "limit": 1000,
        "name": "cabinet role"
      },
      "client": {
        "_id": "client_id",
        "contract_status": "active",
        "country": "rus",
        "is_active": true,
        "payment": {
          "is_blocked": false,
          "type": "none"
        }
      },
      "comment": "cannot make orders from app",
      "corp_payment_on": true,
      "order": {
        "cost_center": "order_cost_center",
        "has_corp_requirement": true
      },
      "user": {
        "_id": "user_id",
        "client_id": "client_id",
        "is_active": true,
        "role": {
          "role_id": "cabinet_role_id"
        }
      },
      "user_role": {
        "_id": "user_role_id",
        "classes": [
          "econom"
        ],
        "limit": 1000,
        "name": "user role"
      }
    }
  ]
}
