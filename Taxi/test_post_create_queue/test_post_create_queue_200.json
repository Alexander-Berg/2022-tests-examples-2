[
  {
    "data": {
      "cluster": "test_cluster",
      "dead_tasks_settings": {
        "criteria": {
          "fails_num": 1
        },
        "policy": "dead_letter"
      },
      "department": "department_name",
      "description": "Образцовая очередь",
      "dev_team": "test_team",
      "enable_bulk_buffering": true,
      "is_enabled": false,
      "queue_name": "new_example_queue",
      "rate_limit": 100,
      "shards": [
        {
          "collection": "new_example_queue_shard_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ]
        },
        {
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ]
        }
      ],
      "taken_increase_limit": 1,
      "task_input_restriction": {
        "by_tvm_services": {
          "source_service": -1
        },
        "enable_restriction": true
      },
      "worker_configs": {
        "instances": 1,
        "max_execution_time": 120,
        "max_tasks": 10
      }
    },
    "expected_config": {
      "cluster": "test_cluster",
      "created": "2019-02-01T17:00:00+03:00",
      "dead_tasks_settings": {
        "criteria": {
          "fails_num": 1
        },
        "policy": "dead_letter"
      },
      "department": "department_name",
      "description": "Образцовая очередь",
      "dev_team": "test_team",
      "disable_tracing_capturing": false,
      "enable_bulk_buffering": true,
      "grafana_url": "grafana/new_example_queue",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "new_example_queue",
      "rate_limit": 100,
      "shards": [
        {
          "collection": "new_example_queue_shard_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        },
        {
          "collection": "new_example_queue_1",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "disabled",
      "taken_increase_limit": 1,
      "task_input_restriction": {
        "by_tvm_services": {
          "source_service": -1
        },
        "enable_restriction": true
      },
      "tplatform_namespace": "taxi",
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 1,
      "worker_configs": {
        "instances": 1,
        "max_execution_time": 120,
        "max_tasks": 10
      },
      "write_concern": false
    }
  },
  {
    "data": {
      "cluster": "test_cluster",
      "department": "market-support",
      "description": "Образцовая очередь",
      "dev_team": "test_team",
      "enable_bulk_buffering": true,
      "is_enabled": false,
      "queue_name": "new_example_queue",
      "rate_limit": 100,
      "shards": [
        {
          "collection": "new_example_queue_shard_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ]
        },
        {
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ]
        }
      ],
      "taken_increase_limit": 1,
      "task_input_restriction": {
        "by_tvm_services": {
          "source_service_1": -1,
          "source_service_2": 50
        },
        "enable_restriction": true
      },
      "worker_configs": {
        "instances": 1,
        "max_execution_time": 120,
        "max_tasks": 10
      }
    },
    "expected_config": {
      "cluster": "test_cluster",
      "created": "2019-02-01T17:00:00+03:00",
      "department": "market-support",
      "description": "Образцовая очередь",
      "dev_team": "test_team",
      "disable_tracing_capturing": false,
      "enable_bulk_buffering": true,
      "grafana_url": "grafana/new_example_queue",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "new_example_queue",
      "rate_limit": 100,
      "shards": [
        {
          "collection": "new_example_queue_shard_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        },
        {
          "collection": "new_example_queue_1",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "disabled",
      "taken_increase_limit": 1,
      "task_input_restriction": {
        "by_tvm_services": {
          "source_service_1": -1,
          "source_service_2": 50
        },
        "enable_restriction": true
      },
      "tplatform_namespace": "market",
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 1,
      "worker_configs": {
        "instances": 1,
        "max_execution_time": 120,
        "max_tasks": 10
      },
      "write_concern": false
    }
  },
  {
    "data": {
      "dead_tasks_settings": {
        "criteria": {
          "fails_duration": 1
        },
        "policy": "remove"
      },
      "dev_team": "test_team",
      "queue_name": "new_example_queue",
      "shards": [
        {
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": []
        },
        {
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": []
        }
      ],
      "task_input_restriction": {
        "enable_restriction": false
      },
      "worker_configs": {
        "instances": 1,
        "max_execution_time": 120,
        "max_tasks": 10
      },
      "write_concern": true
    },
    "expected_config": {
      "created": "2019-02-01T17:00:00+03:00",
      "dead_tasks_settings": {
        "criteria": {
          "fails_duration": 1
        },
        "policy": "remove"
      },
      "dev_team": "test_team",
      "disable_tracing_capturing": false,
      "grafana_url": "grafana/new_example_queue",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "new_example_queue",
      "shards": [
        {
          "collection": "new_example_queue_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [],
          "state": "enabled"
        },
        {
          "collection": "new_example_queue_1",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "task_input_restriction": {
        "enable_restriction": false
      },
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 1,
      "worker_configs": {
        "instances": 1,
        "max_execution_time": 120,
        "max_tasks": 10
      },
      "write_concern": true
    }
  },
  {
    "data": {
      "balancing_enabled": true,
      "dead_tasks_settings": {
        "criteria": {
          "fails_num": 1
        },
        "policy": "remove"
      },
      "dev_team": "test_team",
      "queue_name": "new_example_queue_2",
      "shards": [
        {
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": []
        },
        {
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": []
        }
      ],
      "task_input_restriction": {
        "by_tvm_services": {}
      },
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 100
      },
      "workers_guarantee": 20,
      "write_concern": true
    },
    "expected_config": {
      "balancing_enabled": true,
      "created": "2019-02-01T17:00:00+03:00",
      "dead_tasks_settings": {
        "criteria": {
          "fails_num": 1
        },
        "policy": "remove"
      },
      "dev_team": "test_team",
      "disable_tracing_capturing": false,
      "grafana_url": "grafana/new_example_queue_2",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "new_example_queue_2",
      "shards": [
        {
          "collection": "new_example_queue_2_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [],
          "state": "enabled"
        },
        {
          "collection": "new_example_queue_2_1",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "task_input_restriction": {
        "by_tvm_services": {}
      },
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 1,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 100
      },
      "workers_guarantee": 20,
      "write_concern": true
    }
  },
  {
    "data": {
      "abandoned_timeout": 30.0,
      "dev_team": "test_team",
      "is_enabled": false,
      "queue_name": "new_example_queue",
      "shards": [
        {
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ]
        }
      ],
      "worker_configs": {
        "instances": 1,
        "max_execution_time": 120,
        "max_tasks": 10
      }
    },
    "expected_config": {
      "abandoned_timeout": 30.0,
      "created": "2019-02-01T17:00:00+03:00",
      "dev_team": "test_team",
      "disable_tracing_capturing": false,
      "grafana_url": "grafana/new_example_queue",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "new_example_queue",
      "shards": [
        {
          "collection": "new_example_queue_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "disabled",
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 1,
      "worker_configs": {
        "instances": 1,
        "max_execution_time": 120,
        "max_tasks": 10
      },
      "write_concern": false
    }
  },
  {
    "data": {
      "abandoned_timeout": 30.0,
      "dev_team": "test_team",
      "disable_tracing_capturing": true,
      "is_enabled": false,
      "queue_name": "new_example_queue",
      "shards": [
        {
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ]
        }
      ],
      "worker_configs": {
        "instances": 1,
        "max_execution_time": 120,
        "max_tasks": 10
      }
    },
    "expected_config": {
      "abandoned_timeout": 30.0,
      "created": "2019-02-01T17:00:00+03:00",
      "dev_team": "test_team",
      "disable_tracing_capturing": true,
      "grafana_url": "grafana/new_example_queue",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "new_example_queue",
      "shards": [
        {
          "collection": "new_example_queue_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "disabled",
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 1,
      "worker_configs": {
        "instances": 1,
        "max_execution_time": 120,
        "max_tasks": 10
      },
      "write_concern": false
    },
    "test_id": "set_disable_tracing_capturing"
  }
]
