{
  "expected_payout": {
    "base_doc_id": 10,
    "dry_mode": false,
    "entries": [
      {
        "account_id": null,
        "agreement_id": "taxi/orders",
        "amount": "100.0",
        "currency": "RUB",
        "details": {},
        "entity_external_id": "corp/client/<id>",
        "entity_kind": "corp_client",
        "entry_id": null,
        "event_at": "2020-06-01T00:00:00.000000+00:00",
        "sub_account": "payment"
      },
      {
        "account_id": null,
        "agreement_id": "taxi/orders",
        "amount": "20.0",
        "currency": "RUB",
        "details": {
          "reverse_entry_event_at": "2020-05-01T00:00:00.000000+00:00"
        },
        "entity_external_id": "corp/client/<id>",
        "entity_kind": "corp_client",
        "entry_id": null,
        "sub_account": "payment/vat"
      },
      {
        "account_id": null,
        "agreement_id": "tlog",
        "amount": "120",
        "currency": "RUB",
        "details": {
          "agglomeration": "<agglomeration>",
          "billing_client_id": "123124",
          "due": "2019-08-08T15:13:02.832Z",
          "invoice_date": "2019-08-08T15:13:02.832000+00:00",
          "is_payable": false,
          "payload": {
            "alias_id": "<alias_id>",
            "amount_details": {
              "base_amount": "100",
              "base_currency": "TBH",
              "contract_currency_rate": "1.2"
            },
            "base_doc_id": 10,
            "driver_details": {
              "clid": "<clid>",
              "db_id": "<db_id>",
              "uuid": "<uuid>"
            },
            "nearest_zone": "<nz>",
            "order_id": "<order_id>"
          },
          "service_id": 650
        },
        "entity_external_id": "billing_client_id/123124",
        "entity_kind": "client",
        "entry_id": null,
        "sub_account": "client_b2b_trip_payment"
      },
      {
        "account_id": null,
        "agreement_id": "tlog",
        "amount": "120",
        "currency": "RUB",
        "details": {
          "agglomeration": "<agglomeration>",
          "billing_client_id": "123124",
          "due": "2019-08-08T15:13:02.832Z",
          "handled_in_trust_flow": false,
          "invoice_date": "2019-08-08T15:13:02.832000+00:00",
          "is_payable": true,
          "payload": {
            "alias_id": "<alias_id>",
            "amount_details": {
              "base_amount": "100",
              "base_currency": "TBH",
              "contract_currency_rate": "1.2",
              "vat": "0"
            },
            "base_doc_id": 10,
            "driver_details": {
              "clid": "<clid>",
              "db_id": "<db_id>",
              "uuid": "<uuid>"
            },
            "nearest_zone": "<nz>",
            "order_id": "<order_id>"
          },
          "service_id": 651
        },
        "entity_external_id": "billing_client_id/123124",
        "entity_kind": "client",
        "entry_id": null,
        "sub_account": "park_b2b_trip_payment"
      },
      {
        "account_id": null,
        "agreement_id": "taxi/yandex_ride/mode/driver_fix/fact",
        "amount": "100.0",
        "currency": "TBH",
        "details": {
          "alias_id": "<alias_id>"
        },
        "entity_external_id": "taximeter_driver_id/<db_id>/<driver_uuid>",
        "entity_kind": "driver",
        "entry_id": null,
        "sub_account": "subvention/driver_fix"
      },
      {
        "account_id": null,
        "agreement_id": "taxi/yandex_ride/mode/driver_fix/fact",
        "amount": "100.0",
        "currency": "TBH",
        "details": {
          "alias_id": "<alias_id>",
          "driver": {
            "driver_uuid": "<driver_uuid>"
          }
        },
        "entity_external_id": "taximeter_park_id/<db_id>",
        "entity_kind": "park",
        "entry_id": null,
        "sub_account": "subvention/driver_fix"
      }
    ],
    "event_at": "2019-08-08T15:13:02.832000+00:00",
    "external_obj_id": "taxi/b2b_trip_payout/191207-117522/process",
    "kind": "b2b_trip_payout",
    "payout_doc_id": 1006,
    "post_processing_actions": [
      {
        "func": "send_to_tlog",
        "keywords": {}
      },
      {
        "func": "create_income_journal",
        "keywords": {
          "income_event_at": "2019-08-08T15:13:02.832000+00:00"
        }
      }
    ],
    "tags": [],
    "topic_begin_at": "2019-08-08T15:10:00.000000+00:00",
    "version": 1
  },
  "expected_taximeter_entries_count": 0,
  "expected_tlog_entries_count": 2,
  "input_doc": {
    "data": {
      "base_doc_id": 10,
      "driver_income": {
        "alias_id": "<alias_id>",
        "components": [
          {
            "amount": "100.0",
            "currency": "TBH",
            "kind": "driver_fix/fact/subvention"
          }
        ],
        "driver": {
          "db_id": "<db_id>",
          "driver_uuid": "<driver_uuid>"
        },
        "order_event_at": "2019-08-08T15:13:02.832+00:00"
      },
      "entries": [
        {
          "agreement_id": "taxi/orders",
          "amount": "100.0",
          "currency": "RUB",
          "details": {},
          "entity_external_id": "corp/client/<id>",
          "event_at": "2020-06-01T00:00:00+00:00",
          "sub_account": "payment"
        },
        {
          "agreement_id": "taxi/orders",
          "amount": "20.0",
          "currency": "RUB",
          "details": {},
          "entity_external_id": "corp/client/<id>",
          "reverse_entry_event_at": "2020-05-01T00:00:00+00:00",
          "sub_account": "payment/vat"
        }
      ],
      "event_version": 1,
      "payments": [
        {
          "amount": "120",
          "billing_client_id": "123124",
          "currency": "RUB",
          "invoice_date": "2019-08-08T15:13:02.832Z",
          "payload": {
            "agglomeration": "<agglomeration>",
            "due": "2019-08-08T15:13:02.832Z",
            "payload": {
              "alias_id": "<alias_id>",
              "amount_details": {
                "base_amount": "100",
                "base_currency": "TBH",
                "contract_currency_rate": "1.2"
              },
              "driver_details": {
                "clid": "<clid>",
                "db_id": "<db_id>",
                "uuid": "<uuid>"
              },
              "nearest_zone": "<nz>",
              "order_id": "<order_id>"
            }
          },
          "payment_kind": "client_b2b_trip_payment"
        },
        {
          "amount": "120",
          "billing_client_id": "123124",
          "currency": "RUB",
          "invoice_date": "2019-08-08T15:13:02.832Z",
          "payload": {
            "agglomeration": "<agglomeration>",
            "due": "2019-08-08T15:13:02.832Z",
            "payload": {
              "alias_id": "<alias_id>",
              "amount_details": {
                "base_amount": "100",
                "base_currency": "TBH",
                "contract_currency_rate": "1.2",
                "vat": "0"
              },
              "driver_details": {
                "clid": "<clid>",
                "db_id": "<db_id>",
                "uuid": "<uuid>"
              },
              "nearest_zone": "<nz>",
              "order_id": "<order_id>"
            }
          },
          "payment_kind": "park_b2b_trip_payment"
        }
      ],
      "schema_version": "v1",
      "topic_begin_at": "2019-08-08T15:10:00.000000+00:00"
    },
    "doc_id": 1006,
    "event_at": "2019-08-08T15:13:02.832000+00:00",
    "external_event_ref": "2",
    "external_obj_id": "taxi/b2b_trip_payout/191207-117522",
    "journal_entries": [],
    "kind": "b2b_trip_payout",
    "service": "billing-orders",
    "status": "new"
  }
}
