{
  "expected_query": {
    "$Query": {
      "city_id": "Москва",
      "contracts": [
        {
          "$Contract": {
            "currency": "USD",
            "id": 1
          }
        }
      ],
      "coupon_value": {
        "$money": "100 RUB"
      },
      "driver_mode": {
        "$driver_mode": "orders"
      },
      "is_cargo": true,
      "is_for_support": false,
      "is_mqc": false,
      "is_netting": false,
      "need_dispatcher_acceptance": false,
      "order_cost": {
        "$decimal": "272"
      },
      "order_due_local": {
        "$date": "2020-12-22"
      },
      "service_to_contract": {
        "$int_key_mapping": {
          "137": 1
        }
      },
      "status": "finished",
      "taxi_status": "complete"
    }
  },
  "expected_results": {
    "$CouponCompensation": {
      "is_compensated": false,
      "skip_reason": "function_called"
    }
  },
  "taxi_order": {
    "$Doc": {
      "data": {
        "contracts": {
          "items": [
            {
              "currency": "USD",
              "id": 1
            }
          ],
          "service_to_contract": {
            "137": 1
          }
        },
        "driver": {
          "activity_points": 50,
          "clid": "643753730233",
          "driver_license_personal_id": "some_driver_license_personal_id",
          "driver_profile_id": "657dde13c5a14ef3a320c58c58a27b19",
          "geo_hierarchy": "russia/moscow",
          "hired_at": "2020-12-22T11:48:39.046000+03:00",
          "hiring_type": "commercial",
          "park_id": "7f74df331eb04ad78bc2ff25ff88a8f2",
          "tags": [
            "some_tag"
          ],
          "unique_driver_id": "5b05621ee6c22ea2654849f4",
          "zone_name": "tula"
        },
        "driver_mode": {
          "mode": "orders"
        },
        "order_info": {
          "accepted_by_driver_at": "2020-12-22T11:48:39.046000+03:00",
          "alias_id": "902fe475af72677caea7b8f49db06905",
          "billing_at": "2020-12-22T11:48:39.046000+03:00",
          "cancelled_with_captcha": false,
          "city_id": "Москва",
          "closed_without_accept": false,
          "completed_at": "2020-12-22T11:48:39.046000+03:00",
          "cost": {
            "amount": "272.0",
            "currency": "RUB"
          },
          "coupon": {
            "is_for_support": false,
            "is_netting_allowed": false,
            "value": {
              "amount": "100.0000",
              "currency": "RUB"
            }
          },
          "donate_multiplier": "1.0600",
          "due": "2020-12-22T11:52:00+03:00",
          "fine_code": "some_fine_code",
          "fleet_subscription_level": "level3",
          "has_co_branding": false,
          "has_lightbox": false,
          "has_sticker": false,
          "id": "28e560e5a7c26a6bbc3ba9b73ab9657a",
          "ind_bel_nds_rate": "1.2",
          "is_cargo": true,
          "is_mqc": false,
          "need_dispatcher_acceptance": false,
          "oebs_mvp_id": "MSKc",
          "park_brandings": [],
          "park_ride_sum": "100",
          "payment_type": "card",
          "status": "finished",
          "subvention_geoareas": [
            "area51"
          ],
          "tariff_class": "econom",
          "tariff_minimal_cost": "100",
          "taxi_status": "complete",
          "time_zone": "Europe/Moscow",
          "transporting_distance_meters": 10,
          "transporting_time_seconds": 32,
          "zone_name": "moscow"
        },
        "version": 1
      },
      "entry_ids": [],
      "event_at": {
        "$datetime": "1991-06-18T07:15:00+03:00"
      },
      "external_ref": "1",
      "id": 100,
      "kind": "taxi_order",
      "process_at": {
        "$datetime": "1991-06-18T07:15:00+03:00"
      },
      "revision": 1,
      "status": "compensate_coupon",
      "topic": "taxi/alias_id/902fe475af72677caea7b8f49db06905"
    }
  }
}
