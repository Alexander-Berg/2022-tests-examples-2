{
  "expected_query": {
    "$Query": {
      "calculate_expired_rate_from_status": false,
      "categories_ignoring_drivershift": [],
      "categories_ignoring_promocode": [],
      "commission_limit_if_promocode": {
        "$decimal": "1"
      },
      "contracts": [
        {
          "$Contract": {
            "currency": "RUB",
            "id": 1
          }
        }
      ],
      "doc_id": 100,
      "driver": {
        "$Driver": {
          "hiring_info": {
            "$HiringInfo": {
              "hired_at": {
                "$datetime": "2020-12-22T08:48:39.046000"
              },
              "hiring_type": "commercial"
            }
          },
          "mode": {
            "$driver_mode": "orders"
          },
          "tags": [
            "some_tag"
          ]
        }
      },
      "is_testing_migration_mode": false,
      "order": {
        "$Order": {
          "alias_id": "902fe475af72677caea7b8f49db06905",
          "call_center": null,
          "cancel_distance": null,
          "cancelled_at": null,
          "cancelled_with_captcha": false,
          "cost": {
            "$decimal": "272.0"
          },
          "cost_for_driver": null,
          "currency": "RUB",
          "discount": null,
          "driver_promocode": null,
          "due": {
            "$datetime": "2020-12-22T08:52:00+00:00"
          },
          "fine_code": "some_fine_code",
          "fleet_subscription_level": "level3",
          "ind_bel_vat_rate": {
            "$decimal": "1.2"
          },
          "is_cargo": false,
          "is_mqc": false,
          "marketing_level": {
            "$frozenset": []
          },
          "need_dispatcher_acceptance": false,
          "park_corp_vat": null,
          "park_ride_sum": {
            "$decimal": "100"
          },
          "payment_type": {
            "$payment_type": "card"
          },
          "rebate_rate": {
            "$decimal": "1.4"
          },
          "source": null,
          "status": "finished",
          "tariff_class": "econom",
          "tariff_minimal_cost": {
            "$decimal": "100"
          },
          "tariff_zone": "moscow",
          "taxi_status": "complete",
          "time_zone": "Europe/Moscow",
          "with_driver_workshift": false
        }
      },
      "order_park_commission_rule": {
        "$ParkCommissionRule": {
          "amount_fixed": null,
          "amount_rate": "0.0265",
          "is_commission_if_platform_commission_is_null_enabled": null,
          "is_platfrom_commission_enabled": null,
          "kind": "order",
          "rule_type_id": null,
          "work_rule_id": "e26a3cf21acfe01198d50030487e046b"
        }
      },
      "service_to_contract": {
        "$int_key_mapping": {
          "111": 1,
          "128": 1,
          "137": 1
        }
      },
      "should_calc_gaap_commission": false,
      "use_call_center_cost": false,
      "use_minimal_tariff_cost": false
    }
  },
  "results": {
    "$Commission": {
      "branding_discount": {
        "$Component": {
          "value": {
            "$decimal": "0"
          },
          "vat": {
            "$decimal": "0"
          }
        }
      },
      "cost": null,
      "gross": {
        "$Component": {
          "value": {
            "$decimal": "0"
          },
          "vat": {
            "$decimal": "0"
          }
        }
      },
      "is_rebate_applied": false,
      "promocode_discount": {
        "$Component": {
          "value": {
            "$decimal": "0"
          },
          "vat": {
            "$decimal": "0"
          }
        }
      },
      "rate": null,
      "unrealized": {
        "$Component": {
          "value": {
            "$decimal": "0"
          },
          "vat": {
            "$decimal": "0"
          }
        }
      },
      "unrealized_without_discount_value": {
        "$decimal": "0"
      },
      "value": {
        "$var": {
          "mutations": [
            {
              "args": "set 0 = 0",
              "details": {
                "payment_type": "cash"
              },
              "reason": "set_from_payment_type"
            }
          ],
          "value": "0"
        }
      },
      "vat": {
        "$var": {
          "mutations": [
            {
              "args": "set 0 = 0",
              "details": {
                "payment_type": "cash"
              },
              "reason": "set_from_payment_type"
            }
          ],
          "value": "0"
        }
      },
      "vat_rate": {
        "$var": {
          "mutations": [
            {
              "args": "set 1 = 1",
              "reason": "set_from_payment_type"
            }
          ],
          "value": "1"
        }
      }
    }
  },
  "taxi_order": {
    "$Doc": {
      "data": {
        "contracts": {
          "actual_ts": "2020-12-30T03:00:00+03:00",
          "items": [
            {
              "currency": "RUB",
              "id": 1
            }
          ],
          "service_to_contract": {
            "111": 1,
            "128": 1,
            "137": 1
          }
        },
        "driver": {
          "activity_points": 50,
          "billing_client_id": "100500",
          "clid": "643753730233",
          "driver_license_personal_id": "some_driver_license_personal_id",
          "driver_profile_id": "some_driver_profile_id",
          "geo_hierarchy": "russia/moscow",
          "hired_at": "2020-12-22T11:48:39.046000+03:00",
          "hiring_type": "commercial",
          "park_id": "some_park_id",
          "tags": [
            "some_tag"
          ],
          "unique_driver_id": "5b05621ee6c22ea2654849f4",
          "zone_name": "tula"
        },
        "driver_mode": {
          "mode": "orders"
        },
        "order_info": {
          "accepted_by_driver_at": "2020-12-22T11:48:39.046000+03:00",
          "alias_id": "902fe475af72677caea7b8f49db06905",
          "billing_at": "2020-12-22T11:48:39.046000+03:00",
          "cancelled_with_captcha": false,
          "city_id": "Москва",
          "closed_without_accept": false,
          "completed_at": "2020-12-22T11:48:39.046000+03:00",
          "cost": {
            "amount": "272.0",
            "currency": "RUB"
          },
          "donate_multiplier": "1.06",
          "due": "2020-12-22T11:52:00+03:00",
          "fine_code": "some_fine_code",
          "fleet_subscription_level": "level3",
          "has_co_branding": false,
          "has_lightbox": false,
          "has_sticker": false,
          "id": "28e560e5a7c26a6bbc3ba9b73ab9657a",
          "ind_bel_nds_rate": "1.2",
          "is_mqc": false,
          "need_dispatcher_acceptance": false,
          "oebs_mvp_id": "MSKc",
          "park_brandings": [],
          "park_ride_sum": "100",
          "payment_type": "card",
          "rebate_rate": "1.42",
          "status": "finished",
          "subvention_geoareas": [
            "area51"
          ],
          "tariff_class": "econom",
          "tariff_minimal_cost": "100",
          "taxi_status": "complete",
          "time_zone": "Europe/Moscow",
          "transporting_distance_meters": 10,
          "transporting_time_seconds": 32,
          "zone_name": "moscow"
        },
        "park_commission_rules": {
          "rules": [
            {
              "amount_rate": "0.0265",
              "kind": "order",
              "work_rule_id": "e26a3cf21acfe01198d50030487e046b"
            }
          ]
        },
        "rebate_rule": {
          "rate": "1.4"
        },
        "subventions": {
          "is_eligible": true,
          "payment": {
            "commission": {
              "amount": "11.04000",
              "contract_amount": "1.32",
              "invoice_date": "2021-06-10T20:00:00+03:00"
            },
            "contract_currency": "USD",
            "contract_id": 1,
            "currency_rate": "0.10000",
            "donate_multiplier": "1.2",
            "is_payable": true,
            "items": [
              {
                "amount": "40",
                "contract_amount": "4.80",
                "invoice_date": "2021-06-10T20:00:00+03:00",
                "kind": "mfg",
                "limit_ref": "<budget_id>",
                "rule_db_id": "<rule_id>"
              }
            ],
            "order_cost_for_subvention": "60",
            "service_id": 137
          }
        },
        "version": 1
      },
      "entry_ids": [],
      "event_at": {
        "$datetime": "1991-06-18T07:15:00+03:00"
      },
      "external_ref": "1",
      "id": 100,
      "kind": "taxi_order",
      "process_at": {
        "$datetime": "1991-06-18T07:15:00+03:00"
      },
      "revision": 1,
      "status": "fetch_rebate_rule",
      "topic": "taxi/alias_id/902fe475af72677caea7b8f49db06905"
    }
  }
}
