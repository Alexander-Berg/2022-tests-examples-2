{
  "invalid": {
    "existing_name": [
      {
        "request": {
          "check_conditions": [],
          "cost": {
            "__default__": 0.0,
            "conditions": [],
            "field": {
              "name": "pay_amount",
              "source": "event"
            }
          },
          "description": "Выплата",
          "is_active": true,
          "main_conditions": [
            {
              "field": {
                "name": "is_paid",
                "source": "event"
              },
              "name": "is_paid",
              "operator": "$eq",
              "type": "simple",
              "value": true
            }
          ],
          "name": "payday",
          "started_at": "1970-02-01T03:00:00+03:00",
          "type": "subtract"
        },
        "response": {
          "body": {
            "tariffs": [
              {
                "check_conditions": [],
                "cost": {
                  "__default__": 0.0,
                  "conditions": [],
                  "field": {
                    "name": "pay_amount",
                    "source": "event"
                  }
                },
                "description": "Выплата",
                "expires_at": "3000-01-01T03:00:00+03:00",
                "is_active": true,
                "main_conditions": [
                  {
                    "field": {
                      "name": "is_paid",
                      "source": "event"
                    },
                    "name": "is_paid",
                    "operator": "$eq",
                    "type": "simple",
                    "value": true
                  }
                ],
                "name": "payday",
                "revision": 1,
                "started_at": "1970-02-01T03:00:00+03:00",
                "type": "subtract"
              }
            ]
          },
          "status_code": 200
        }
      },
      {
        "request": {
          "check_conditions": [],
          "cost": {
            "__default__": 0.0,
            "conditions": [],
            "field": {
              "name": "pay_amount",
              "source": "event"
            }
          },
          "description": "Выплата",
          "is_active": true,
          "main_conditions": [
            {
              "field": {
                "name": "is_paid",
                "source": "event"
              },
              "name": "is_paid",
              "operator": "$eq",
              "type": "simple",
              "value": true
            }
          ],
          "name": "payday",
          "type": "subtract"
        },
        "response": {
          "body": {
            "code": "TARIFF_NAME_EXISTS",
            "message": "Tariff with name payday already exists"
          },
          "status_code": 400
        }
      }
    ],
    "invalid_formats": [
      {
        "request": {
          "check_conditions": [],
          "cost": [],
          "description": "",
          "is_active": 0,
          "main_conditions": [],
          "name": "",
          "type": ""
        },
        "response": {
          "body": {},
          "status_code": 400
        }
      }
    ]
  },
  "valid": {
    "valid": [
      {
        "request": {
          "check_conditions": [
            {
              "condition": {
                "field": {
                  "name": "city",
                  "source": "lead"
                },
                "name": "proper_city",
                "operator": "$in",
                "type": "simple",
                "value": [
                  "Москва",
                  "Санкт-Петербург",
                  "Казань",
                  "Калуга",
                  "Осло"
                ]
              },
              "false_description": "Водитель совершил 5 поездок в запрещённом городе"
            },
            {
              "condition": {
                "calculation": {
                  "fields": [
                    {
                      "name": "created_dttm",
                      "source": "lead"
                    },
                    {
                      "name": "date_active_5",
                      "source": "event"
                    }
                  ],
                  "operator": "$date_diff_days"
                },
                "name": "young_enough_active",
                "operator": "$lt",
                "type": "pre_calculate",
                "value": 30
              },
              "false_description": "С момента создания тикета прошло более 30 дней"
            }
          ],
          "cost": {
            "__default__": 900.0,
            "conditions": [
              {
                "conditions": [
                  {
                    "field": {
                      "name": "city",
                      "source": "lead"
                    },
                    "name": "big_cities",
                    "operator": "$in",
                    "type": "simple",
                    "value": [
                      "Москва",
                      "Санкт-Петербург"
                    ]
                  }
                ],
                "total": 1000.0
              },
              {
                "conditions": [
                  {
                    "field": {
                      "name": "city",
                      "source": "lead"
                    },
                    "name": "small_cities",
                    "operator": "$in",
                    "type": "simple",
                    "value": [
                      "Казань",
                      "Калуга"
                    ]
                  }
                ],
                "total": 800.0
              }
            ]
          },
          "description": "Водитель совершил 5 поездок",
          "is_active": true,
          "main_conditions": [
            {
              "field": {
                "name": "type_of_employment_form_tag",
                "source": "lead"
              },
              "name": "proper_employment_type",
              "operator": "$in",
              "type": "simple",
              "value": [
                "unknown",
                "driver"
              ]
            },
            {
              "field": {
                "name": "status",
                "source": "event"
              },
              "name": "proper_status",
              "operator": "$eq",
              "type": "simple",
              "value": "актив_5"
            },
            {
              "field": {
                "name": "check_not_equal",
                "source": "event"
              },
              "name": "check_not_equal",
              "operator": "$neq",
              "type": "simple",
              "value": "not_equal"
            },
            {
              "field": {
                "name": "check_not_in",
                "source": "event"
              },
              "name": "check_not_in",
              "operator": "$nin",
              "type": "simple",
              "value": [
                "not_in"
              ]
            },
            {
              "field": {
                "name": "check_event_num",
                "source": "event"
              },
              "name": "check_less_than",
              "operator": "$lt",
              "type": "simple",
              "value": 334
            },
            {
              "field": {
                "name": "check_lead_num",
                "source": "lead"
              },
              "name": "check_less_than_or_equal",
              "operator": "$lte",
              "type": "simple",
              "value": 444
            },
            {
              "field": {
                "name": "check_event_num",
                "source": "event"
              },
              "name": "check_greater_than",
              "operator": "$gt",
              "type": "simple",
              "value": 332
            },
            {
              "field": {
                "name": "check_lead_num",
                "source": "lead"
              },
              "name": "check_greater_than_or_equal",
              "operator": "$gte",
              "type": "simple",
              "value": 444
            },
            {
              "field": {
                "name": "check_contains",
                "source": "lead"
              },
              "name": "check_contains",
              "operator": "$contains",
              "type": "simple",
              "value": "contains"
            },
            {
              "field": {
                "name": "check_contains",
                "source": "lead"
              },
              "name": "check_does_not_contain",
              "operator": "$does_not_contain",
              "type": "simple",
              "value": "does_not_contain"
            }
          ],
          "name": "active_5",
          "started_at": "1970-02-01T00:00:00",
          "type": "add"
        },
        "response": {
          "body": {
            "tariffs": [
              {
                "check_conditions": [
                  {
                    "condition": {
                      "field": {
                        "name": "city",
                        "source": "lead"
                      },
                      "name": "proper_city",
                      "operator": "$in",
                      "type": "simple",
                      "value": [
                        "Москва",
                        "Санкт-Петербург",
                        "Казань",
                        "Калуга",
                        "Осло"
                      ]
                    },
                    "false_description": "Водитель совершил 5 поездок в запрещённом городе"
                  },
                  {
                    "condition": {
                      "calculation": {
                        "fields": [
                          {
                            "name": "created_dttm",
                            "source": "lead"
                          },
                          {
                            "name": "date_active_5",
                            "source": "event"
                          }
                        ],
                        "operator": "$date_diff_days"
                      },
                      "name": "young_enough_active",
                      "operator": "$lt",
                      "type": "pre_calculate",
                      "value": 30
                    },
                    "false_description": "С момента создания тикета прошло более 30 дней"
                  }
                ],
                "cost": {
                  "__default__": 900.0,
                  "conditions": [
                    {
                      "conditions": [
                        {
                          "field": {
                            "name": "city",
                            "source": "lead"
                          },
                          "name": "big_cities",
                          "operator": "$in",
                          "type": "simple",
                          "value": [
                            "Москва",
                            "Санкт-Петербург"
                          ]
                        }
                      ],
                      "total": 1000.0
                    },
                    {
                      "conditions": [
                        {
                          "field": {
                            "name": "city",
                            "source": "lead"
                          },
                          "name": "small_cities",
                          "operator": "$in",
                          "type": "simple",
                          "value": [
                            "Казань",
                            "Калуга"
                          ]
                        }
                      ],
                      "total": 800.0
                    }
                  ]
                },
                "description": "Водитель совершил 5 поездок",
                "expires_at": "3000-01-01T03:00:00+03:00",
                "is_active": true,
                "main_conditions": [
                  {
                    "field": {
                      "name": "type_of_employment_form_tag",
                      "source": "lead"
                    },
                    "name": "proper_employment_type",
                    "operator": "$in",
                    "type": "simple",
                    "value": [
                      "unknown",
                      "driver"
                    ]
                  },
                  {
                    "field": {
                      "name": "status",
                      "source": "event"
                    },
                    "name": "proper_status",
                    "operator": "$eq",
                    "type": "simple",
                    "value": "актив_5"
                  },
                  {
                    "field": {
                      "name": "check_not_equal",
                      "source": "event"
                    },
                    "name": "check_not_equal",
                    "operator": "$neq",
                    "type": "simple",
                    "value": "not_equal"
                  },
                  {
                    "field": {
                      "name": "check_not_in",
                      "source": "event"
                    },
                    "name": "check_not_in",
                    "operator": "$nin",
                    "type": "simple",
                    "value": [
                      "not_in"
                    ]
                  },
                  {
                    "field": {
                      "name": "check_event_num",
                      "source": "event"
                    },
                    "name": "check_less_than",
                    "operator": "$lt",
                    "type": "simple",
                    "value": 334
                  },
                  {
                    "field": {
                      "name": "check_lead_num",
                      "source": "lead"
                    },
                    "name": "check_less_than_or_equal",
                    "operator": "$lte",
                    "type": "simple",
                    "value": 444
                  },
                  {
                    "field": {
                      "name": "check_event_num",
                      "source": "event"
                    },
                    "name": "check_greater_than",
                    "operator": "$gt",
                    "type": "simple",
                    "value": 332
                  },
                  {
                    "field": {
                      "name": "check_lead_num",
                      "source": "lead"
                    },
                    "name": "check_greater_than_or_equal",
                    "operator": "$gte",
                    "type": "simple",
                    "value": 444
                  },
                  {
                    "field": {
                      "name": "check_contains",
                      "source": "lead"
                    },
                    "name": "check_contains",
                    "operator": "$contains",
                    "type": "simple",
                    "value": "contains"
                  },
                  {
                    "field": {
                      "name": "check_contains",
                      "source": "lead"
                    },
                    "name": "check_does_not_contain",
                    "operator": "$does_not_contain",
                    "type": "simple",
                    "value": "does_not_contain"
                  }
                ],
                "name": "active_5",
                "revision": 1,
                "started_at": "1970-02-01T03:00:00+03:00",
                "type": "add"
              }
            ]
          },
          "status_code": 200
        }
      },
      {
        "request": {
          "check_conditions": [
            {
              "condition": {
                "field": {
                  "name": "city",
                  "source": "lead"
                },
                "name": "proper_city",
                "operator": "$in",
                "type": "simple",
                "value": [
                  "Москва",
                  "Санкт-Петербург",
                  "Казань",
                  "Калуга",
                  "Осло"
                ]
              },
              "false_description": "Водитель совершил 10 поездок в запрещённом городе"
            },
            {
              "condition": {
                "calculation": {
                  "fields": [
                    {
                      "name": "created_dttm",
                      "source": "lead"
                    },
                    {
                      "name": "date_active_10",
                      "source": "event"
                    }
                  ],
                  "operator": "$date_diff_days"
                },
                "name": "young_enough_active",
                "operator": "$lt",
                "type": "pre_calculate",
                "value": 30
              },
              "false_description": "С момента создания тикета прошло более 30 дней"
            }
          ],
          "cost": {
            "__default__": 1900.0,
            "conditions": [
              {
                "conditions": [
                  {
                    "field": {
                      "name": "city",
                      "source": "lead"
                    },
                    "name": "big_cities",
                    "operator": "$in",
                    "type": "simple",
                    "value": [
                      "Москва",
                      "Санкт-Петербург"
                    ]
                  }
                ],
                "total": 2000.0
              },
              {
                "conditions": [
                  {
                    "field": {
                      "name": "city",
                      "source": "lead"
                    },
                    "name": "small_cities",
                    "operator": "$in",
                    "type": "simple",
                    "value": [
                      "Казань",
                      "Калуга"
                    ]
                  }
                ],
                "total": 1800.0
              }
            ]
          },
          "description": "Водитель совершил 10 поездок",
          "is_active": true,
          "main_conditions": [
            {
              "field": {
                "name": "type_of_employment_form_tag",
                "source": "lead"
              },
              "name": "proper_employment_type",
              "operator": "$in",
              "type": "simple",
              "value": [
                "unknown",
                "driver"
              ]
            },
            {
              "field": {
                "name": "status",
                "source": "event"
              },
              "name": "proper_status",
              "operator": "$eq",
              "type": "simple",
              "value": "актив_10"
            }
          ],
          "name": "active_10",
          "type": "add"
        },
        "response": {
          "body": {
            "tariffs": [
              {
                "check_conditions": [
                  {
                    "condition": {
                      "field": {
                        "name": "city",
                        "source": "lead"
                      },
                      "name": "proper_city",
                      "operator": "$in",
                      "type": "simple",
                      "value": [
                        "Москва",
                        "Санкт-Петербург",
                        "Казань",
                        "Калуга",
                        "Осло"
                      ]
                    },
                    "false_description": "Водитель совершил 10 поездок в запрещённом городе"
                  },
                  {
                    "condition": {
                      "calculation": {
                        "fields": [
                          {
                            "name": "created_dttm",
                            "source": "lead"
                          },
                          {
                            "name": "date_active_10",
                            "source": "event"
                          }
                        ],
                        "operator": "$date_diff_days"
                      },
                      "name": "young_enough_active",
                      "operator": "$lt",
                      "type": "pre_calculate",
                      "value": 30
                    },
                    "false_description": "С момента создания тикета прошло более 30 дней"
                  }
                ],
                "cost": {
                  "__default__": 1900.0,
                  "conditions": [
                    {
                      "conditions": [
                        {
                          "field": {
                            "name": "city",
                            "source": "lead"
                          },
                          "name": "big_cities",
                          "operator": "$in",
                          "type": "simple",
                          "value": [
                            "Москва",
                            "Санкт-Петербург"
                          ]
                        }
                      ],
                      "total": 2000.0
                    },
                    {
                      "conditions": [
                        {
                          "field": {
                            "name": "city",
                            "source": "lead"
                          },
                          "name": "small_cities",
                          "operator": "$in",
                          "type": "simple",
                          "value": [
                            "Казань",
                            "Калуга"
                          ]
                        }
                      ],
                      "total": 1800.0
                    }
                  ]
                },
                "description": "Водитель совершил 10 поездок",
                "expires_at": "3000-01-01T03:00:00+03:00",
                "is_active": true,
                "main_conditions": [
                  {
                    "field": {
                      "name": "type_of_employment_form_tag",
                      "source": "lead"
                    },
                    "name": "proper_employment_type",
                    "operator": "$in",
                    "type": "simple",
                    "value": [
                      "unknown",
                      "driver"
                    ]
                  },
                  {
                    "field": {
                      "name": "status",
                      "source": "event"
                    },
                    "name": "proper_status",
                    "operator": "$eq",
                    "type": "simple",
                    "value": "актив_10"
                  }
                ],
                "name": "active_10",
                "revision": 1,
                "started_at": "1970-01-01T03:00:00+03:00",
                "type": "add"
              }
            ]
          },
          "status_code": 200
        }
      },
      {
        "request": {
          "check_conditions": [],
          "cost": {
            "__default__": 0.0,
            "conditions": []
          },
          "description": "Водитель в чёрном списке",
          "is_active": true,
          "main_conditions": [
            {
              "field": {
                "name": "is_blacklisted",
                "source": "event"
              },
              "name": "is_blacklisted",
              "operator": "$eq",
              "type": "simple",
              "value": true
            }
          ],
          "name": "blacklisted",
          "type": "nullify_costs"
        },
        "response": {
          "body": {
            "tariffs": [
              {
                "check_conditions": [],
                "cost": {
                  "__default__": 0.0,
                  "conditions": []
                },
                "description": "Водитель в чёрном списке",
                "expires_at": "3000-01-01T03:00:00+03:00",
                "is_active": true,
                "main_conditions": [
                  {
                    "field": {
                      "name": "is_blacklisted",
                      "source": "event"
                    },
                    "name": "is_blacklisted",
                    "operator": "$eq",
                    "type": "simple",
                    "value": true
                  }
                ],
                "name": "blacklisted",
                "revision": 1,
                "started_at": "1970-01-01T03:00:00+03:00",
                "type": "nullify_costs"
              }
            ]
          },
          "status_code": 200
        }
      },
      {
        "request": {
          "check_conditions": [],
          "cost": {
            "__default__": 0.0,
            "conditions": [],
            "field": {
              "name": "pay_amount",
              "source": "event"
            }
          },
          "description": "Выплата",
          "is_active": true,
          "main_conditions": [
            {
              "field": {
                "name": "is_paid",
                "source": "event"
              },
              "name": "is_paid",
              "operator": "$eq",
              "type": "simple",
              "value": true
            }
          ],
          "name": "payday",
          "type": "subtract"
        },
        "response": {
          "body": {
            "tariffs": [
              {
                "check_conditions": [],
                "cost": {
                  "__default__": 0.0,
                  "conditions": [],
                  "field": {
                    "name": "pay_amount",
                    "source": "event"
                  }
                },
                "description": "Выплата",
                "expires_at": "3000-01-01T03:00:00+03:00",
                "is_active": true,
                "main_conditions": [
                  {
                    "field": {
                      "name": "is_paid",
                      "source": "event"
                    },
                    "name": "is_paid",
                    "operator": "$eq",
                    "type": "simple",
                    "value": true
                  }
                ],
                "name": "payday",
                "revision": 1,
                "started_at": "1970-01-01T03:00:00+03:00",
                "type": "subtract"
              }
            ]
          },
          "status_code": 200
        }
      }
    ]
  }
}
