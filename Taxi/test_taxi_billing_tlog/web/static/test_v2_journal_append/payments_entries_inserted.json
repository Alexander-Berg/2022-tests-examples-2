{
  "expected_response": {
    "data": {
      "entries": [
        {
          "id": 1,
          "partition": "2019-07-17",
          "payload": {
            "amount": "100",
            "client_id": "28",
            "currency": "RUB",
            "detailed_product": "trip_payment",
            "due": "2019-03-28T01:02:02+03:00",
            "event_time": "2019-03-28T01:02:02+03:00",
            "invoice_date": "2019-03-27T02:02:02+03:00",
            "oebs_mvp_id": "MSKc",
            "payload": {
              "alias_id": "496",
              "base_doc_id": 8128,
              "external_payment_id": "33550336",
              "order_id": "42",
              "terminal_id": 8589869056
            },
            "product": "trip_payment",
            "service_id": 124,
            "tariff_class": "econom",
            "transaction_type": "refund"
          },
          "service_transaction_id": "2",
          "topic": "payments",
          "transaction_time": "2019-07-17T12:00:00+03:00"
        },
        {
          "id": 2,
          "partition": "2019-07-17",
          "payload": {
            "amount": "10",
            "client_id": "28",
            "contract_id": "123456",
            "currency": "RUB",
            "detailed_product": "trip_payment",
            "due": "2019-03-28T01:02:02+03:00",
            "event_time": "2019-03-28T01:02:02+03:00",
            "invoice_date": "2019-03-27T02:02:02+03:00",
            "oebs_mvp_id": "MSKc",
            "payload": {
              "alias_id": "496",
              "amount_details": {
                "base_amount": "400",
                "base_currency": "RUB",
                "contract_currency_rate": "0.5"
              },
              "base_doc_id": 8128,
              "contract_details": {
                "agent_percent": "0.1",
                "currency": "USD",
                "firm_id": 100500,
                "region_id": 236
              },
              "country": "rus",
              "external_payment_id": "33550336",
              "order_id": "42",
              "terminal_id": 8589869056,
              "yandex_reward_amt": "12.2",
              "yandex_reward_product": "product"
            },
            "product": "trip_payment",
            "service_id": 124,
            "tariff_class": "econom",
            "transaction_type": "refund"
          },
          "service_transaction_id": "3",
          "topic": "payments",
          "transaction_time": "2019-07-17T12:00:00+03:00"
        },
        {
          "id": 3,
          "partition": "2019-07-17",
          "payload": {
            "amount": "200.00",
            "client_id": "112691938",
            "contract_id": "3182601",
            "currency": "RUB",
            "detailed_product": "payment_on_delivery_b2b_logistics",
            "due": "2021-03-10T12:48:57+03:00",
            "event_time": "2021-04-05T22:24:00+03:00",
            "invoice_date": "2021-03-10T12:48:57+03:00",
            "payload": {
              "agent_id": "agent_strizh",
              "base_doc_id": 8128,
              "operation_id": "0330eb9f-d704-42c5-adad-74f924b5466b",
              "terminal_id": 0
            },
            "product": "payment_on_delivery_b2b_logistics",
            "service_id": 1040,
            "tariff_class": "ndd",
            "transaction_type": "payment"
          },
          "service_transaction_id": "15",
          "topic": "payments",
          "transaction_time": "2019-07-17T12:00:00+03:00"
        },
        {
          "id": 4,
          "partition": "2019-07-17",
          "payload": {
            "amount": "10",
            "client_id": "28",
            "contract_id": "123456",
            "currency": "RUB",
            "detailed_product": "trip_payment",
            "due": "2021-05-28T01:02:02+03:00",
            "event_time": "2021-05-28T01:02:02+03:00",
            "invoice_date": "2021-05-27T02:02:02+03:00",
            "oebs_mvp_id": "MSKc",
            "payload": {
              "alias_id": "496",
              "amount_details": {
                "base_amount": "400",
                "base_currency": "RUB",
                "contract_currency_rate": "0.5"
              },
              "base_doc_id": 8128,
              "contract_details": {
                "agent_percent": "0.1",
                "currency": "USD",
                "firm_id": 100500,
                "region_id": 236
              },
              "country": "rus",
              "driver_details": {
                "db_id": "<db_id>",
                "uuid": "<uuid>"
              },
              "external_payment_id": "33550336",
              "order_id": "42",
              "terminal_id": 8589869056,
              "yandex_reward_amt": "12.2",
              "yandex_reward_product": "product"
            },
            "product": "trip_payment",
            "service_id": 124,
            "tariff_class": "econom",
            "transaction_type": "refund"
          },
          "service_transaction_id": "16",
          "topic": "payments",
          "transaction_time": "2019-07-17T12:00:00+03:00"
        },
        {
          "id": 5,
          "partition": "2019-07-17",
          "payload": {
            "amount": "100",
            "client_id": "28",
            "currency": "RUB",
            "detailed_product": "b2b_tanker_payment",
            "event_time": "2019-03-28T01:02:02+03:00",
            "ignore_in_balance": true,
            "invoice_date": "2019-03-27T02:02:02+03:00",
            "payload": {
              "alias_id": "496",
              "base_doc_id": 8128
            },
            "product": "b2b_tanker_payment",
            "service_id": 636,
            "transaction_type": "payment"
          },
          "service_transaction_id": "70",
          "topic": "payments",
          "transaction_time": "2019-07-17T12:00:00+03:00"
        },
        {
          "id": 6,
          "partition": "2019-07-17",
          "payload": {
            "amount": "108",
            "client_id": "28",
            "currency": "RUB",
            "detailed_product": "b2b_tanker_payment",
            "event_time": "2019-03-28T01:02:02+03:00",
            "external_ref": "alias_id/987",
            "invoice_date": "2019-03-27T02:02:02+03:00",
            "payload": {
              "alias_id": "987",
              "base_doc_id": 231
            },
            "product": "b2b_tanker_payment",
            "service_id": 636,
            "target": "fin-payouts/oebs",
            "transaction_type": "payment"
          },
          "service_transaction_id": "71",
          "topic": "payments",
          "transaction_time": "2019-07-17T12:00:00+03:00"
        }
      ]
    },
    "status": 200
  },
  "expected_rows": [
    {
      "$tuple": [
        1,
        "2",
        {
          "columns": {
            "amount": "100",
            "client_id": "28",
            "currency": "RUB",
            "detailed_product": "trip_payment",
            "due": "2019-03-28T01:02:02+03:00",
            "event_time": "2019-03-28T01:02:02+03:00",
            "invoice_date": "2019-03-27T02:02:02+03:00",
            "oebs_mvp_id": "MSKc",
            "payload": {
              "alias_id": "496",
              "base_doc_id": 8128,
              "external_payment_id": "33550336",
              "order_id": "42",
              "terminal_id": 8589869056
            },
            "product": "trip_payment",
            "service_id": 124,
            "tariff_class": "econom",
            "transaction_type": "refund"
          },
          "created": "2019-07-17T09:00:00.000000+00:00"
        }
      ]
    },
    {
      "$tuple": [
        2,
        "3",
        {
          "columns": {
            "amount": "10",
            "client_id": "28",
            "contract_id": "123456",
            "currency": "RUB",
            "detailed_product": "trip_payment",
            "due": "2019-03-28T01:02:02+03:00",
            "event_time": "2019-03-28T01:02:02+03:00",
            "invoice_date": "2019-03-27T02:02:02+03:00",
            "oebs_mvp_id": "MSKc",
            "payload": {
              "alias_id": "496",
              "amount_details": {
                "base_amount": "400",
                "base_currency": "RUB",
                "contract_currency_rate": "0.5"
              },
              "base_doc_id": 8128,
              "contract_details": {
                "agent_percent": "0.1",
                "currency": "USD",
                "firm_id": 100500,
                "region_id": 236
              },
              "country": "rus",
              "external_payment_id": "33550336",
              "order_id": "42",
              "terminal_id": 8589869056,
              "yandex_reward_amt": "12.2",
              "yandex_reward_product": "product"
            },
            "product": "trip_payment",
            "service_id": 124,
            "tariff_class": "econom",
            "transaction_type": "refund"
          },
          "created": "2019-07-17T09:00:00.000000+00:00"
        }
      ]
    },
    {
      "$tuple": [
        3,
        "15",
        {
          "columns": {
            "amount": "200.00",
            "client_id": "112691938",
            "contract_id": "3182601",
            "currency": "RUB",
            "detailed_product": "payment_on_delivery_b2b_logistics",
            "due": "2021-03-10T12:48:57+03:00",
            "event_time": "2021-04-05T22:24:00+03:00",
            "invoice_date": "2021-03-10T12:48:57+03:00",
            "payload": {
              "agent_id": "agent_strizh",
              "base_doc_id": 8128,
              "operation_id": "0330eb9f-d704-42c5-adad-74f924b5466b",
              "terminal_id": 0
            },
            "product": "payment_on_delivery_b2b_logistics",
            "service_id": 1040,
            "tariff_class": "ndd",
            "transaction_type": "payment"
          },
          "created": "2019-07-17T09:00:00.000000+00:00"
        }
      ]
    },
    {
      "$tuple": [
        4,
        "16",
        {
          "columns": {
            "amount": "10",
            "client_id": "28",
            "contract_id": "123456",
            "currency": "RUB",
            "detailed_product": "trip_payment",
            "due": "2021-05-28T01:02:02+03:00",
            "event_time": "2021-05-28T01:02:02+03:00",
            "invoice_date": "2021-05-27T02:02:02+03:00",
            "oebs_mvp_id": "MSKc",
            "payload": {
              "alias_id": "496",
              "amount_details": {
                "base_amount": "400",
                "base_currency": "RUB",
                "contract_currency_rate": "0.5"
              },
              "base_doc_id": 8128,
              "contract_details": {
                "agent_percent": "0.1",
                "currency": "USD",
                "firm_id": 100500,
                "region_id": 236
              },
              "country": "rus",
              "driver_details": {
                "db_id": "<db_id>",
                "uuid": "<uuid>"
              },
              "external_payment_id": "33550336",
              "order_id": "42",
              "terminal_id": 8589869056,
              "yandex_reward_amt": "12.2",
              "yandex_reward_product": "product"
            },
            "product": "trip_payment",
            "service_id": 124,
            "tariff_class": "econom",
            "transaction_type": "refund"
          },
          "created": "2019-07-17T09:00:00.000000+00:00"
        }
      ]
    },
    {
      "$tuple": [
        5,
        "70",
        {
          "columns": {
            "amount": "100",
            "client_id": "28",
            "currency": "RUB",
            "detailed_product": "b2b_tanker_payment",
            "event_time": "2019-03-28T01:02:02+03:00",
            "ignore_in_balance": true,
            "invoice_date": "2019-03-27T02:02:02+03:00",
            "payload": {
              "alias_id": "496",
              "base_doc_id": 8128
            },
            "product": "b2b_tanker_payment",
            "service_id": 636,
            "transaction_type": "payment"
          },
          "created": "2019-07-17T09:00:00.000000+00:00"
        }
      ]
    },
    {
      "$tuple": [
        6,
        "71",
        {
          "columns": {
            "amount": "108",
            "client_id": "28",
            "currency": "RUB",
            "detailed_product": "b2b_tanker_payment",
            "event_time": "2019-03-28T01:02:02+03:00",
            "external_ref": "alias_id/987",
            "invoice_date": "2019-03-27T02:02:02+03:00",
            "payload": {
              "alias_id": "987",
              "base_doc_id": 231
            },
            "product": "b2b_tanker_payment",
            "service_id": 636,
            "target": "fin-payouts/oebs",
            "transaction_type": "payment"
          },
          "created": "2019-07-17T09:00:00.000000+00:00"
        }
      ]
    }
  ],
  "expected_table": "topic_payments",
  "request": {
    "entries": [
      {
        "amount": "100",
        "client_id": "28",
        "currency": "RUB",
        "detailed_product": "trip_payment",
        "due": "2019-03-27T22:02:02.000000+00:00",
        "event_time": "2019-03-27T22:02:02.000000+00:00",
        "invoice_date": "2019-03-26T23:02:02.000000+00:00",
        "oebs_mvp_id": "MSKc",
        "payload": {
          "alias_id": "496",
          "base_doc_id": 8128,
          "external_payment_id": "33550336",
          "order_id": "42",
          "terminal_id": 8589869056
        },
        "product": "trip_payment",
        "service_id": 124,
        "service_transaction_id": "2",
        "tariff_class": "econom",
        "topic": "payments",
        "transaction_type": "refund"
      },
      {
        "amount": "10",
        "client_id": "28",
        "contract_id": "123456",
        "currency": "RUB",
        "detailed_product": "trip_payment",
        "due": "2019-03-27T22:02:02.000000+00:00",
        "event_time": "2019-03-27T22:02:02.000000+00:00",
        "invoice_date": "2019-03-26T23:02:02.000000+00:00",
        "oebs_mvp_id": "MSKc",
        "payload": {
          "alias_id": "496",
          "amount_details": {
            "base_amount": "400",
            "base_currency": "RUB",
            "contract_currency_rate": "0.5"
          },
          "base_doc_id": 8128,
          "contract_details": {
            "agent_percent": "0.1",
            "currency": "USD",
            "firm_id": 100500,
            "region_id": 236
          },
          "country": "rus",
          "external_payment_id": "33550336",
          "order_id": "42",
          "terminal_id": 8589869056,
          "yandex_reward_amt": "12.2",
          "yandex_reward_product": "product"
        },
        "product": "trip_payment",
        "service_id": 124,
        "service_transaction_id": "3",
        "tariff_class": "econom",
        "topic": "payments",
        "transaction_type": "refund"
      },
      {
        "amount": "200.00",
        "client_id": "112691938",
        "contract_id": "3182601",
        "currency": "RUB",
        "detailed_product": "payment_on_delivery_b2b_logistics",
        "due": "2021-03-10T09:48:57.000000+00:00",
        "event_time": "2021-04-05T19:24:00.000000+00:00",
        "invoice_date": "2021-03-10T09:48:57.000000+00:00",
        "payload": {
          "agent_id": "agent_strizh",
          "base_doc_id": 8128,
          "operation_id": "0330eb9f-d704-42c5-adad-74f924b5466b",
          "terminal_id": 0
        },
        "product": "payment_on_delivery_b2b_logistics",
        "service_id": 1040,
        "service_transaction_id": "15",
        "tariff_class": "ndd",
        "topic": "payments",
        "transaction_type": "payment"
      },
      {
        "amount": "10",
        "client_id": "28",
        "contract_id": "123456",
        "currency": "RUB",
        "detailed_product": "trip_payment",
        "due": "2021-05-27T22:02:02.000000+00:00",
        "event_time": "2021-05-27T22:02:02.000000+00:00",
        "invoice_date": "2021-05-26T23:02:02.000000+00:00",
        "oebs_mvp_id": "MSKc",
        "payload": {
          "alias_id": "496",
          "amount_details": {
            "base_amount": "400",
            "base_currency": "RUB",
            "contract_currency_rate": "0.5"
          },
          "base_doc_id": 8128,
          "contract_details": {
            "agent_percent": "0.1",
            "currency": "USD",
            "firm_id": 100500,
            "region_id": 236
          },
          "country": "rus",
          "driver_details": {
            "db_id": "<db_id>",
            "uuid": "<uuid>"
          },
          "external_payment_id": "33550336",
          "order_id": "42",
          "terminal_id": 8589869056,
          "yandex_reward_amt": "12.2",
          "yandex_reward_product": "product"
        },
        "product": "trip_payment",
        "service_id": 124,
        "service_transaction_id": "16",
        "tariff_class": "econom",
        "topic": "payments",
        "transaction_type": "refund"
      },
      {
        "amount": "100",
        "client_id": "28",
        "currency": "RUB",
        "detailed_product": "b2b_tanker_payment",
        "event_time": "2019-03-27T22:02:02.000000+00:00",
        "ignore_in_balance": true,
        "invoice_date": "2019-03-26T23:02:02.000000+00:00",
        "payload": {
          "alias_id": "496",
          "base_doc_id": 8128
        },
        "product": "b2b_tanker_payment",
        "service_id": 636,
        "service_transaction_id": "70",
        "topic": "payments",
        "transaction_type": "payment"
      },
      {
        "amount": "108",
        "client_id": "28",
        "currency": "RUB",
        "detailed_product": "b2b_tanker_payment",
        "event_time": "2019-03-27T22:02:02.000000+00:00",
        "external_ref": "alias_id/987",
        "invoice_date": "2019-03-26T23:02:02.000000+00:00",
        "payload": {
          "alias_id": "987",
          "base_doc_id": 231
        },
        "product": "b2b_tanker_payment",
        "service_id": 636,
        "service_transaction_id": "71",
        "target": "fin-payouts/oebs",
        "topic": "payments",
        "transaction_type": "payment"
      }
    ]
  }
}
