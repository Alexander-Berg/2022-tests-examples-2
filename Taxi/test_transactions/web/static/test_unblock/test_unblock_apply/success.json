{
  "expected_content": {
    "status": "success"
  },
  "expected_orders": [
    {
      "id": "order_id_02",
      "transactions": [
        {
          "purchase_token": "2",
          "refunds": [],
          "status": "clear_fail"
        }
      ]
    },
    {
      "id": "order_id_03",
      "transactions": [
        {
          "cleared": {
            "$datetime": "2020-01-01T00:00:00.000"
          },
          "purchase_token": "3",
          "refunds": [
            {
              "status": "refund_success",
              "trust_refund_id": "3-1"
            },
            {
              "status": "refund_success",
              "trust_refund_id": "3-2"
            }
          ],
          "status": "clear_success"
        }
      ]
    },
    {
      "id": "order_id_06",
      "transactions": [
        {
          "cleared": {
            "$datetime": "2020-01-01T00:00:00.000"
          },
          "purchase_token": "6",
          "refunds": [],
          "status": "clear_success"
        }
      ]
    },
    {
      "id": "order_id_07",
      "transactions": [
        {
          "purchase_token": "7",
          "refunds": [],
          "status": "clear_init"
        }
      ]
    },
    {
      "id": "order_id_08",
      "transactions": [
        {
          "cleared": {
            "$datetime": "2020-01-01T00:00:00.000"
          },
          "purchase_token": "8",
          "refunds": [
            {
              "status": "refund_fail",
              "trust_refund_id": "8-1"
            }
          ],
          "status": "clear_success"
        }
      ]
    },
    {
      "id": "order_id_09",
      "operations": [
        {
          "id": "op_id_09",
          "originator": "processing",
          "status": "processing",
          "type": "update"
        }
      ],
      "transactions": [
        {
          "purchase_token": "9",
          "refunds": [],
          "status": "hold_success",
          "sum": {
            "ride": 0
          },
          "unheld": {
            "$datetime": "2020-01-01T00:00:00.000"
          }
        }
      ]
    },
    {
      "id": "order_id_10",
      "operations": [
        {
          "id": "op_id_10",
          "originator": "processing",
          "status": "processing",
          "type": "update"
        }
      ],
      "transactions": [
        {
          "purchase_token": "10",
          "refunds": [],
          "status": "hold_success",
          "sum": {
            "ride": 133700
          }
        }
      ]
    },
    {
      "id": "order_id_11",
      "operations": [
        {
          "id": "op_id_11",
          "originator": "processing",
          "should_fail": true,
          "status": "processing",
          "type": "update"
        }
      ],
      "transactions": [
        {
          "basket": {
            "ride": {
              "amount": "13.37",
              "item_id": "ride"
            }
          },
          "purchase_token": "11",
          "refunds": [],
          "status": "hold_success",
          "sum": {
            "ride": 133700
          }
        }
      ]
    },
    {
      "id": "order_id_14",
      "transactions": [
        {
          "purchase_token": "14",
          "refunds": [],
          "status": "clear_fail"
        }
      ]
    }
  ],
  "expected_orders_after_task_1": [
    {
      "id": "order_id_09",
      "operations": [
        {
          "id": "op_id_09",
          "needs_notification": false,
          "originator": "processing",
          "status": "done",
          "type": "update"
        }
      ],
      "transactions": [
        {
          "purchase_token": "9",
          "refunds": [],
          "status": "hold_success",
          "sum": {
            "ride": 0
          },
          "unheld": {
            "$datetime": "2020-01-01T00:00:00.000"
          }
        }
      ]
    },
    {
      "id": "order_id_10",
      "operations": [
        {
          "id": "op_id_10",
          "originator": "processing",
          "status": "processing",
          "type": "update"
        }
      ],
      "transactions": [
        {
          "purchase_token": "10",
          "refunds": [],
          "status": "unhold_init",
          "sum": {
            "ride": 0
          }
        }
      ]
    },
    {
      "id": "order_id_11",
      "operations": [
        {
          "id": "op_id_11",
          "needs_notification": false,
          "originator": "processing",
          "should_fail": false,
          "status": "failed",
          "type": "update"
        }
      ],
      "transactions": [
        {
          "purchase_token": "11",
          "refunds": [],
          "status": "hold_success",
          "sum": {
            "ride": 133700
          }
        }
      ]
    }
  ],
  "expected_orders_after_task_2": [
    {
      "id": "order_id_10",
      "operations": [
        {
          "id": "op_id_10",
          "originator": "processing",
          "status": "processing",
          "type": "update"
        }
      ],
      "transactions": [
        {
          "purchase_token": "10",
          "refunds": [],
          "status": "unhold_pending",
          "sum": {
            "ride": 0
          }
        }
      ]
    }
  ],
  "expected_process_events_calls": [
    {
      "id": "order_id_02"
    },
    {
      "id": "order_id_06"
    },
    {
      "id": "order_id_07"
    },
    {
      "id": "order_id_03"
    },
    {
      "id": "order_id_08"
    },
    {
      "id": "order_id_09"
    },
    {
      "id": "order_id_10"
    },
    {
      "id": "order_id_11"
    },
    {
      "id": "order_id_14"
    }
  ],
  "expected_status": 200,
  "request": {
    "items": [
      {
        "current_status": "clear_pending",
        "invoice_id": "order_id_02",
        "new_status": "clear_fail",
        "transaction_id": "2",
        "transaction_type": "payment"
      },
      {
        "current_status": "clear_pending",
        "invoice_id": "order_id_06",
        "new_status": "clear_success",
        "transaction_id": "6",
        "transaction_type": "payment"
      },
      {
        "current_status": "clear_pending",
        "invoice_id": "order_id_07",
        "new_status": "clear_init",
        "transaction_id": "7",
        "transaction_type": "payment"
      },
      {
        "current_status": "refund_waiting",
        "invoice_id": "order_id_03",
        "new_status": "refund_success",
        "transaction_id": "3-2",
        "transaction_type": "refund"
      },
      {
        "current_status": "refund_waiting",
        "invoice_id": "order_id_08",
        "new_status": "refund_fail",
        "transaction_id": "8-1",
        "transaction_type": "refund"
      },
      {
        "action": "mark_successful",
        "current_status": "unhold_pending",
        "invoice_id": "order_id_09",
        "new_status": "hold_success",
        "transaction_id": "9",
        "transaction_type": "payment"
      },
      {
        "action": "mark_unsuccessful",
        "current_status": "unhold_pending",
        "invoice_id": "order_id_10",
        "new_status": "hold_success",
        "transaction_id": "10",
        "transaction_type": "payment"
      },
      {
        "action": "fail_operation",
        "current_status": "unhold_pending",
        "invoice_id": "order_id_11",
        "new_status": "hold_success",
        "transaction_id": "11",
        "transaction_type": "payment"
      },
      {
        "current_status": "clear_init",
        "invoice_id": "order_id_14",
        "new_status": "clear_fail",
        "transaction_id": "14",
        "transaction_type": "payment"
      }
    ]
  }
}
