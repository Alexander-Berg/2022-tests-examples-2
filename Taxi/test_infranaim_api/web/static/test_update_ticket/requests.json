{
    "valid_no_medium_no_source": {
        "route": "/v1/update/ticket",
        "headers": {
            "token": "VUN4dXVzVnc1QnRMOUoxek9jenBVTWlwSGVsR2JTbHVOMkgweVQ3b3Z0"
        },
        "requests": [
            {
                "json": {
                    "params": {
                        "ticket_id": 1,
                        "name": "Jupiter",
                        "phone": "+79998887766"
                    }
                },
                "expected": {
                    "status_code": 200,
                    "fields": {
                        "name": {"$ne": null},
                        "phone": {"$ne": null},
                        "status": {"$ne": null},
                        "medium": {"$ne": null},
                        "source": {"$ne": null},
                        "adv_camp": {"$eq": null},
                        "workflow": {"$eq": null}
                    }
                }
            }
        ]
    },
    "valid_medium_and_source": {
        "route": "/v1/update/ticket",
        "headers": {
            "token": "VUN4dXVzVnc1QnRMOUoxek9jenBVTWlwSGVsR2JTbHVOMkgweVQ3b3Z0"
        },
        "requests": [
            {
                "json": {
                    "params": {
                        "ticket_id": 4,
                        "name": "Jupiter",
                        "phone": "+79998887766"
                    }
                },
                "expected": {
                    "status_code": 200,
                    "fields": {
                        "name": {"$ne": null},
                        "phone": {"$ne": null},
                        "status": {"$ne": null},
                        "medium": {"$ne": null},
                        "source": {"$ne": null},
                        "adv_camp": {"$eq": null},
                        "workflow": {"$eq": null}
                    }
                }
            }
        ]
    },
    "valid_medium_and_source_only_external_id": {
        "route": "/v1/update/ticket",
        "headers": {
            "token": "VUN4dXVzVnc1QnRMOUoxek9jenBVTWlwSGVsR2JTbHVOMkgweVQ3b3Z0"
        },
        "requests": [
            {
                "json": {
                    "params": {
                        "external_id": "1123",
                        "name": "Jupiter",
                        "phone": "+79998887766"
                    }
                },
                "expected": {
                    "status_code": 200,
                    "fields": {
                        "name": {"$ne": null},
                        "phone": {"$ne": null},
                        "status": {"$ne": null},
                        "medium": {"$ne": null},
                        "source": {"$ne": null},
                        "adv_camp": {"$eq": null},
                        "workflow": {"$eq": null}
                    }
                }
            }
        ]
    },
    "bool_field": {
        "route": "/v1/update/ticket",
        "headers": {
            "token": "VUN4dXVzVnc1QnRMOUoxek9jenBVTWlwSGVsR2JTbHVOMkgweVQ3b3Z0"
        },
        "requests": [
            {
                "json": {
                    "params": {
                        "ticket_id": 4,
                        "name": "Jupiter",
                        "phone": "+79998887766",
                        "no_need_call": false
                    }
                },
                "expected": {
                    "status_code": 200,
                    "fields": {
                        "name": {"$ne": null},
                        "phone": {"$ne": null},
                        "status": {"$ne": null},
                        "adv_camp": {"$eq": null},
                        "workflow": {"$eq": null},
                        "no_need_call": {"$eq": false}
                    }
                }
            }
        ]
    },
    "forbidden": {
        "route": "/v1/update/ticket",
        "headers": {
            "token": "VUN4dXVzVnc1QnRMOUoxek9jenBVTWlwSGVsR2JTbHVOMkgweVQ3b3Z0"
        },
        "requests": [
            {
                "json": {
                    "params": {
                        "ticket_id": 2,
                        "name": "Jupiter",
                        "phone": "+79998887766"
                    }
                },
                "expected": {
                    "status_code": 400,
                    "fields": {}
                }
            }
        ]
    },
    "forbidden_only_external_id": {
        "route": "/v1/update/ticket",
        "headers": {
            "token": "VUN4dXVzVnc1QnRMOUoxek9jenBVTWlwSGVsR2JTbHVOMkgweVQ3b3Z0"
        },
        "requests": [
            {
                "json": {
                    "params": {
                        "external_id": "1124",
                        "name": "Jupiter",
                        "phone": "+79998887766"
                    }
                },
                "expected": {
                    "status_code": 400,
                    "fields": {}
                }
            }
        ]
    },
    "non_existent": {
        "route": "/v1/update/ticket",
        "headers": {
            "token": "VUN4dXVzVnc1QnRMOUoxek9jenBVTWlwSGVsR2JTbHVOMkgweVQ3b3Z0"
        },
        "requests": [
            {
                "json": {
                    "params": {
                        "ticket_id": 3,
                        "name": "Jupiter",
                        "phone": "+79998887766"
                    }
                },
                "expected": {
                    "status_code": 400,
                    "fields": {}
                }
            }
        ]
    },
    "repeat": {
        "route": "/v1/update/repeat",
        "headers": {
            "token": "VUN4dXVzVnc1QnRMOUoxek9jenBVTWlwSGVsR2JTbHVOMkgweVQ3b3Z0"
        },
        "requests": [
            {
                "json": {
                    "params": {
                        "ticket_id": 5,
                        "status": "обучение"
                    }
                },
                "expected": {
                    "status_code": 200,
                    "fields": {
                        "status": {"$eq": "обучение"}
                    }
                }
            },
            {
                "json": {
                    "params": {
                        "ticket_id": 5,
                        "status": "активен"
                    }
                },
                "expected": {
                    "status_code": 200,
                    "fields": {
                        "status": {"$eq": "активен"}
                    }
                }
            },
            {
                "json": {
                    "params": {
                        "ticket_id": 5,
                        "status": "не_лид"
                    }
                },
                "expected": {
                    "status_code": 200,
                    "fields": {
                        "status": {"$eq": "не_лид"}
                    }
                }
            },
            {
                "json": {
                    "params": {
                        "ticket_id": 5,
                        "status": "new_status"
                    }
                },
                "expected": {
                    "status_code": 400,
                    "fields": {
                        "status": {"$eq": "не_лид"}
                    }
                }
            }
        ]
    },
    "fake_update": {
        "route": "/v1/update/fake",
        "headers": {
            "token": "VUN4dXVzVnc1QnRMOUoxek9jenBVTWlwSGVsR2JTbHVOMkgweVQ3b3Z0"
        },
        "requests": [
            {
                "json": {
                    "params": {
                        "ticket_id": 6,
                        "status": "обучение"
                    }
                },
                "expected": {
                    "status_code": 200,
                    "fields": {
                        "status": {
                            "$eq": "new_status"
                        }
                    }
                }
            },
            {
                "json": {
                    "params": {
                        "ticket_id": 7,
                        "status": "активен"
                    }
                },
                "expected": {
                    "status_code": 200,
                    "fields": {
                        "status": {
                            "$eq": "new_status"
                        }
                    }
                }
            }
        ]
    },
    "fake_external_id_not_old": {
        "route": "/v1/update/fake",
        "headers": {
            "token": "VUN4dXVzVnc1QnRMOUoxek9jenBVTWlwSGVsR2JTbHVOMkgweVQ3b3Z0"
        },
        "requests": [
            {
                "json": {
                    "params": {
                        "external_id": "EXISTENT",
                        "status": "обучение"
                    }
                },
                "expected": {
                    "status_code": 400,
                    "fields": {}
                }
            }
        ]
    },
    "fake_external_id_old": {
        "route": "/v1/update/fake",
        "headers": {
            "token": "VUN4dXVzVnc1QnRMOUoxek9jenBVTWlwSGVsR2JTbHVOMkgweVQ3b3Z0"
        },
        "requests": [
            {
                "json": {
                    "params": {
                        "external_id": "NONEXISTENT",
                        "status": "обучение"
                    }
                },
                "expected": {
                    "status_code": 200,
                    "fields": {}
                }
            }
        ]
    }
}
