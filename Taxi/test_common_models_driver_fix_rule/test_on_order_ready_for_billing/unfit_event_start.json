{
  "event": {
    "$order_ready_for_billing_doc": {
      "order": {
        "$order": {
          "accepted_by_driver_at": {
            "$datetime": "2019-11-17T23:00:00+03:00"
          },
          "completed_at": {
            "$datetime": "2019-11-19T01:00:00+03:00"
          },
          "coupon": {
            "$money": "100 RUB"
          },
          "due": {
            "$datetime": "2019-11-18T11:10:00+03:00"
          },
          "performer": {
            "$blueprint:performer": {
              "available_tariff_classes": {
                "$frozenset": [
                  "econom"
                ]
              }
            }
          }
        }
      }
    }
  },
  "expected_event_handled": {
    "$blueprint:rule_event_handled": {
      "journal_entries": [
        {
          "$journal_entry": {
            "agreement_id": "subvention_agreement/1/default/_id/driver_fix_rule_id",
            "all_reasons": [
              {
                "$factory:unfit_reason": {
                  "code": "interval",
                  "details": {
                    "allowed_values": {
                      "$factory:datetime_interval": [
                        "2019-11-18T00:00:00+03:00",
                        "2019-11-19T00:00:00+03:00"
                      ]
                    },
                    "value": {
                      "$datetime": "2019-11-17T23:00:00+03:00"
                    }
                  },
                  "sub_kind": "in"
                }
              }
            ],
            "delta": {
              "$money": "200 RUB"
            },
            "details": {
              "$journal_entry_details": {
                "alias_id": "some_alias_id"
              }
            },
            "entity": {
              "$entity": {
                "external_id": "taximeter_driver_id/some_db_id/some_uuid",
                "kind": "driver"
              }
            },
            "event_at": {
              "$datetime": "2019-11-17T23:00:00+03:00"
            },
            "sub_account": "unfit/income"
          }
        },
        {
          "$journal_entry": {
            "agreement_id": "subvention_agreement/1/default/_id/driver_fix_rule_id",
            "all_reasons": [
              {
                "$factory:unfit_reason": {
                  "code": "interval",
                  "details": {
                    "allowed_values": {
                      "$factory:datetime_interval": [
                        "2019-11-18T00:00:00+03:00",
                        "2019-11-19T00:00:00+03:00"
                      ]
                    },
                    "value": {
                      "$datetime": "2019-11-17T23:00:00+03:00"
                    }
                  },
                  "sub_kind": "in"
                }
              }
            ],
            "delta": {
              "$money": "1500 XXX"
            },
            "details": {
              "$journal_entry_details": {
                "alias_id": "some_alias_id",
                "order_completed_at": "2019-11-18T22:00:00.000000+00:00",
                "order_id": "some_order_id"
              }
            },
            "entity": {
              "$entity": {
                "external_id": "taximeter_driver_id/some_db_id/some_uuid",
                "kind": "driver"
              }
            },
            "event_at": {
              "$datetime": "2019-11-17T23:00:00+03:00"
            },
            "sub_account": "unfit/time/on_order_minutes"
          }
        },
        {
          "$journal_entry": {
            "agreement_id": "subvention_agreement/1/default/_id/driver_fix_rule_id",
            "all_reasons": [
              {
                "$factory:unfit_reason": {
                  "code": "interval",
                  "details": {
                    "allowed_values": {
                      "$factory:datetime_interval": [
                        "2019-11-18T00:00:00+03:00",
                        "2019-11-19T00:00:00+03:00"
                      ]
                    },
                    "value": {
                      "$datetime": "2019-11-17T23:00:00+03:00"
                    }
                  },
                  "sub_kind": "in"
                }
              }
            ],
            "delta": {
              "$money": "1500 RUB"
            },
            "details": {
              "$journal_entry_details": {
                "intervals": [
                  {
                    "duration_min": "1500",
                    "rate_per_min": "1"
                  }
                ]
              }
            },
            "entity": {
              "$entity": {
                "external_id": "taximeter_driver_id/some_db_id/some_uuid",
                "kind": "driver"
              }
            },
            "event_at": {
              "$datetime": "2019-11-17T23:00:00+03:00"
            },
            "sub_account": "unfit/guarantee"
          }
        }
      ],
      "shift_ended_events": []
    }
  },
  "rule": {
    "$blueprint:driver_fix_rule": {
      "data": {
        "$blueprint:driver_fix_rule_data": {
          "rate_intervals": {
            "$factory:driver_fix_rate_intervals": [
              "Mon 12:00, 1"
            ]
          }
        }
      },
      "matcher": {
        "$moscow_rule_matcher": {
          "end": {
            "$datetime": "2019-11-19T00:00:00+03:00"
          },
          "start": {
            "$datetime": "2019-11-18T00:00:00+03:00"
          }
        }
      }
    }
  }
}
