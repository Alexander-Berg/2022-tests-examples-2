IF(U(?,SL(1,4,1,21,B(fix,.,F(payment_type)))),IF(SL(2,6,2,28,B(U(*,B(fix,.,F(payment_type))),==,"cash")),CR(boarding=B(SL(3,11,3,21,B(ride,.,F(price))),.,F(boarding)),destination_waiting=B(SL(3,11,3,21,B(ride,.,F(price))),.,F(destination_waiting)),distance=B(SL(3,11,3,21,B(ride,.,F(price))),.,F(distance)),requirements=B(SL(3,11,3,21,B(ride,.,F(price))),.,F(requirements)),time=B(SL(3,11,3,21,B(ride,.,F(price))),.,F(time)),transit_waiting=B(SL(3,11,3,21,B(ride,.,F(price))),.,F(transit_waiting)),waiting=B(SL(3,11,3,21,B(ride,.,F(price))),.,F(waiting)))));SV(paid_supply_disabled,SL(7,27,7,119,T(U(?,SL(7,28,7,66,B(B(fix,.,F(category_data)),.,F(disable_paid_supply)))),SL(7,92,7,112,U(*,B(B(fix,.,F(category_data)),.,F(disable_paid_supply)))),SL(7,114,7,119,false))));SV(paid_supply_paid_cancel,SL(9,30,11,11,T(U(?,SL(9,31,9,53,B(fix,.,F(paid_supply_price)))),SL(10,6,11,4,B(U(!,VA(paid_supply_disabled)),&&,B(U(*,B(fix,.,F(paid_supply_price))),>=,B(B(fix,.,F(category_data)),.,F(min_paid_supply_price_for_paid_cancel))))),SL(11,6,11,11,false))));IF(SL(13,4,13,27,VA(paid_supply_paid_cancel)),IF(U(?,SL(14,6,14,28,B(fix,.,F(paid_supply_price)))),SV(meta1,SL(15,16,17,5,MAP("paid_supply_paid_cancel_in_driving_price"=B(U(*,B(fix,.,F(paid_supply_price))),round_to,B(fix,.,F(rounding_factor))))));IF(U(?,SL(18,7,18,24,B(fix,.,F(payment_type)))),SV(corp_type,SL(19,22,19,44,B(U(*,B(fix,.,F(payment_type))),==,"corp")));SV(wallet_type,SL(20,24,20,57,B(U(*,B(fix,.,F(payment_type))),==,"personal_wallet")));SV(corp_acc_type,SL(21,26,21,56,B(U(*,B(fix,.,F(payment_type))),==,"coop_account")));SV(good_type,SL(22,22,22,66,B(B(U(!,VA(corp_type)),&&,U(!,VA(wallet_type))),&&,U(!,VA(corp_acc_type)))));IF(SL(23,10,23,83,B(B(B(B(fix,.,F(user_data)),.,F(has_yaplus)),&&,U(!,B(B(fix,.,F(user_data)),.,F(has_cashback_plus)))),&&,VA(good_type))),IF(U(?,SL(24,12,24,43,B(B(fix,.,F(category_data)),.,F(yaplus_coeff)))),SV(meta2,SL(25,22,27,11,MAP("paid_supply_paid_cancel_in_driving_price"=B(B(U(*,B(fix,.,F(paid_supply_price))),*,U(*,B(B(fix,.,F(category_data)),.,F(yaplus_coeff)))),round_to,B(fix,.,F(rounding_factor))))));CR(metadata=SL(28,30,28,44,B(VA(meta1),+,VA(meta2)))))));CR(metadata=SL(32,24,32,30,VA(meta1)))),IF(SL(34,11,34,49,B("driving_paid_cancel",in,B(fix,.,F(user_tags)))),SV(boarding,SL(35,17,35,42,B(B(fix,.,F(tariff)),.,F(boarding_price))));SV(meta1,SL(37,14,39,3,MAP("paid_cancel_in_driving_price"=B(VA(boarding),round_to,B(fix,.,F(rounding_factor))))));IF(U(?,SL(41,5,41,22,B(fix,.,F(payment_type)))),SV(corp_type,SL(42,20,42,42,B(U(*,B(fix,.,F(payment_type))),==,"corp")));SV(wallet_type,SL(43,22,43,55,B(U(*,B(fix,.,F(payment_type))),==,"personal_wallet")));SV(corp_acc_type,SL(44,24,44,54,B(U(*,B(fix,.,F(payment_type))),==,"coop_account")));SV(good_type,SL(45,20,45,64,B(B(U(!,VA(corp_type)),&&,U(!,VA(wallet_type))),&&,U(!,VA(corp_acc_type)))));IF(SL(46,8,46,81,B(B(B(B(fix,.,F(user_data)),.,F(has_yaplus)),&&,U(!,B(B(fix,.,F(user_data)),.,F(has_cashback_plus)))),&&,VA(good_type))),IF(U(?,SL(47,10,47,41,B(B(fix,.,F(category_data)),.,F(yaplus_coeff)))),SV(meta2,SL(48,20,50,9,MAP("paid_cancel_in_driving_price"=B(B(VA(boarding),*,U(*,B(B(fix,.,F(category_data)),.,F(yaplus_coeff)))),round_to,B(fix,.,F(rounding_factor))))));CR(metadata=SL(51,28,51,41,B(VA(meta1),+,VA(meta2)))))));CR(metadata=SL(55,22,55,28,VA(meta1)))));CR(boarding=B(SL(58,7,58,17,B(ride,.,F(price))),.,F(boarding)),destination_waiting=B(SL(58,7,58,17,B(ride,.,F(price))),.,F(destination_waiting)),distance=B(SL(58,7,58,17,B(ride,.,F(price))),.,F(distance)),requirements=B(SL(58,7,58,17,B(ride,.,F(price))),.,F(requirements)),time=B(SL(58,7,58,17,B(ride,.,F(price))),.,F(time)),transit_waiting=B(SL(58,7,58,17,B(ride,.,F(price))),.,F(transit_waiting)),waiting=B(SL(58,7,58,17,B(ride,.,F(price))),.,F(waiting)))