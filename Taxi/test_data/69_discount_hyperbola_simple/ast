FUNC(calcCoeffNormalized,ARGS((base_coeff,double),(discount,lang::variables::DiscountInfo)),B(SV(restrictions,SL(2,21,2,42,B(FA(discount,lang::variables::DiscountInfo),.,F(restrictions))));SV(coeff_newbie,SL(3,21,3,31,FA(base_coeff,double)));SV(tmp_coeff_normalized,SL(8,29,10,20,T(SL(8,30,8,76,B(VA(coeff_newbie),>,B(VA(restrictions),.,F(max_discount_coeff)))),SL(9,8,10,6,B(VA(restrictions),.,F(max_discount_coeff))),SL(10,8,10,20,VA(coeff_newbie)))));SV(coeff_normalized,SL(11,25,13,28,T(SL(11,26,11,80,B(VA(tmp_coeff_normalized),<,B(VA(restrictions),.,F(min_discount_coeff)))),SL(12,8,13,6,0.000000),SL(13,8,13,28,VA(tmp_coeff_normalized)))));IF(U(?,SL(15,6,15,38,B(VA(restrictions),.,F(max_absolute_value)))),SV(price,SL(17,16,19,60,B(B(B(U(*,B(ride,.,F(price))),-,B(B(ride,.,F(price)),.,F(waiting))),-,B(B(ride,.,F(price)),.,F(transit_waiting))),-,B(B(ride,.,F(price)),.,F(destination_waiting)))));IF(SL(20,11,21,58,B(SL(20,12,20,26,B(VA(price),>,0.000100)),&&,SL(21,12,21,57,B(B(VA(price),*,VA(coeff_normalized)),>,U(*,B(VA(restrictions),.,F(max_absolute_value))))))),SV(tmp_max_coeff,SL(22,26,24,38,T(SL(22,27,22,57,B(B(U(*,B(VA(restrictions),.,F(max_absolute_value))),/,VA(price)),<,0.000000)),SL(23,12,24,10,0.000000),SL(24,12,24,38,B(U(*,B(VA(restrictions),.,F(max_absolute_value))),/,VA(price))))));SV(max_coeff,SL(25,22,27,25,T(SL(25,23,25,40,B(VA(tmp_max_coeff),>,1.000000)),SL(26,12,27,10,1.000000),SL(27,12,27,25,VA(tmp_max_coeff)))));CR(res=SL(28,20,28,29,VA(max_coeff)))));IF(SL(31,6,31,27,B(VA(coeff_normalized),<=,0.000000)),CR(res=SL(32,18,32,19,0.000000)));IF(SL(34,6,34,27,B(VA(coeff_normalized),>=,1.000000)),CR(res=SL(35,18,35,19,1.000000)));CR(res=SL(37,16,37,32,VA(coeff_normalized)))));IF(U(?,SL(41,4,41,17,B(fix,.,F(discount)))),IF(U(?,SL(44,6,44,38,B(U(*,B(fix,.,F(discount))),.,F(is_price_strikethrough)))),IF(SL(45,8,45,31,U(!,U(*,B(U(*,B(fix,.,F(discount))),.,F(is_price_strikethrough))))),CR(boarding=B(SL(46,13,46,23,B(ride,.,F(price))),.,F(boarding)),destination_waiting=B(SL(46,13,46,23,B(ride,.,F(price))),.,F(destination_waiting)),distance=B(SL(46,13,46,23,B(ride,.,F(price))),.,F(distance)),requirements=B(SL(46,13,46,23,B(ride,.,F(price))),.,F(requirements)),time=B(SL(46,13,46,23,B(ride,.,F(price))),.,F(time)),transit_waiting=B(SL(46,13,46,23,B(ride,.,F(price))),.,F(transit_waiting)),waiting=B(SL(46,13,46,23,B(ride,.,F(price))),.,F(waiting)))));IF(U(?,SL(51,6,51,17,B(fix,.,F(coupon)))),IF(U(?,SL(52,8,52,29,B(U(*,B(fix,.,F(discount))),.,F(description)))),IF(SL(53,10,56,59,B(B(B(U(*,B(fix,.,F(coupon))),.,F(valid)),&&,B(B(fix,.,F(country_code2)),==,"FI")),&&,SL(54,11,56,58,B(B(B(U(*,B(U(*,B(fix,.,F(discount))),.,F(description))),==,"new_helsinki_disgmv30_1120"),||,B(U(*,B(U(*,B(fix,.,F(discount))),.,F(description))),==,"tampere_launch_16122020")),||,B(U(*,B(U(*,B(fix,.,F(discount))),.,F(description))),==,"turku_launch_16122020"))))),CR(boarding=B(SL(57,15,57,25,B(ride,.,F(price))),.,F(boarding)),destination_waiting=B(SL(57,15,57,25,B(ride,.,F(price))),.,F(destination_waiting)),distance=B(SL(57,15,57,25,B(ride,.,F(price))),.,F(distance)),requirements=B(SL(57,15,57,25,B(ride,.,F(price))),.,F(requirements)),time=B(SL(57,15,57,25,B(ride,.,F(price))),.,F(time)),transit_waiting=B(SL(57,15,57,25,B(ride,.,F(price))),.,F(transit_waiting)),waiting=B(SL(57,15,57,25,B(ride,.,F(price))),.,F(waiting))))));SV(restrictions,SL(62,21,62,42,B(U(*,B(fix,.,F(discount))),.,F(restrictions))));IF(U(?,SL(64,6,64,36,B(U(*,B(fix,.,F(discount))),.,F(calc_data_hyperbolas)))),SV(meta1,SL(65,16,65,47,MAP("discount_price"=U(*,B(ride,.,F(price))))));SV(price,SL(66,16,68,60,B(B(B(U(*,B(ride,.,F(price))),-,B(B(ride,.,F(price)),.,F(waiting))),-,B(B(ride,.,F(price)),.,F(transit_waiting))),-,B(B(ride,.,F(price)),.,F(destination_waiting)))));SV(hyperbola,SL(70,20,72,36,T(SL(70,21,70,49,B(VA(price),<,B(U(*,B(U(*,B(fix,.,F(discount))),.,F(calc_data_hyperbolas))),.,F(threshold)))),SL(71,10,72,8,B(U(*,B(U(*,B(fix,.,F(discount))),.,F(calc_data_hyperbolas))),.,F(hyperbola_lower))),SL(72,10,72,36,B(U(*,B(U(*,B(fix,.,F(discount))),.,F(calc_data_hyperbolas))),.,F(hyperbola_upper))))));IF(SL(74,8,75,39,U(!,SL(74,13,75,38,B(SL(74,14,74,37,B(B(VA(price),+,B(VA(hyperbola),.,F(c))),>,0.000000)),||,SL(75,14,75,37,B(B(VA(price),+,B(VA(hyperbola),.,F(c))),<,0.000000)))))),CR(metadata=SL(76,25,76,30,VA(meta1))));SV(coeff,SL(78,16,79,53,B(SL(78,17,79,45,B(B(VA(hyperbola),.,F(p)),+,B(B(VA(hyperbola),.,F(a)),/,SL(79,25,79,44,B(VA(price),+,B(VA(hyperbola),.,F(c))))))),*,0.010000)));SV(coeff_normalized,SL(81,27,81,91,B(FC(calcCoeffNormalized,NT(base_coeff=SL(81,81,81,86,VA(coeff)),discount=SL(81,58,81,66,U(*,B(fix,.,F(discount))))),R(res=double)),.,F(res))));IF(SL(83,8,83,35,B(VA(coeff_normalized),<,0.000001)),CR(metadata=SL(84,25,84,30,VA(meta1))));SV(discount_abs,SL(87,23,91,44,B(SL(87,24,91,24,B(B(B(U(*,B(ride,.,F(price))),-,B(B(ride,.,F(price)),.,F(waiting))),-,B(B(ride,.,F(price)),.,F(transit_waiting))),-,B(B(ride,.,F(price)),.,F(destination_waiting)))),*,VA(coeff_normalized))));SV(meta2,SL(92,16,95,5,MAP("discount_abs"=VA(discount_abs),"discount_value"=VA(coeff_normalized))));SV(mult,SL(96,15,96,35,B(1.000000,-,VA(coeff_normalized))));CR(boarding=SL(98,17,98,43,B(B(B(ride,.,F(price)),.,F(boarding)),*,VA(mult))),destination_waiting=SL(104,28,104,58,B(B(ride,.,F(price)),.,F(destination_waiting))),distance=SL(99,17,99,43,B(B(B(ride,.,F(price)),.,F(distance)),*,VA(mult))),metadata=SL(105,17,106,4,B(VA(meta1),+,VA(meta2))),requirements=SL(101,21,101,51,B(B(B(ride,.,F(price)),.,F(requirements)),*,VA(mult))),time=SL(100,13,100,35,B(B(B(ride,.,F(price)),.,F(time)),*,VA(mult))),transit_waiting=SL(103,24,103,50,B(B(ride,.,F(price)),.,F(transit_waiting))),waiting=SL(102,16,102,34,B(B(ride,.,F(price)),.,F(waiting))))));CR(boarding=B(SL(110,7,110,17,B(ride,.,F(price))),.,F(boarding)),destination_waiting=B(SL(110,7,110,17,B(ride,.,F(price))),.,F(destination_waiting)),distance=B(SL(110,7,110,17,B(ride,.,F(price))),.,F(distance)),requirements=B(SL(110,7,110,17,B(ride,.,F(price))),.,F(requirements)),time=B(SL(110,7,110,17,B(ride,.,F(price))),.,F(time)),transit_waiting=B(SL(110,7,110,17,B(ride,.,F(price))),.,F(transit_waiting)),waiting=B(SL(110,7,110,17,B(ride,.,F(price))),.,F(waiting)))