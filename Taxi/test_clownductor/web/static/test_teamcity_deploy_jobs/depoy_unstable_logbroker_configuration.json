{
  "expected_jobs": [
    {
      "id": 4,
      "inited_variables": {
        "aliases": [
          {
            "branch_id": 3,
            "image": "taxi/test_service_2/unstable:0.0.1",
            "logbroker_configuration": {
              "some": "configuration"
            },
            "nanny_name": "test_service_2_unstable",
            "service_id": 2
          }
        ],
        "changelog": "test deploy",
        "comment": "Automatically created release",
        "configs_branch_ids": [
          1,
          3
        ],
        "configs_info": [],
        "image": "taxi/test_service/unstable:0.0.1",
        "lock_names": [
          "Deploy.test_service_2_unstable",
          "Deploy.test_service_unstable"
        ],
        "logbroker_configuration": null,
        "name": "test_service_unstable",
        "prestable_aliases": [],
        "prestable_name": null,
        "project_names": [
          "test_project"
        ],
        "release_ticket_st": null,
        "sandbox_resources": null
      },
      "name": "DeployNannyServiceNoApprove",
      "stages": [
        {
          "appended_variables": {},
          "name": "InternalBatchGetLock"
        },
        {
          "appended_variables": {
            "job_branch_id": 1,
            "job_project_id": 1,
            "job_project_name": "test_project",
            "job_service_id": 1,
            "job_service_name": "test_service"
          },
          "name": "InternalJobGetInformation"
        },
        {
          "appended_variables": {
            "current_diff_aliases_jobs": [],
            "current_diff_job_id": null
          },
          "name": "FindCurrentDiff"
        },
        {
          "appended_variables": {
            "current_diff_comment": null,
            "current_diff_skip": true
          },
          "name": "CurrentDiffCommentGenerate"
        },
        {
          "appended_variables": {},
          "name": "ApproveCubeOptionalLiteEnsureComment"
        },
        {
          "appended_variables": {},
          "name": "WaitChangeSubsystem"
        },
        {
          "appended_variables": {
            "logbroker_operations": {
              "operations": [
                {
                  "id": "777",
                  "installation": "logbroker.yandex.net"
                }
              ]
            }
          },
          "name": "LogbrokerConfigurationStart"
        },
        {
          "appended_variables": {},
          "name": "LogbrokerConfigurationPoll"
        },
        {
          "appended_variables": {
            "environment": "unstable"
          },
          "name": "InternalGetBranchInformation"
        },
        {
          "appended_variables": {},
          "ignore_variables": [
            "started_deploy_msg"
          ],
          "name": "GenerateTestingDeployMessage"
        },
        {
          "appended_variables": {},
          "name": "ApproveCubeOptionalLiteEnsureComment"
        },
        {
          "appended_variables": {
            "job_ids": [
              6,
              7
            ]
          },
          "meta": [
            {
              "id": 6,
              "inited_variables": {
                "changelog": "test deploy",
                "comment": "Automatically created release",
                "image": "taxi/test_service/unstable:0.0.1",
                "link_to_changelog": "/services/1/edit/1/jobs?jobId=4&isClownJob=true",
                "nanny_name": "test_service_unstable",
                "sandbox_resources": null
              },
              "name": "DeployOneNannyService",
              "stages": [
                {
                  "appended_variables": {
                    "job_branch_id": 1,
                    "job_project_id": 1,
                    "job_project_name": "test_project",
                    "job_service_id": 1,
                    "job_service_name": "test_service"
                  },
                  "name": "InternalJobGetInformation"
                },
                {
                  "appended_variables": {
                    "environment": "unstable"
                  },
                  "name": "InternalGetBranchInformation"
                },
                {
                  "appended_variables": {},
                  "name": "UpdateHosts"
                },
                {
                  "appended_variables": {
                    "snapshot_id": "5c26609053b7c34a9ad5a283f48ae03c79853d58"
                  },
                  "name": "NannyCubeCreateSnapshot"
                },
                {
                  "appended_variables": {},
                  "name": "NannyCubeDeploySnapshot"
                },
                {
                  "appended_variables": {},
                  "name": "NannyTryDestroyExtraSnapshots"
                },
                {
                  "appended_variables": {},
                  "name": "NannyCubeWaitForDeploy"
                },
                {
                  "appended_variables": {},
                  "name": "SendCallback"
                }
              ]
            },
            {
              "id": 7,
              "inited_variables": {
                "changelog": "test deploy",
                "comment": "Automatically created release",
                "image": "taxi/test_service_2/unstable:0.0.1",
                "link_to_changelog": "/services/1/edit/1/jobs?jobId=4&isClownJob=true",
                "nanny_name": "test_service_2_unstable",
                "sandbox_resources": null
              },
              "name": "DeployOneNannyService",
              "stages": [
                {
                  "appended_variables": {
                    "job_branch_id": 3,
                    "job_project_id": 1,
                    "job_project_name": "test_project",
                    "job_service_id": 2,
                    "job_service_name": "test_service_2"
                  },
                  "name": "InternalJobGetInformation"
                },
                {
                  "appended_variables": {
                    "environment": "unstable"
                  },
                  "name": "InternalGetBranchInformation"
                },
                {
                  "appended_variables": {},
                  "name": "UpdateHosts"
                },
                {
                  "appended_variables": {
                    "snapshot_id": "5c26609053b7c34a9ad5a283f48ae03c79853d58"
                  },
                  "name": "NannyCubeCreateSnapshot"
                },
                {
                  "appended_variables": {},
                  "name": "NannyCubeDeploySnapshot"
                },
                {
                  "appended_variables": {},
                  "name": "NannyTryDestroyExtraSnapshots"
                },
                {
                  "appended_variables": {},
                  "name": "NannyCubeWaitForDeploy"
                },
                {
                  "appended_variables": {},
                  "name": "SendCallback"
                }
              ]
            }
          ],
          "name": "MetaStartDeployNannyServices"
        },
        {
          "appended_variables": {},
          "name": "MetaCubeWaitForJobsCommon"
        },
        {
          "appended_variables": {},
          "name": "InternalCubeUpdateServiceConfigs"
        },
        {
          "appended_variables": {},
          "name": "InternalBatchReleaseLock"
        }
      ]
    }
  ],
  "request_data": {
    "aliases": [
      {
        "logbroker_configuration": {
          "some": "configuration"
        },
        "service_name": "test_service_2"
      }
    ],
    "changelog": "test deploy",
    "configs": [
      "TEST_CONFIG_1"
    ],
    "docker_image": "taxi/test_service/unstable:0.0.1",
    "env": "unstable",
    "service_name": "test_service"
  }
}
