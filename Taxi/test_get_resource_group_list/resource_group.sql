INSERT INTO gp.res_group_status (database_name, res_group_id, res_group_name, concurrency, cpu_utilization, cpu_utilization_percent, vmem_utilization, vmem_utilization_percent, vmem_fixed, vmem_fixed_percent, update_dttm) VALUES ('ritchie', 7476, 'tableau_group', 20, 0, 0, 0, 0, 0, 0, '2022-07-27 13:01:08.531796');
INSERT INTO gp.res_group_status (database_name, res_group_id, res_group_name, concurrency, cpu_utilization, cpu_utilization_percent, vmem_utilization, vmem_utilization_percent, vmem_fixed, vmem_fixed_percent, update_dttm) VALUES ('ritchie', 6594, 'robot_small_group', 10, 0, 0, 0, 0, 0, 0, '2022-07-27 13:01:08.531796');
INSERT INTO gp.res_group_status (database_name, res_group_id, res_group_name, concurrency, cpu_utilization, cpu_utilization_percent, vmem_utilization, vmem_utilization_percent, vmem_fixed, vmem_fixed_percent, update_dttm) VALUES ('ritchie', 2220, 'eda_etl_group', 40, 469, 148.05, 52112, 1.28, 1218128, 29.95, '2022-07-27 13:01:08.531796');
INSERT INTO gp.res_group_status (database_name, res_group_id, res_group_name, concurrency, cpu_utilization, cpu_utilization_percent, vmem_utilization, vmem_utilization_percent, vmem_fixed, vmem_fixed_percent, update_dttm) VALUES ('ritchie', 3335, 'gpt_group', 50, 26, 18.32, 0, 0, 127104, 10.94, '2022-07-27 13:01:08.531796');
INSERT INTO gp.res_group_status (database_name, res_group_id, res_group_name, concurrency, cpu_utilization, cpu_utilization_percent, vmem_utilization, vmem_utilization_percent, vmem_fixed, vmem_fixed_percent, update_dttm) VALUES ('ritchie', 1563, 'market_etl_group', 20, 369, 174.68, 16384, 0.81, 1013760, 49.85, '2022-07-27 13:01:08.531796');
INSERT INTO gp.res_group_status (database_name, res_group_id, res_group_name, concurrency, cpu_utilization, cpu_utilization_percent, vmem_utilization, vmem_utilization_percent, vmem_fixed, vmem_fixed_percent, update_dttm) VALUES ('ritchie', 1549, 'etl_high_group', 5, 0, 0, 0, 0, 0, 0, '2022-07-27 13:01:08.531796');
INSERT INTO gp.res_group_status (database_name, res_group_id, res_group_name, concurrency, cpu_utilization, cpu_utilization_percent, vmem_utilization, vmem_utilization_percent, vmem_fixed, vmem_fixed_percent, update_dttm) VALUES ('ritchie', 16392, 'etl_group', 90, 1686, 239.42, 200064, 2.22, 3784480, 42, '2022-07-27 13:01:08.531796');
INSERT INTO gp.res_group_status (database_name, res_group_id, res_group_name, concurrency, cpu_utilization, cpu_utilization_percent, vmem_utilization, vmem_utilization_percent, vmem_fixed, vmem_fixed_percent, update_dttm) VALUES ('ritchie', 2231, 'piecework_group', 10, 240, 136.15, 42928, 14.83, 62608, 21.64, '2022-07-27 13:01:08.531796');
INSERT INTO gp.res_group_status (database_name, res_group_id, res_group_name, concurrency, cpu_utilization, cpu_utilization_percent, vmem_utilization, vmem_utilization_percent, vmem_fixed, vmem_fixed_percent, update_dttm) VALUES ('ritchie', 6437, 'default_group', 40, 713, 101.33, 110656, 2.12, 1370224, 26.19, '2022-07-27 13:01:08.531796');
INSERT INTO gp.res_group_status (database_name, res_group_id, res_group_name, concurrency, cpu_utilization, cpu_utilization_percent, vmem_utilization, vmem_utilization_percent, vmem_fixed, vmem_fixed_percent, update_dttm) VALUES ('ritchie', 6438, 'admin_group', 50, 237, 33.63, 1920, 0.07, 357664, 12.31, '2022-07-27 13:01:08.531796');
INSERT INTO gp.res_group_status (database_name, res_group_id, res_group_name, concurrency, cpu_utilization, cpu_utilization_percent, vmem_utilization, vmem_utilization_percent, vmem_fixed, vmem_fixed_percent, update_dttm) VALUES ('butthead', 4137, 'gpt_group', 10, 0, 0, 0, 0, 0, 0, '2022-07-27 13:01:15.702117');
INSERT INTO gp.res_group_status (database_name, res_group_id, res_group_name, concurrency, cpu_utilization, cpu_utilization_percent, vmem_utilization, vmem_utilization_percent, vmem_fixed, vmem_fixed_percent, update_dttm) VALUES ('butthead', 4137, 'etl_group', 10, 0, 0, 0, 0, 0, 0, '2022-07-27 13:01:15.702117');
INSERT INTO gp.res_group_status (database_name, res_group_id, res_group_name, concurrency, cpu_utilization, cpu_utilization_percent, vmem_utilization, vmem_utilization_percent, vmem_fixed, vmem_fixed_percent, update_dttm) VALUES ('butthead', 1444, 'test_group', 2, 0, 0, 0, 0, 0, 0, '2022-07-27 13:01:15.702117');
INSERT INTO gp.res_group_status (database_name, res_group_id, res_group_name, concurrency, cpu_utilization, cpu_utilization_percent, vmem_utilization, vmem_utilization_percent, vmem_fixed, vmem_fixed_percent, update_dttm) VALUES ('butthead', 6437, 'default_group', 50, 0, 0.08, 768, 0.07, 12672, 1.21, '2022-07-27 13:01:15.702117');
INSERT INTO gp.res_group_status (database_name, res_group_id, res_group_name, concurrency, cpu_utilization, cpu_utilization_percent, vmem_utilization, vmem_utilization_percent, vmem_fixed, vmem_fixed_percent, update_dttm) VALUES ('butthead', 6438, 'admin_group', 60, 45, 22.77, 14124, 3.16, 71613, 16.01, '2022-07-27 13:01:15.702117');


INSERT INTO gp.query_activity (database_name, pid, sess_id, res_group_id, user_name, query, query_start, query_waiting,
                               update_dttm)
VALUES ( 'butthead', 576332, 912356, 6438, 'robot-taxi-tst-gpadm', '
    SELECT prg.oid                                                                                  AS resgroupid
       , rgs.rsgname
       , prc1.value::INT AS concurrency
       , round(rgs.cpu, 0) AS cpu_used
       , round((rgs.cpu::NUMERIC / (rgs.host_count * 56 * (prc2.value::NUMERIC / 100))) * 100, 2) AS cpu_used_prc
       , round((rgs.memory_used::NUMERIC / rgs.memory_available::NUMERIC) * 100, 2) AS vmem_used_prc
       , round((rgs.memory_fixed::NUMERIC / rgs.memory_available::NUMERIC) * 100, 2) AS vmem_fixed_prc
       , round(rgs.memory_used, 2) AS memory_used
       , round(rgs.memory_fixed, 2) AS memory_fixed
        FROM (SELECT rsgname
           ', '2022-07-26 18:19:35.000000', false, '2022-07-26 18:19:35.142024');
INSERT INTO gp.query_activity (database_name, pid, sess_id, res_group_id, user_name, query, query_start, query_waiting,
                               update_dttm)
VALUES ('butthead', 548091, 911396, 6437, 'vasilevel', 'with saved_age as (select greatest(coalesce(nullif(greatest(pg_catalog.age(pg_catalog.xidin(pg_catalog.int8out($1))), -1), -1), 2147483647), coalesce(nullif(greatest(pg_catalog.age(pg_catalog.xidin(pg_catalog.int8out($2))), -1), -1), 2147483647)) as "value")
select pg_catalog.age(C.last_tx) <= (case when SA."value" < 0 then 2147483647 else SA."value" end) as has_changes from
(
  select X.last_tx as last_tx
  from (
    (
    select xmin as last_tx
      from pg_catalog.pg_type
      where typnamespace = $3::oid
      order by pg_catalog.age(xmin)
      limit 1
    )
    union all
    (
    select E.xmin as last_tx
      from pg_catalog.pg_exttable E
        join pg_catalog.pg_class C on E.reloid = C.oid
      where C.relnamespace = $4::oid
      order by pg_catalog.age(E.xmin)
      limit 1
    )
    union all
    (
    select xmin as last_tx
      from pg_catalog.pg_class
      where relnamespace = $5::oid
      order by pg_catalog.age(xmin)
      limit 1
    )
    union all
    (
    select xmin as last_tx', '2022-07-26 18:19:33.000000', false, '2022-07-26 18:19:35.142024');
INSERT INTO gp.query_activity (database_name, pid, sess_id, res_group_id, user_name, query, query_start, query_waiting, update_dttm) VALUES ('ritchie', 355836, 111025, 6438, 'robot-taxi-gpadmin', '
        ANALYZE "rep"."amr_dm_amr_geo_tariff_1_prt_daily_2_prt_2021";
    ', '2022-07-26 18:19:11.000000', false, '2022-07-26 18:19:35.944444');
INSERT INTO gp.query_activity (database_name, pid, sess_id, res_group_id, user_name, query, query_start, query_waiting, update_dttm) VALUES ('ritchie', 360705, 111741, 16392, 'etl', 'SELECT * FROM ctl.loader_period_snapshot(''stg.taxi_ods_blocklist_event_log_5677b049df'',''taxi_ods_blocklist.event_log'',''utc_event_dttm'',''2022-07-23 00:00:00.000000'',''2022-07-24 23:59:59.999999'')', '2022-07-26 18:18:14.000000', false, '2022-07-26 18:19:35.944444');
