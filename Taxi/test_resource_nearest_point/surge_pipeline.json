{
  "consumer": "taxi-surge",
  "name": "test_pipeline_name",
  "stages": [
    {
      "conditions": [],
      "in_bindings": [
        {
          "children": [
            {
              "query": "point_a"
            }
          ],
          "domain": "input",
          "query": "request"
        }
      ],
      "name": "resource_fetch",
      "resources": [
        {
          "field": "nearest_point_by_loc",
          "name": "nearest_point"
        },
        {
          "field": "nearest_point_by_id",
          "name": "nearest_point"
        }
      ],
      "source_code": "return {nearest_point_by_id: {point: point_a, max_radius_m: 10000, category: 'econom', position_id: 'chosen_id'}, nearest_point_by_loc: {point: point_a, max_radius_m: 10000, category: 'econom'}}"
    },
    {
      "conditions": [],
      "in_bindings": [
        {
          "children": [
            {
              "query": "point_a"
            }
          ],
          "domain": "input",
          "query": "request"
        }
      ],
      "name": "resource_fetch_points",
      "resources": [
        {
          "field": "nearest_points_by_loc",
          "name": "nearest_points"
        },
        {
          "field": "nearest_points_by_id",
          "name": "nearest_points"
        }
      ],
      "source_code": "return {nearest_points_by_id: {point: point_a, max_radius_m: 10000, categories: ['econom'], position_ids: ['chosen_id', 'other_id']}, nearest_points_by_loc: {point: point_a, max_radius_m: 10000, categories: ['econom', 'vip'], max_result_points: 2}}"
    },
    {
      "conditions": [],
      "in_bindings": [],
      "name": "add_classes",
      "out_bindings": [
        {
          "alias": "data",
          "query": "classes"
        }
      ],
      "source_code": "return {data: {econom: {surge: {value: 1}, value_raw: 1, name: 'econom'}, vip: {surge: {value: 1}, value_raw: 1, name: 'vip'}}};"
    }
  ],
  "state": "active"
}
