{
  "docs": [
    {
      "data": {
        "base_amount": "20000",
        "commission_at": "2019-11-20T15:13:02.832000+00:00",
        "currency": "RUB",
        "driver": {
          "driver_uuid": "769ce26febec46b0a16eee7a560d7eda",
          "park_id": "7ad36bc7560449998acbe2c57a75c293"
        },
        "driver_work_mode": "driver_fix",
        "event_version": 1,
        "schema_version": "v1"
      },
      "doc_id": 1006,
      "event_at": "2019-11-20T15:13:02.832000+00:00",
      "external_event_ref": "<external_event_ref>",
      "external_obj_id": "<external_obj_id>",
      "kind": "park_commission",
      "service": "billing-orders",
      "status": "new"
    }
  ],
  "expected_accounts": [
    {
      "account_id": 1,
      "agreement_id": "taxi/yandex_ride/mode/driver_fix",
      "currency": "RUB",
      "entity_external_id": "taximeter_driver_id/7ad36bc7560449998acbe2c57a75c293/769ce26febec46b0a16eee7a560d7eda",
      "expired": "9999-12-31T23:59:59.999999+00:00",
      "opened": "2018-10-10T09:56:13.758202Z",
      "sub_account": "commission/park"
    },
    {
      "account_id": 2,
      "agreement_id": "taxi/yandex_ride/mode/driver_fix",
      "currency": "RUB",
      "entity_external_id": "taximeter_park_id/7ad36bc7560449998acbe2c57a75c293",
      "expired": "9999-12-31T23:59:59.999999+00:00",
      "opened": "2018-10-10T09:56:13.758202Z",
      "sub_account": "commission/park"
    },
    {
      "account_id": 3,
      "agreement_id": "taxi/driver_balance",
      "currency": "RUB",
      "entity_external_id": "taximeter_driver_id/7ad36bc7560449998acbe2c57a75c293/769ce26febec46b0a16eee7a560d7eda",
      "expired": "9999-12-31T23:59:59.999999+00:00",
      "opened": "2018-10-10T09:56:13.758202Z",
      "sub_account": "total"
    },
    {
      "account_id": 4,
      "agreement_id": "taxi/yandex_ride+0/mode/driver_fix",
      "currency": "RUB",
      "entity_external_id": "taximeter_driver_id/7ad36bc7560449998acbe2c57a75c293/769ce26febec46b0a16eee7a560d7eda",
      "expired": "9999-12-31T23:59:59.999999+00:00",
      "opened": "2018-10-10T09:56:13.758202Z",
      "sub_account": "commission/park"
    }
  ],
  "expected_docs": [
    {
      "data": {
        "entries_count": 3,
        "entries_max_event_at": "2019-11-20T15:13:02.832000+00:00",
        "entries_min_event_at": "2019-11-20T15:13:02.832000+00:00",
        "version": 1
      },
      "event_at": "2019-11-20T15:13:02.832000+00:00",
      "external_event_ref": "1006/handled",
      "external_obj_id": "<external_obj_id>/process",
      "journal_entries": [
        {
          "account_id": 1,
          "amount": "-2000.0",
          "details": {},
          "event_at": "2019-11-20T15:13:02.832000+00:00",
          "reason": ""
        },
        {
          "account_id": 2,
          "amount": "-2000.0",
          "details": {
            "driver": {
              "driver_uuid": "769ce26febec46b0a16eee7a560d7eda"
            }
          },
          "event_at": "2019-11-20T15:13:02.832000+00:00",
          "reason": ""
        },
        {
          "account_id": 3,
          "amount": "-2000.0",
          "details": {},
          "event_at": "2019-11-20T15:13:02.832000+00:00",
          "reason": ""
        }
      ],
      "kind": "journal",
      "service": "billing-calculators",
      "status": "complete"
    },
    {
      "data": {
        "entries_count": 1
      },
      "event_at": "2019-11-20T15:13:02.832000+00:00",
      "external_event_ref": "1006/income_entries_created",
      "external_obj_id": "<external_obj_id>/process",
      "journal_entries": [
        {
          "account_id": 4,
          "amount": "-2000.0",
          "details": {},
          "event_at": "2019-11-20T15:13:02.832000+00:00",
          "reason": ""
        }
      ],
      "kind": "income_journal",
      "service": "billing-calculators",
      "status": "complete"
    }
  ],
  "expected_entities": [
    {
      "external_id": "taximeter_driver_id/7ad36bc7560449998acbe2c57a75c293/769ce26febec46b0a16eee7a560d7eda",
      "kind": "driver"
    },
    {
      "external_id": "taximeter_park_id/7ad36bc7560449998acbe2c57a75c293",
      "kind": "park"
    },
    {
      "external_id": "taximeter_driver_id/7ad36bc7560449998acbe2c57a75c293/769ce26febec46b0a16eee7a560d7eda",
      "kind": "driver"
    }
  ],
  "expected_tlog_entries": [],
  "reports": {
    "docs/select": {
      "docs": []
    },
    "journal/search": {
      "entries": [
        {
          "account": {
            "account_id": 1,
            "agreement_id": "taxi/yandex_ride/mode/driver_fix",
            "currency": "RUB",
            "entity_external_id": "taximeter_driver_id/7ad36bc7560449998acbe2c57a75c293/769ce26febec46b0a16eee7a560d7eda",
            "sub_account": "commission/park"
          },
          "account_id": 1,
          "amount": "-2000.0",
          "details": {},
          "doc_ref": "2001",
          "entry_id": 20011,
          "event_at": "2019-11-20T15:13:02.832000+00:00",
          "reason": ""
        },
        {
          "account": {
            "account_id": 2,
            "agreement_id": "taxi/yandex_ride/mode/driver_fix",
            "currency": "RUB",
            "entity_external_id": "taximeter_park_id/7ad36bc7560449998acbe2c57a75c293",
            "sub_account": "commission/park"
          },
          "amount": "-2000.0",
          "details": {
            "driver": {
              "driver_uuid": "769ce26febec46b0a16eee7a560d7eda"
            }
          },
          "doc_ref": "2001",
          "entry_id": 20012,
          "event_at": "2019-11-20T15:13:02.832000+00:00",
          "reason": ""
        },
        {
          "account": {
            "account_id": 3,
            "agreement_id": "taxi/driver_balance",
            "currency": "RUB",
            "entity_external_id": "taximeter_driver_id/7ad36bc7560449998acbe2c57a75c293/769ce26febec46b0a16eee7a560d7eda",
            "sub_account": "total"
          },
          "amount": "-2000.0",
          "details": {},
          "doc_ref": "2001",
          "entry_id": 20013,
          "event_at": "2019-11-20T15:13:02.832000+00:00",
          "reason": ""
        }
      ]
    }
  }
}
