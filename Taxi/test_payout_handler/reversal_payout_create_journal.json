{
  "existing_accounts": [
    {
      "account_id": 1,
      "agreement_id": "taxi/yandex_ride",
      "currency": "RUB",
      "entity_external_id": "taximeter_driver_id/7f74df/1086f4",
      "sub_account": "promocode/compensation"
    },
    {
      "account_id": 2,
      "agreement_id": "taxi/yandex_ride",
      "currency": "RUB",
      "entity_external_id": "taximeter_park_id/7f74df",
      "sub_account": "promocode/compensation"
    },
    {
      "account_id": 3,
      "agreement_id": "taxi/driver_balance",
      "currency": "RUB",
      "entity_external_id": "taximeter_driver_id/7f74df/1086f4",
      "sub_account": "total"
    },
    {
      "account_id": 4,
      "agreement_id": "taxi/driver_balance",
      "currency": "RUB",
      "entity_external_id": "taximeter_park_id/7f74df",
      "sub_account": "total/driver_id/1086f4"
    },
    {
      "account_id": 5,
      "agreement_id": "tlog",
      "currency": "USD",
      "entity_external_id": "billing_client_id/77777",
      "sub_account": "coupon"
    }
  ],
  "expected_docs_with_accounts": [
    {
      "data": {
        "entries_count": 5,
        "entries_max_event_at": "2019-09-13T13:00:00.000000+00:00",
        "entries_min_event_at": "2019-09-13T13:00:00.000000+00:00",
        "version": 1
      },
      "event_at": "2019-09-13T13:00:00.000000+00:00",
      "external_event_ref": "12343/reversed",
      "external_obj_id": "taxi/process/promocode/event_id",
      "journal_entries": [
        {
          "account": {
            "account_id": 1,
            "agreement_id": "taxi/yandex_ride",
            "currency": "RUB",
            "entity_external_id": "taximeter_driver_id/7f74df/1086f4",
            "sub_account": "promocode/compensation"
          },
          "amount": "-100.0",
          "details": {
            "alias_id": "300226c453c54b099f3f5aa64fbc1ac4",
            "reverse_entry_id": 11
          },
          "event_at": "2019-09-13T13:00:00.000000+00:00",
          "reason": ""
        },
        {
          "account": {
            "account_id": 2,
            "agreement_id": "taxi/yandex_ride",
            "currency": "RUB",
            "entity_external_id": "taximeter_park_id/7f74df",
            "sub_account": "promocode/compensation"
          },
          "amount": "-100.00",
          "details": {
            "alias_id": "300226c453c54b099f3f5aa64fbc1ac4",
            "driver": {
              "driver_uuid": "1086f4"
            },
            "reverse_entry_id": 21
          },
          "event_at": "2019-09-13T13:00:00.000000+00:00",
          "reason": ""
        },
        {
          "account": {
            "account_id": 3,
            "agreement_id": "taxi/driver_balance",
            "currency": "RUB",
            "entity_external_id": "taximeter_driver_id/7f74df/1086f4",
            "sub_account": "total"
          },
          "amount": "-100.0",
          "details": {
            "alias_id": "300226c453c54b099f3f5aa64fbc1ac4",
            "reverse_entry_id": 31
          },
          "event_at": "2019-09-13T13:00:00.000000+00:00",
          "reason": ""
        },
        {
          "account": {
            "account_id": 4,
            "agreement_id": "taxi/driver_balance",
            "currency": "RUB",
            "entity_external_id": "taximeter_park_id/7f74df",
            "sub_account": "total/driver_id/1086f4"
          },
          "amount": "-100.0",
          "details": {
            "alias_id": "300226c453c54b099f3f5aa64fbc1ac4",
            "driver": {
              "driver_uuid": "1086f4"
            },
            "reverse_entry_id": 41
          },
          "event_at": "2019-09-13T13:00:00.000000+00:00",
          "reason": ""
        },
        {
          "account": {
            "account_id": 5,
            "agreement_id": "tlog",
            "currency": "USD",
            "entity_external_id": "billing_client_id/77777",
            "sub_account": "coupon"
          },
          "amount": "-2.5",
          "details": {
            "alias_id": "abcdef",
            "billing_client_id": 77777,
            "due": "2019-09-12T11:30:00.000000+00:00",
            "handled_in_trust_flow": true,
            "is_payable": false,
            "reverse_entry_id": 51,
            "service_id": 123,
            "service_transaction_id": 1234567890,
            "transaction_type": "refund"
          },
          "event_at": "2019-09-13T13:00:00.000000+00:00",
          "reason": ""
        }
      ],
      "kind": "journal/reversal",
      "service": "billing-calculators",
      "status": "new"
    }
  ],
  "expected_entities": [],
  "journal_doc_parameters": {
    "external_event_ref": "12343/reversed",
    "kind": "journal/reversal"
  },
  "payout": {
    "base_doc_id": 123456,
    "entries": [
      {
        "account_id": 1,
        "agreement_id": "taxi/yandex_ride",
        "amount": "-100.0",
        "currency": "RUB",
        "details": {
          "alias_id": "300226c453c54b099f3f5aa64fbc1ac4",
          "reverse_entry_id": 11
        },
        "entity_external_id": "taximeter_driver_id/7f74df/1086f4",
        "entity_kind": "driver",
        "sub_account": "promocode/compensation"
      },
      {
        "account_id": 2,
        "agreement_id": "taxi/yandex_ride",
        "amount": "-100.00",
        "currency": "RUB",
        "details": {
          "alias_id": "300226c453c54b099f3f5aa64fbc1ac4",
          "driver": {
            "driver_uuid": "1086f4"
          },
          "reverse_entry_id": 21
        },
        "entity_external_id": "taximeter_park_id/7f74df",
        "entity_kind": "park",
        "sub_account": "promocode/compensation"
      },
      {
        "account_id": 3,
        "agreement_id": "taxi/driver_balance",
        "amount": "-100.0",
        "currency": "RUB",
        "details": {
          "alias_id": "300226c453c54b099f3f5aa64fbc1ac4",
          "reverse_entry_id": 31
        },
        "entity_external_id": "taximeter_driver_id/7f74df/1086f4",
        "entity_kind": "driver",
        "sub_account": "total"
      },
      {
        "account_id": 4,
        "agreement_id": "taxi/driver_balance",
        "amount": "-100.0",
        "currency": "RUB",
        "details": {
          "alias_id": "300226c453c54b099f3f5aa64fbc1ac4",
          "driver": {
            "driver_uuid": "1086f4"
          },
          "reverse_entry_id": 41
        },
        "entity_external_id": "taximeter_park_id/7f74df",
        "entity_kind": "park",
        "sub_account": "total/driver_id/1086f4"
      },
      {
        "account_id": 5,
        "agreement_id": "tlog",
        "amount": "-2.5",
        "currency": "USD",
        "details": {
          "alias_id": "abcdef",
          "billing_client_id": 77777,
          "due": "2019-09-12T11:30:00.000000+00:00",
          "handled_in_trust_flow": true,
          "is_payable": false,
          "reverse_entry_id": 51,
          "service_id": 123,
          "service_transaction_id": 1234567890,
          "transaction_type": "refund"
        },
        "entity_external_id": "billing_client_id/77777",
        "entity_kind": "park",
        "sub_account": "coupon"
      }
    ],
    "event_at": "2019-09-13T13:00:00.000000+00:00",
    "external_obj_id": "taxi/process/promocode/event_id",
    "kind": "promocode",
    "payout_doc_id": 12343,
    "topic_begin_at": "2019-09-13T09:00:00.000000+00:00",
    "version": 1
  }
}
