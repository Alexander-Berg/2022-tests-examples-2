settings:
    collection: surge_maps
    connection: surge_analytics
    database: dbsurge_analytics
indexes:
  - key:
      - name: show_min
        type: hashed
  - key:
      - name: tlbr
        type: 2dsphere
  - expireAfterSeconds: 604800
    key: ts
wiki_info: |
    ####dbsurge_analytics.surge_maps - Расчитаная карта сглаженного суржа

    Коллекция хранит результаты работы джобы surge_cells_calc (сейчас только карту для водителей). Записи имеют TTL в 1 неделю.

    ```python
    doc = {
        'show_min': Date, # примерная минута (без секунд), начиная с которой карта начинает отображаться водителю
        'ts': Date,  # таймстемп расчета карты
        'region_id': '15483872686501937754',  # идентификатор гексагональной сетки
        'distribution_id': '15483872686501937754_1522110192',  # идентификатор распределения (карты)
        'cell_size': 250.0, # размер гексагона (диаметр)
        'type': 'driver', # тип карты (сейчас возможен только driver)
        'class': '__default__', # тариф
        'legend_min': 1.1404411265727228, # минимальное значение на карте
        'legend_max': 2.659128070637162, # максимальное значение на карте
        'legend_str': '1.1 - 2.7', # строка легенды для отображения
        'tlbr': { # tlbr области. представлено в формате полигона, чтобы можно было искать по гео-индексу
            'type': 'Polygon',
            'coordinates': [
                [37.13559184191819, 55.47237016351613],
                [37.13559184191819, 56.00346045711328],
                ...
                [37.13559184191819, 55.47237016351613],
            ]
        },
        'areas': [ # названия областей (surge_price_areas), входящих в карту
            'MSK-Yandex HQ',
            ...
        ],
        'cells_count': 6567, # количество непустых гексагонов
        'cells': <bin data> # гексагоны в формате flatbuffers
    }
    ```
