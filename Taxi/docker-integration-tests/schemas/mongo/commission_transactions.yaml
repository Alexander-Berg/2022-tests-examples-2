description: transaction log of commission changes
settings:
    collection: commission_transactions
    connection: billing
    database: dbbilling
indexes:
  - key:
      - name: a
        type: ascending
      - name: v
        type: descending
    unique: true
  - key:
      - name: c
        type: ascending
      - name: cl
        type: ascending
wiki_info: |
    #### commission_transactions

    *Назначение:* содержит информацию об изменениях комиссии.

    *Структура документа*:
    ```python
    {
        # id заказа
        'o': '0123456789abcdef',

        # alias_id заказа
        'a': '0123456789abcdef',

        # версия, у одного alias_id не может быть одинаковых версий
        'v': 2,

        # время создания документа, naive utc
        'c': datetime.datetime.utcnow(),

        # клид парка-исполнителя
        'cl': '12345',

        # id водителя
        'du': 'some_driver_uuid',

        # предыдущее значение комиссии
        'pv': '0.0'

        # текущее значение комиссии
        'cv': '21.89',

        # предыдущее значение комиссии с НДС
        'pvwv': '0.0,

        # текущее значение комиссии с НДС
        'cvwv': '25.8302',

        # предыдущее значение комиссии без скидки с НДС
        'pvwdwv': '0.0',

        # текущее значение комиссии без скидки с НДС
        'cvwdwv': '0.0',

        # предыдущее значение комиссии без скидки
        'pvwd': '0.0',

        # текущее значение комиссии без скидки
        'cvwd': '0.0',

        # предудущее значение агентского вознаграждения
        'prag': '0.0,

        # текущее значение агентского вознаграждения
        'curag': '0.0323',

        # предыдущее значение эквайринга
        'prac': '0.0323',

        # текущее значение эквайринга
        'curac': '0.0323',

        # сумма, от которой считали комиссию
        'cos': '199',

        # db_id парка
        'db_id': 'fdflkj34lkjfhs2kjvcbnxm',

        # заказ отменен пользователем? (bool)
        'cbu': 'True|False|<empty>',

        # валюта
        'cur': 'RUB',

        # класс тарифа
        'trfc': 'econom',

        # время подачи заказа (request.due), naive utc
       'due': datetime.datetime.utcnow(),

        # Человеко-читаемый текст с причиной изменения комиссии. Например,
        # taxi_tasks/billing.py выставит здесь 'r': 't_t/b.py'
        'r': 't_t/b.py',
        # Дополнительная комиссия, например, за пул
        # (cv включает в себя это значение)
        'ecs': '1.234',

        # комиссия за найм (необязательное поле, по умолчанию 0; не учитывается в cv)
        'hiring_commission': '2.2342',

        # скидка на стоимость поездки по схеме B2B
        'rebate': '0.00',

        # предыдущее значение скидки на стоимость поездки по схеме B2B
        'prev_rebate': '0.00',

        # комиссия за заказ такси через КЦ
        'callcenter_commission': '0.00',

        # предыдущее значение комиссии за заказ такси через КЦ
        'prev_callcenter_commission': '0.00'

        # комиссия за поездку по предоплаченному ваучеру
        'voucher_commission': '0.00',

        # предыдущее значение комиссии за поездку по предоплаченному ваучеру
        'prev_voucher_commission': '0.00',

        # значение комиссии для парка (без НДС)
        'park_commission': '0.00',

        # абсолютное значение НДС в комиссии для парка
        'park_commission_vat': '0.00',
    }
    ```
