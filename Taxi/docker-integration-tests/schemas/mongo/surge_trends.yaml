settings:
    collection: surge_trends
    connection: misc
    database: dbmisc
indexes:
  - expireAfterSeconds: 604800
    key: created
  - key:
      - name: lat
        type: ascending
      - name: lon
        type: ascending
      - name: prediction_ts
        type: ascending
wiki_info: |
    ####dbtaxi.surge_trends - Предсказание поведения суржка по точкам и времени

    Коллекция содержит документы с предсказаниями суржа. Данные перегоняются из CRM раз в день.
    Документ представляет тренд суржа в некоторой точке [lat, lon] в момент времени prediction_ts.

    Моменты времени prediction_ts округлены до 15 минут в меньшую сторону.
    Координаты lan и lon округлены до 2 знаков после запятой и умножены на 100.

    Алгоритм работы с коллекцией следующий:
    _Пусть есть точка `А` и момент времени `due`.
    Необходимо вычислить прогноз суржа._

    Ищем документ, где
    1. `lat` =` A.lat`, округленная до 2 знаков и умноженная на 100
    1. `lon` =` A.lon`, округленная до 2 знаков и умноженная на 100
    2. `due - 15` < `prediction_ts` <` due` _// 15 - интервал предсказаний_

    Документ выглядит следующим образом:
    ```python
    doc = {
        'created': datetime.datetime,             # время создания записи
        'lat': 4277,                              # широта точки для которой осуществляется прогноз
        'lon': 13285,                             # долгота точки для которой осуществляется прогноз
        'prediction_ts': datetime.datetime,       # момент времени, на который осуществлен прогноз
        'status': 'down',                         # тренд прогноза (up, down, same)
        'surge': 1.1,                             # прогноз значения суржа в момент prediction_ts
    }
    ```
