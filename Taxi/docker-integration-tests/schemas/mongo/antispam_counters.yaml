description: antispam CAS-counters
settings:
    collection: antispam_counters
    connection: taxi
    database: dbtaxi
indexes:
  - expireAfterSeconds: 3600
    key: updated
wiki_info: |
    #### antispam_counters
    *Назначение:* Коллекция используется для проверки на антиспам.
    В коллекции для каждого ключа хранится список обращений к этому ключу.
    В коллекции установлен TTL-индекс на
    поле updated с временем жизни 1 час.

    *Структура документа:*

    ```python
    antispam_counters = {
    #Идентификатор документа
    "_id" : "couponcheck_449798721",
    #Время обновления документа
    "updated" : datetime.datetime.now(),
    #Поле, используемое для игнорирования обращений с одинаковым ключом.
    #Например, если пользователь пытается использовать промокод, то попытки использования одного и того же
    #промокода игнорируются, а считаются только попытки использования различных промокодов.
    "ignore_tag" : null,
    #Список обращений по идентификатору
    "attempt_timestamps" : [
            ISODate("2017-01-23T12:16:17.116Z"),
            ISODate("2017-01-23T12:16:25.315Z"),
            ISODate("2017-01-23T12:16:29.820Z"),
            ISODate("2017-01-23T12:16:55.693Z"),
            ISODate("2017-01-23T12:31:11.843Z"),
            ISODate("2017-01-23T12:52:38.150Z"),
            ISODate("2017-01-23T12:52:48.245Z"),
            ISODate("2017-01-23T12:52:49.570Z"),
            ISODate("2017-01-23T12:52:54.530Z"),
            ISODate("2017-01-23T12:52:56.840Z"),
            ISODate("2017-01-23T12:56:40.141Z"),
            ISODate("2017-01-23T12:56:55.386Z"),
            ISODate("2017-01-23T12:56:59.093Z"),
            ISODate("2017-01-23T12:57:03.954Z"),
            ISODate("2017-01-23T12:57:29.889Z"),
            ISODate("2017-01-23T13:31:42.078Z")
    ]
    }
    ```
