{
  "schemas": [
    {
      "default_path": "",
      "json_schema": {
        "additionalProperties": false,
        "properties": {
          "project": {
            "description": "Имя проекта",
            "type": "string"
          },
          "provider_name": {
            "type": "string"
          },
          "value": {
            "description": "Секретный токен",
            "oneOf": [
              {
                "format": "json",
                "type": "string"
              },
              {
                "type": "null"
              }
            ]
          }
        },
        "required": [
          "project",
          "provider_name",
          "value"
        ],
        "type": "object"
      },
      "name_template": "API_TOKEN_{{ project }}_{{ provider_name }}",
      "secret_fields": [
        "value"
      ],
      "secret_template": "{{ value }}",
      "type_name": "api_token"
    },
    {
      "default_path": "{\n  \"clickhouse_settings\": {\n    {{ value }}\n  }\n}",
      "json_schema": {
        "additionalProperties": false,
        "properties": {
          "cluster_name": {
            "description": "mdb id кластера",
            "type": "string"
          },
          "hosts": {
            "items": {
              "additionalProperties": false,
              "properties": {
                "fqdn": {
                  "description": "fqdn",
                  "type": "string"
                }
              },
              "required": [
                "fqdn"
              ],
              "type": "object"
            },
            "type": "array"
          },
          "password": {
            "description": "пароль",
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ]
          },
          "port_client": {
            "description": "порт клиента",
            "type": "string"
          },
          "port_http": {
            "description": "порт HTTP",
            "type": "string"
          },
          "project": {
            "description": "Имя проекта",
            "type": "string"
          },
          "provider_name": {
            "type": "string"
          },
          "service_name": {
            "description": "сервис потребитель секрета",
            "type": "string"
          },
          "user": {
            "description": "username пользователь",
            "type": "string"
          }
        },
        "required": [
          "project",
          "provider_name",
          "hosts"
        ],
        "type": "object"
      },
      "name_template": "CLICKHOUSE_{{ project }}_{{ service_name }}_{{ provider_name }}",
      "secret_fields": [
        "password"
      ],
      "secret_template": "\"{{ provider_name }}\": {\n    \"hosts\": [\n        {% for host in hosts %}\n            \"{{ host.fqdn }}\"{% if not loop.last %},{% endif %}\n        {% endfor %}\n    ],\n    \"port_http\": {{ port_http }},\n    \"port_client\": {{ port_client }},\n    \"cluster_name\": \"{{ cluster_name }}\",\n    \"user\": \"{{ user }}\",\n    \"password\": \"{{ password }}\"\n}",
      "type_name": "clickhouse"
    },
    {
      "default_path": "{\n  \"elasticsearch_settings\": {\n    {{ value }}\n  }\n}",
      "json_schema": {
        "additionalProperties": false,
        "properties": {
          "auth_profiles": {
            "additionalProperties": {
              "additionalProperties": false,
              "properties": {
                "password": {
                  "description": "Пароль",
                  "type": "string"
                },
                "type": {
                  "description": "Тип аутентификации",
                  "type": "string"
                },
                "user": {
                  "description": "Имя пользователя",
                  "type": "string"
                }
              },
              "required": [
                "type",
                "password"
              ],
              "type": "object"
            },
            "type": "object"
          },
          "cluster_name": {
            "description": "Имя кластера es",
            "type": "string"
          }
        },
        "required": [
          "cluster_name",
          "auth_profiles"
        ],
        "type": "object"
      },
      "name_template": "ELASTICSEARCH_{{ cluster_name }}",
      "secret_fields": [
        "auth_profiles.*.password"
      ],
      "secret_template": "\"{{ cluster_name }}\": {\n    \"auth_profiles\": {\n        {% for name, data in auth_profiles.items() %}\n            \"{{ name }}\": {\n                \"type\": \"{{ data.type }}\",\n                {% if data.user %}\"user\": \"{{ data.user }}\",{% endif %}\n                \"password\": \"{{ data.password }}\"\n            }{% if not loop.last %},{% endif %}\n        {% endfor %}\n    }\n}",
      "type_name": "elasticsearch"
    },
    {
      "default_path": "",
      "json_schema": {
        "additionalProperties": false,
        "properties": {
          "name": {
            "description": "Название секрета",
            "type": "string"
          },
          "value": {
            "description": "Произвольное секретное значение",
            "format": "json",
            "type": "string"
          }
        },
        "required": [
          "name",
          "value"
        ],
        "type": "object"
      },
      "name_template": "FREEFORM_{{ name }}",
      "secret_fields": [
        "value"
      ],
      "secret_template": "{{ value }}",
      "type_name": "freeform"
    },
    {
      "default_path": "{\n  \"mongo_settings\": {\n    {{ value }}\n  }\n}",
      "json_schema": {
        "additionalProperties": false,
        "properties": {
          "db_name": {
            "description": "Имя базы",
            "type": "string"
          },
          "host": {
            "description": "Хост",
            "type": "string"
          },
          "password": {
            "description": "Пароль",
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ]
          },
          "port": {
            "description": "Порт",
            "type": "string"
          },
          "project": {
            "description": "Имя проекта",
            "type": "string"
          },
          "provider_name": {
            "type": "string"
          },
          "user": {
            "description": "Пользователь",
            "type": "string"
          }
        },
        "required": [
          "project",
          "provider_name",
          "user",
          "host",
          "port",
          "db_name"
        ],
        "type": "object"
      },
      "name_template": "MONGODB_{{ project }}_{{ provider_name }}",
      "secret_fields": [
        "password"
      ],
      "secret_template": "\"{{ provider_name }}\": {\n  \"uri\": \"mongodb://{{ user }}:{{ password }}@{{ host }}:{{ port }}/{{ db_name }}\"\n}",
      "type_name": "mongodb"
    },
    {
      "default_path": "{\n  \"mongo_settings\": {\n    {{ value }}\n  }\n}",
      "json_schema": {
        "additionalProperties": false,
        "properties": {
          "db_name": {
            "description": "Имя базы для аутентификации",
            "type": "string"
          },
          "hostlist": {
            "description": "Набор хостов вида host1[:port1][,...hostN[:portN]]",
            "pattern": "^([^:,]+(:[0-9]+)?){1}(,([^:,]+(:[0-9]+)?){1}){0,}$",
            "type": "string"
          },
          "options": {
            "description": "Опции подключения вида name1=value1&name2=value2",
            "pattern": "^([^=&]+=[^=&]+){1}((&[^=&]+=[^=&]+){1}){0,}$",
            "type": "string"
          },
          "password": {
            "description": "Пароль",
            "type": "string"
          },
          "project": {
            "description": "Имя проекта",
            "type": "string"
          },
          "provider_name": {
            "description": "Ключ в секдисте",
            "type": "string"
          },
          "user": {
            "description": "Пользователь",
            "type": "string"
          }
        },
        "required": [
          "project",
          "provider_name",
          "user",
          "password",
          "hostlist",
          "db_name"
        ],
        "type": "object"
      },
      "name_template": "MONGOS_PROXY_{{ project }}_{{ provider_name }}_{{ user }}",
      "secret_fields": [
        "password"
      ],
      "secret_template": "\"{{ provider_name }}\": {\n{% if options is defined %}\n  \"uri\": \"mongodb://{{ user }}:{{ password }}@{{ hostlist }}/{{ db_name }}?{{ options }}\"\n{% else %}\n  \"uri\": \"mongodb://{{ user }}:{{ password }}@{{ hostlist }}/{{ db_name }}\"\n{% endif %}\n}",
      "type_name": "mongos_proxy"
    },
    {
      "default_path": "{\n  \"settings_override\": {\n    \"mssql\": {\n      \"connections\": {\n        {{ value }}}\n    }\n  }\n}",
      "json_schema": {
        "additionalProperties": false,
        "properties": {
          "project": {
            "description": "Имя проекта",
            "type": "string"
          },
          "provider_name": {
            "description": "Имя кластера базы",
            "type": "string"
          },
          "shards": {
            "items": {
              "additionalProperties": false,
              "properties": {
                "database": {
                  "description": "Имя базы",
                  "type": "string"
                },
                "host": {
                  "description": "Хост базы",
                  "type": "string"
                },
                "password": {
                  "description": "Пароль для коннекта к базе",
                  "type": "string"
                },
                "port": {
                  "description": "Порт для подключения к базе",
                  "type": "string"
                },
                "user": {
                  "description": "Имя пользователя базы",
                  "type": "string"
                }
              },
              "required": [
                "database",
                "host",
                "password",
                "port",
                "user"
              ],
              "type": "object"
            },
            "type": "array"
          }
        },
        "required": [
          "project",
          "provider_name",
          "shards"
        ],
        "type": "object"
      },
      "name_template": "MSSQL_{{ project }}_{{ provider_name }}",
      "secret_fields": [
        "shards.$.password"
      ],
      "secret_template": "\"{{ provider_name }}\": [\n    {% for shard in shards %}\n    {\n        \"database\": \"{{ shard.database }}\",\n        \"host\": \"{{ shard.host }}\",\n        \"password\": \"{{ shard.password }}\",\n        \"port\": \"{{ shard.port }}\",\n        \"user\": \"{{ shard.user }}\",\n        \"shard_number\": {{ loop.index - 1 }}\n    }{% if not loop.last %},{% endif %}\n    {% endfor %}\n]",
      "type_name": "mssql"
    },
    {
      "default_path": "{\n  \"settings_override\": {\n    \"mysql\": {\n      \"connections\": {\n        {{ value }}}\n    }\n  }\n}",
      "json_schema": {
        "additionalProperties": false,
        "properties": {
          "project": {
            "description": "Имя проекта",
            "type": "string"
          },
          "provider_name": {
            "description": "Имя кластера базы",
            "type": "string"
          },
          "shards": {
            "items": {
              "additionalProperties": false,
              "properties": {
                "database": {
                  "description": "Имя базы",
                  "type": "string"
                },
                "host": {
                  "description": "Хост базы",
                  "type": "string"
                },
                "password": {
                  "description": "Пароль для коннекта к базе",
                  "type": "string"
                },
                "port": {
                  "description": "Порт для подключения к базе",
                  "type": "string"
                },
                "user": {
                  "description": "Имя пользователя базы",
                  "type": "string"
                }
              },
              "required": [
                "database",
                "host",
                "password",
                "port",
                "user"
              ],
              "type": "object"
            },
            "type": "array"
          }
        },
        "required": [
          "project",
          "provider_name",
          "shards"
        ],
        "type": "object"
      },
      "name_template": "MYSQL_{{ project }}_{{ provider_name }}",
      "secret_fields": [
        "shards.$.password"
      ],
      "secret_template": "\"{{ provider_name }}\": [\n    {% for shard in shards %}\n    {\n        \"database\": \"{{ shard.database }}\",\n        \"host\": \"{{ shard.host }}\",\n        \"password\": \"{{ shard.password }}\",\n        \"port\": \"{{ shard.port }}\",\n        \"user\": \"{{ shard.user }}\",\n        \"shard_number\": {{ loop.index - 1 }}\n    }{% if not loop.last %},{% endif %}\n    {% endfor %}\n]",
      "type_name": "mysql"
    },
    {
      "default_path": "{\n  \"settings_override\": {\n    \"oracle\": {\n      \"connections\": {\n        {{ value }}}\n    }\n  }\n}",
      "json_schema": {
        "additionalProperties": false,
        "properties": {
          "project": {
            "description": "Имя проекта",
            "type": "string"
          },
          "provider_name": {
            "description": "Имя кластера базы",
            "type": "string"
          },
          "shards": {
            "items": {
              "additionalProperties": false,
              "properties": {
                "dsn": {
                  "description": "Описание деталей коннекта к базе",
                  "type": "string"
                },
                "password": {
                  "description": "Пароль для коннекта к базе",
                  "type": "string"
                },
                "user": {
                  "description": "Имя пользователя базы",
                  "type": "string"
                }
              },
              "required": [
                "dsn",
                "user",
                "password"
              ],
              "type": "object"
            },
            "type": "array"
          }
        },
        "required": [
          "project",
          "provider_name",
          "shards"
        ],
        "type": "object"
      },
      "name_template": "ORACLE_{{ project }}_{{ provider_name }}",
      "secret_fields": [
        "shards.$.password"
      ],
      "secret_template": "\"{{ provider_name }}\": [\n    {% for shard in shards %}\n    {\n        \"dsn\": \"{{ shard.dsn }}\",\n        \"user\": \"{{ shard.user }}\",\n        \"password\": \"{{ shard.password }}\",\n        \"shard_number\": {{ loop.index - 1 }}\n    }{% if not loop.last %},{% endif %}\n    {% endfor %}\n]",
      "type_name": "oracle"
    },
    {
      "default_path": "{\n  \"postgresql_settings\": {\n    \"databases\": {\n      {{ value }}\n    }\n  }\n}",
      "json_schema": {
        "additionalProperties": false,
        "properties": {
          "project": {
            "description": "Имя проекта",
            "type": "string"
          },
          "provider_name": {
            "type": "string"
          },
          "shards": {
            "items": {
              "additionalProperties": false,
              "properties": {
                "db_name": {
                  "description": "Имя базы",
                  "type": "string"
                },
                "host": {
                  "description": "Хост",
                  "type": "string"
                },
                "password": {
                  "description": "Пароль",
                  "oneOf": [
                    {
                      "type": "string"
                    },
                    {
                      "type": "null"
                    }
                  ]
                },
                "port": {
                  "description": "Порт",
                  "type": "string"
                },
                "user": {
                  "description": "Пользователь",
                  "type": "string"
                }
              },
              "required": [
                "user",
                "host",
                "port",
                "db_name"
              ],
              "type": "object"
            },
            "type": "array"
          }
        },
        "required": [
          "project",
          "provider_name",
          "shards"
        ],
        "type": "object"
      },
      "name_template": "POSTGRES_{{ project }}_{{ provider_name }}",
      "secret_fields": [
        "shards.$.password"
      ],
      "secret_template": "\"{{ provider_name }}\": [\n    {% for shard in shards %}\n    {\n        \"shard_number\": {{ loop.index - 1 }},\n        \"hosts\": [\n            \"host={{ shard.host }} port={{ shard.port }} dbname={{ shard.db_name }} user={{ shard.user }} password={{ shard.password }} sslmode=require\"\n        ]\n    }{% if not loop.last %},{% endif %}\n    {% endfor %}\n]",
      "type_name": "postgresql"
    },
    {
      "default_path": "{\n  \"redis_settings\": {\n    {{ value }}\n  }\n}",
      "json_schema": {
        "additionalProperties": false,
        "properties": {
          "password": {
            "description": "Пароль кластера",
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ]
          },
          "project": {
            "description": "Имя проекта",
            "type": "string"
          },
          "provider_name": {
            "description": "Имя кластера",
            "type": "string"
          },
          "sentinels": {
            "items": {
              "additionalProperties": false,
              "properties": {
                "host": {
                  "description": "Имя хоста",
                  "type": "string"
                },
                "port": {
                  "description": "Номер порта на хосте",
                  "type": "string"
                }
              },
              "required": [
                "host",
                "port"
              ],
              "type": "object"
            },
            "type": "array"
          },
          "shards": {
            "items": {
              "additionalProperties": false,
              "properties": {
                "name": {
                  "description": "Имя базы",
                  "type": "string"
                }
              },
              "required": [
                "name"
              ],
              "type": "object"
            },
            "type": "array"
          }
        },
        "required": [
          "project",
          "provider_name",
          "shards",
          "sentinels",
          "password"
        ],
        "type": "object"
      },
      "name_template": "REDIS_{{ project }}_{{ provider_name }}",
      "secret_fields": [
        "password"
      ],
      "secret_template": "\"{{ provider_name }}\": {\n    \"shards\" : [\n    {% for shard in shards %}\n    {\n      \"name\": \"{{ shard.name }}\"\n    }{% if not loop.last %},{% endif %}\n    {% endfor %}\n    ],\n    \"sentinels\" : [\n    {% for sentinel in sentinels %}\n    {\n      \"host\": \"{{ sentinel.host }}\",\n      \"port\": {{ sentinel.port }}\n    }{% if not loop.last %},{% endif %}\n    {% endfor %}\n    ],\n    \"password\" : \"{{ password }}\"\n}",
      "type_name": "redis"
    },
    {
      "default_path": "{\n  \"settings_override\": {\n    {{ value }}\n  }\n}",
      "json_schema": {
        "additionalProperties": false,
        "properties": {
          "access_key_id": {
            "description": "Идентификатор ключа (AccessKeyId)",
            "type": "string"
          },
          "access_secret_key": {
            "description": "Секрет ключа (AccessSecretKey)",
            "type": "string"
          },
          "bucket": {
            "description": "Название бакета",
            "type": "string"
          },
          "host": {
            "description": "Имя хоста S3-MDS",
            "type": "string"
          },
          "project": {
            "description": "Имя проекта",
            "type": "string"
          },
          "provider_name": {
            "type": "string"
          }
        },
        "required": [
          "project",
          "provider_name",
          "host",
          "bucket",
          "access_key_id",
          "access_secret_key"
        ],
        "type": "object"
      },
      "name_template": "S3MDS_{{ project }}_{{ provider_name }}",
      "secret_fields": [
        "access_key_id",
        "access_secret_key"
      ],
      "secret_template": "{\n  \"url\": \"{{ host }}\",\n  \"bucket\": \"{{ bucket }}\",\n  \"access_key_id\": \"{{ access_key_id }}\",\n  \"secret_key\": \"{{ access_secret_key }}\"\n}",
      "type_name": "s3mds"
    },
    {
      "default_path": "{\n  \"settings_override\": {\n    \"TVM_SERVICES\": {\n      {{ value }}\n    }\n  }\n}",
      "json_schema": {
        "additionalProperties": false,
        "properties": {
          "project": {
            "description": "Имя проекта",
            "type": "string"
          },
          "provider_name": {
            "type": "string"
          },
          "secret": {
            "description": "Секрет TVM-приложения",
            "type": "string"
          },
          "tvm_id": {
            "description": "ID TVM-приложения",
            "type": "string"
          }
        },
        "required": [
          "project",
          "provider_name",
          "tvm_id",
          "secret"
        ],
        "type": "object"
      },
      "name_template": "TVM_{{ project }}_{{ provider_name }}",
      "secret_fields": [
        "secret"
      ],
      "secret_template": "{\"id\": {{ tvm_id }}, \"secret\": \"{{ secret }}\"}",
      "type_name": "tvm"
    }
  ],
  "types": [
    "api_token",
    "clickhouse",
    "elasticsearch",
    "freeform",
    "mongodb",
    "mongos_proxy",
    "mssql",
    "mysql",
    "oracle",
    "postgresql",
    "redis",
    "s3mds",
    "tvm"
  ]
}
