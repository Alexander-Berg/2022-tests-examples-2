[
  {
    "data": {
      "description": "Старое описание",
      "queue_name": "example_queue",
      "shards": [
        {
          "collection": "example_queue_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "disabled"
        },
        {
          "collection": "example_queue_1",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "disabled",
      "task_input_restriction": {
        "by_tvm_services": {
          "source_service": -1
        },
        "enable_restriction": true
      },
      "version": 3,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 100,
        "polling_interval": 0.5
      },
      "write_concern": false
    },
    "expected_config": {
      "description": "Старое описание",
      "disable_tracing_capturing": false,
      "grafana_url": "grafana/example_queue",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "example_queue",
      "shards": [
        {
          "collection": "example_queue_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        },
        {
          "collection": "example_queue_1",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "disabled",
      "task_input_restriction": {
        "by_tvm_services": {
          "source_service": -1
        },
        "enable_restriction": true
      },
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 4,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 100,
        "polling_interval": 0.5
      },
      "write_concern": false
    },
    "expected_db_fields": {}
  },
  {
    "data": {
      "description": "Старое описание",
      "queue_name": "example_queue",
      "shards": [
        {
          "collection": "example_queue_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "disabled"
        },
        {
          "collection": "example_queue_1",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "disabled",
      "task_input_restriction": {
        "by_tvm_services": {
          "source_service_1": -1,
          "source_service_2": 50
        },
        "enable_restriction": true
      },
      "version": 3,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 100,
        "polling_interval": 0.5
      },
      "write_concern": false
    },
    "expected_config": {
      "description": "Старое описание",
      "disable_tracing_capturing": false,
      "grafana_url": "grafana/example_queue",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "example_queue",
      "shards": [
        {
          "collection": "example_queue_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        },
        {
          "collection": "example_queue_1",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "disabled",
      "task_input_restriction": {
        "by_tvm_services": {
          "source_service_1": -1,
          "source_service_2": 50
        },
        "enable_restriction": true
      },
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 4,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 100,
        "polling_interval": 0.5
      },
      "write_concern": false
    },
    "expected_db_fields": {}
  },
  {
    "data": {
      "cluster": "cluster1",
      "department": "department1",
      "description": "Новое описание",
      "disable_tracing_capturing": false,
      "enable_bulk_buffering": true,
      "queue_name": "example_queue",
      "shards": [
        {
          "collection": "example_queue_0",
          "connection_name": "stq",
          "database": "dbstqorder0",
          "hostnames": [],
          "state": "disabled"
        },
        {
          "collection": "example_queue_1",
          "connection_name": "stq",
          "database": "dbstqorder0",
          "hostnames": [],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "task_input_restriction": {
        "enable_restriction": false
      },
      "version": 3,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 100,
        "polling_interval": 0.5
      },
      "write_concern": true
    },
    "expected_config": {
      "changing_database_meta_data": {
        "database_change_status": "CONFIG_CHANGED",
        "old_shards": {
          "0": {
            "collection": "example_queue_0",
            "connection_name": "stq",
            "database": "dbstq"
          },
          "1": {
            "collection": "example_queue_1",
            "connection_name": "stq",
            "database": "dbstq"
          }
        }
      },
      "cluster": "cluster1",
      "department": "department1",
      "description": "Новое описание",
      "disable_tracing_capturing": false,
      "enable_bulk_buffering": true,
      "grafana_url": "grafana/example_queue",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "example_queue",
      "shards": [
        {
          "collection": "example_queue_0",
          "connection_name": "stq",
          "database": "dbstqorder0",
          "hostnames": [],
          "state": "disabled"
        },
        {
          "collection": "example_queue_1",
          "connection_name": "stq",
          "database": "dbstqorder0",
          "hostnames": [],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "task_input_restriction": {
        "enable_restriction": false
      },
      "tplatform_namespace": "taxi",
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 4,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 100,
        "polling_interval": 0.5
      },
      "write_concern": true
    },
    "expected_db_fields": {
      "meta": [
        {
          "path": [
            "changing_database_meta_data",
            "time_of_update"
          ],
          "value": 1549018800.0
        }
      ]
    }
  },
  {
    "data": {
      "balancing_enabled": true,
      "description": "Новое описание",
      "queue_name": "example_queue",
      "shards": [
        {
          "collection": "example_queue_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "disabled"
        },
        {
          "collection": "example_queue_1",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "task_input_restriction": {
        "by_tvm_services": {}
      },
      "version": 3,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 500
      },
      "workers_guarantee": 20,
      "write_concern": true
    },
    "expected_config": {
      "balancer_settings": {
        "hosts": [
          {
            "name": "taxi-stq-sas-06.taxi.yandex.net",
            "shards": [
              {
                "index": 0,
                "max_tasks": 250
              },
              {
                "index": 1,
                "max_tasks": 250
              }
            ],
            "worker_configs": {
              "instances": 10
            }
          },
          {
            "name": "taxi-stq-vla-06.taxi.yandex.net",
            "shards": [
              {
                "index": 0,
                "max_tasks": 250
              },
              {
                "index": 1,
                "max_tasks": 250
              }
            ],
            "worker_configs": {
              "instances": 10
            }
          }
        ]
      },
      "balancing_enabled": true,
      "description": "Новое описание",
      "disable_tracing_capturing": false,
      "grafana_url": "grafana/example_queue",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "example_queue",
      "shards": [
        {
          "collection": "example_queue_0",
          "connection_name": "stq",
          "database": "dbstq",
          "state": "disabled"
        },
        {
          "collection": "example_queue_1",
          "connection_name": "stq",
          "database": "dbstq",
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "task_input_restriction": {
        "by_tvm_services": {}
      },
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 4,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 500
      },
      "workers_guarantee": 20,
      "write_concern": true
    },
    "expected_db_fields": {}
  },
  {
    "data": {
      "balancing_enabled": true,
      "description": "Новое описание",
      "queue_name": "queue_without_hosts",
      "shards": [
        {
          "collection": "queue_without_hosts_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "version": 3,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 500
      },
      "workers_guarantee": 20,
      "write_concern": true
    },
    "expected_config": {
      "balancing_enabled": true,
      "description": "Новое описание",
      "disable_tracing_capturing": false,
      "grafana_url": "grafana/queue_without_hosts",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "queue_without_hosts",
      "shards": [
        {
          "collection": "queue_without_hosts_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 4,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 500
      },
      "workers_guarantee": 20,
      "write_concern": true
    },
    "expected_db_fields": {}
  },
  {
    "data": {
      "balancing_enabled": false,
      "queue_name": "processing",
      "shards": [
        {
          "collection": "processing_0",
          "connection_name": "stq_order0",
          "database": "dbstqorder0",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net"
          ],
          "state": "enabled"
        },
        {
          "collection": "processing_1",
          "connection_name": "stq_order0",
          "database": "dbstqorder0",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "version": 27,
      "worker_configs": {
        "instances": 20,
        "max_execution_time": 120,
        "max_tasks": 900
      },
      "workers_guarantee": 6,
      "write_concern": false
    },
    "expected_config": {
      "balancing_enabled": false,
      "changing_database_meta_data": {
        "backup_collections": [
          {
            "backup_shard": {
              "collection": "processing_0_lalalal",
              "connection_name": "stq_mdb0",
              "database": "dbstq_mdb0"
            },
            "old_shard": {
              "collection": "processing_0",
              "connection_name": "stq",
              "database": "dbstq"
            }
          }
        ]
      },
      "disable_tracing_capturing": false,
      "grafana_url": "grafana/processing",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "processing",
      "shards": [
        {
          "collection": "processing_0",
          "connection_name": "stq_order0",
          "database": "dbstqorder0",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net"
          ],
          "state": "enabled"
        },
        {
          "collection": "processing_1",
          "connection_name": "stq_order0",
          "database": "dbstqorder0",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 28,
      "worker_configs": {
        "instances": 20,
        "max_execution_time": 120,
        "max_tasks": 900
      },
      "workers_guarantee": 6,
      "write_concern": false
    },
    "expected_db_fields": {}
  },
  {
    "data": {
      "balancing_enabled": false,
      "description": "test",
      "queue_name": "test_no_balancer_settings",
      "shards": [
        {
          "collection": "test_no_balancer_settings_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [],
          "state": "enabled"
        }
      ],
      "state": "disabled",
      "version": 5,
      "worker_configs": {
        "instances": 2,
        "max_execution_time": 300,
        "max_tasks": 2
      },
      "workers_guarantee": 4,
      "write_concern": false
    },
    "expected_config": {
      "balancing_enabled": false,
      "description": "test",
      "disable_tracing_capturing": false,
      "grafana_url": "grafana/test_no_balancer_settings",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "test_no_balancer_settings",
      "shards": [
        {
          "collection": "test_no_balancer_settings_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [],
          "state": "enabled"
        }
      ],
      "state": "disabled",
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 6,
      "worker_configs": {
        "instances": 2,
        "max_execution_time": 300,
        "max_tasks": 2
      },
      "workers_guarantee": 4,
      "write_concern": false
    },
    "expected_db_fields": {}
  },
  {
    "data": {
      "balancing_enabled": false,
      "description": "new desc",
      "queue_name": "processing",
      "shards": [
        {
          "collection": "processing_0",
          "connection_name": "stq_order1",
          "database": "dbstqorder0",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net"
          ],
          "state": "enabled"
        },
        {
          "collection": "processing_1",
          "connection_name": "stq_order0",
          "database": "dbstqorder0",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "version": 27,
      "worker_configs": {
        "instances": 20,
        "max_execution_time": 120,
        "max_tasks": 900
      },
      "workers_guarantee": 6,
      "write_concern": false
    },
    "expected_config": {
      "balancing_enabled": false,
      "changing_database_meta_data": {
        "backup_collections": [
          {
            "backup_shard": {
              "collection": "processing_0_lalalal",
              "connection_name": "stq_mdb0",
              "database": "dbstq_mdb0"
            },
            "old_shard": {
              "collection": "processing_0",
              "connection_name": "stq",
              "database": "dbstq"
            }
          }
        ],
        "database_change_status": "CONFIG_CHANGED",
        "old_shards": {
          "0": {
            "collection": "processing_0",
            "connection_name": "stq_order0",
            "database": "dbstqorder0"
          }
        }
      },
      "description": "new desc",
      "disable_tracing_capturing": false,
      "grafana_url": "grafana/processing",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "processing",
      "shards": [
        {
          "collection": "processing_0",
          "connection_name": "stq_order1",
          "database": "dbstqorder0",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net"
          ],
          "state": "enabled"
        },
        {
          "collection": "processing_1",
          "connection_name": "stq_order0",
          "database": "dbstqorder0",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 28,
      "worker_configs": {
        "instances": 20,
        "max_execution_time": 120,
        "max_tasks": 900
      },
      "workers_guarantee": 6,
      "write_concern": false
    },
    "expected_db_fields": {}
  },
  {
    "data": {
      "description": "Новое описание",
      "queue_name": "queue_with_department",
      "shards": [
        {
          "collection": "queue_with_department_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "version": 2,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 100,
        "max_tasks": 500,
        "polling_interval": 0.5
      },
      "write_concern": false
    },
    "expected_config": {
      "description": "Новое описание",
      "disable_tracing_capturing": false,
      "grafana_url": "grafana/queue_with_department",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "queue_with_department",
      "shards": [
        {
          "collection": "queue_with_department_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 3,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 100,
        "max_tasks": 500,
        "polling_interval": 0.5
      },
      "write_concern": false
    },
    "expected_db_fields": {}
  },
  {
    "data": {
      "description": "Новое описание",
      "queue_name": "queue_with_cluster",
      "shards": [
        {
          "collection": "queue_with_cluster_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "version": 2,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 100,
        "max_tasks": 500,
        "polling_interval": 0.5
      },
      "write_concern": false
    },
    "expected_config": {
      "description": "Новое описание",
      "disable_tracing_capturing": false,
      "grafana_url": "grafana/queue_with_cluster",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "queue_with_cluster",
      "shards": [
        {
          "collection": "queue_with_cluster_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 3,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 100,
        "max_tasks": 500,
        "polling_interval": 0.5
      },
      "write_concern": false
    },
    "expected_db_fields": {}
  },
  {
    "data": {
      "cluster": "new_cluster_name",
      "description": "Новое описание-2",
      "queue_name": "queue_with_cluster",
      "shards": [
        {
          "collection": "queue_with_cluster_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "version": 2,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 100,
        "max_tasks": 500,
        "polling_interval": 0.5
      },
      "write_concern": false
    },
    "expected_config": {
      "cluster": "new_cluster_name",
      "description": "Новое описание-2",
      "disable_tracing_capturing": false,
      "grafana_url": "grafana/queue_with_cluster",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "queue_with_cluster",
      "shards": [
        {
          "collection": "queue_with_cluster_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 3,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 100,
        "max_tasks": 500,
        "polling_interval": 0.5
      },
      "write_concern": false
    },
    "expected_db_fields": {}
  },
  {
    "data": {
      "queue_name": "queue_with_old_shards",
      "shards": [
        {
          "collection": "queue_with_old_shards_0",
          "connection_name": "stq",
          "database": "dbstqorder0",
          "hostnames": [],
          "state": "disabled"
        },
        {
          "collection": "queue_with_old_shards_1",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [],
          "state": "enabled"
        },
        {
          "collection": "queue_with_old_shards_2",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "version": 3,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 100,
        "polling_interval": 0.5
      },
      "write_concern": true
    },
    "expected_config": {
      "changing_database_meta_data": {
        "database_change_status": "CONFIG_CHANGED",
        "old_shards": {
          "1": {
            "collection": "queue_with_old_shards_1",
            "connection_name": "stq",
            "database": "dbstqorder0"
          }
        }
      },
      "disable_tracing_capturing": false,
      "grafana_url": "grafana/queue_with_old_shards",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "queue_with_old_shards",
      "shards": [
        {
          "collection": "queue_with_old_shards_0",
          "connection_name": "stq",
          "database": "dbstqorder0",
          "hostnames": [],
          "state": "disabled"
        },
        {
          "collection": "queue_with_old_shards_1",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [],
          "state": "enabled"
        },
        {
          "collection": "queue_with_old_shards_2",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [],
          "state": "enabled"
        }
      ],
      "state": "enabled",
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 4,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 100,
        "polling_interval": 0.5
      },
      "write_concern": true
    },
    "expected_db_fields": {
      "meta": [
        {
          "path": [
            "changing_database_meta_data",
            "time_of_update"
          ],
          "value": 1549018800.0
        }
      ]
    }
  },
  {
    "data": {
      "description": "Старое описание",
      "disable_tracing_capturing": true,
      "queue_name": "example_queue",
      "shards": [
        {
          "collection": "example_queue_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "disabled"
        },
        {
          "collection": "example_queue_1",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "disabled",
      "task_input_restriction": {
        "by_tvm_services": {
          "source_service": -1
        },
        "enable_restriction": true
      },
      "version": 3,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 100,
        "polling_interval": 0.5
      },
      "write_concern": false
    },
    "expected_config": {
      "description": "Старое описание",
      "disable_tracing_capturing": true,
      "grafana_url": "grafana/example_queue",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "example_queue",
      "shards": [
        {
          "collection": "example_queue_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        },
        {
          "collection": "example_queue_1",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "disabled",
      "task_input_restriction": {
        "by_tvm_services": {
          "source_service": -1
        },
        "enable_restriction": true
      },
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 4,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 100,
        "polling_interval": 0.5
      },
      "write_concern": false
    },
    "expected_db_fields": {},
    "test_id": "set_disable_tracing_capturing"
  },
  {
    "data": {
      "description": "Старое описание",
      "disable_tracing_capturing": false,
      "queue_name": "queue_with_disable_tracing_capturing",
      "shards": [
        {
          "collection": "example_queue_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "disabled"
        },
        {
          "collection": "example_queue_1",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "disabled",
      "task_input_restriction": {
        "by_tvm_services": {
          "source_service": -1
        },
        "enable_restriction": true
      },
      "version": 3,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 100,
        "polling_interval": 0.5
      },
      "write_concern": false
    },
    "expected_config": {
      "description": "Старое описание",
      "disable_tracing_capturing": false,
      "grafana_url": "grafana/queue_with_disable_tracing_capturing",
      "monitoring_thresholds": {
        "total": {
          "critical": 5,
          "warning": 1
        }
      },
      "queue_name": "queue_with_disable_tracing_capturing",
      "shards": [
        {
          "collection": "example_queue_0",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        },
        {
          "collection": "example_queue_1",
          "connection_name": "stq",
          "database": "dbstq",
          "hostnames": [
            "taxi-stq-sas-06.taxi.yandex.net",
            "taxi-stq-vla-06.taxi.yandex.net"
          ],
          "state": "enabled"
        }
      ],
      "state": "disabled",
      "task_input_restriction": {
        "by_tvm_services": {
          "source_service": -1
        },
        "enable_restriction": true
      },
      "updated": "2019-02-01T17:00:00+03:00",
      "version": 4,
      "worker_configs": {
        "instances": 10,
        "max_execution_time": 120,
        "max_tasks": 100,
        "polling_interval": 0.5
      },
      "write_concern": false
    },
    "expected_db_fields": {},
    "test_id": "change_disable_tracing_capturing"
  }
]
