{
  "apply_catboost_params": {
    "models": [
      "model_381"
    ],
    "models_path": "//home/taxi_ml/dev/discounts/katusha_prod/kt_models",
    "output_table": "//home/taxi_ml/dev/discounts/katusha_prod/predictions/model_381",
    "project_features": [
      "last_absent_days",
      "success_orders_28_cnt"
    ]
  },
  "blackbox_params": {
    "maxiter": 250,
    "model_archive_path": "//home/taxi_ml/production/discounts/kt2/v2/model_archive_regions",
    "model_path": "//home/taxi_ml/production/discounts/kt2/v2/model_regions",
    "n_jobs": 16,
    "n_steps": 10,
    "normalization_data_path": "//home/taxi_ml/production/discounts/kt2/v2/normalization_regions",
    "output_path": "//home/taxi_ml/production/discounts/kt2/v2/preds_regions_storage",
    "partition_step": 0.1,
    "poly_degree": 2,
    "poly_features": [
      "session_with_offer_to_session_with_order_56_conversion_rate",
      "n_orders_56_sum"
    ],
    "mean_std_norm_features": ["n_orders_56_sum"],
    "train_path": "//home/taxi_ml/production/discounts/kt2/v2/random_train_regions"
  },
  "catboost_params_list": [
    {
      "catboost_yt_output_format": [
        "DocId",
        "RawFormulaVal",
        "Label"
      ],
      "depth": 3,
      "iterations": 1000,
      "learning_rate": 0.005,
      "loss_function": "RMSE",
      "output_path": "//home/taxi_ml/dev/discounts/katusha_exp/model_381/test_data_predictions",
      "resources_dir": "/home/glukhover/projects/training/kt/model_381/",
      "test_path": "//home/taxi_ml/dev/discounts/katusha_exp/test_data_lag_2",
      "train_path": "//home/taxi_ml/dev/discounts/katusha_exp/train_data_lag_2",
      "use_gpu": true,
      "validation_path": "//home/taxi_ml/dev/discounts/katusha_exp/test_data_lag_2",
      "workflow_id": "69e51327-4407-4030-a172-0d010be9f1ff",
      "yt_model_path": "//home/taxi_ml/dev/discounts/katusha_prod/kt_models/model_381.cbm"
    }
  ],
  "collect_history_params": {
    "aggregate_fields": [
      "n_orders",
      "order_cost_rur",
      "discount_value_rur"
    ],
    "end_date": "2021-06-22 10:00:00",
    "input_table": "//home/taxi_ml/production/discounts/kt2/v2/random_hist",
    "one_of_filters": {
      "tariff_class_code": [
        "econom",
        "uberx",
        "business",
        "comfortplus",
        "uberselect"
      ]
    },
    "output_table": "//home/taxi_ml/production/discounts/kt2/v2/random_hist_stats",
    "project_dm_params": [
      "utc_order_created_dttm",
      "order_id",
      "success_order_flg",
      "corp_order_flg",
      "tariff_class_code",
      "phone_pd_id",
      "order_cost",
      "discount_compensation_value",
      "balance_rate"
    ],
    "start_date": "2021-03-22 10:00:00",
    "upper_limits": {
      "balance_rate": 1.2,
      "corp_order_flg": 0
    }
  },
  "factory_params": {
    "control_ratio": 0.5,
    "data_splitter_params": {
      "field": "key",
      "labels_intervals": [
        {
          "label": "train",
          "percent_from": 0,
          "percent_to": 101
        },
        {
          "label": "test",
          "percent_from": 102,
          "percent_to": 102
        }
      ],
      "salt": "salt_2021-06-28-prod",
      "split_type": "hash"
    },
    "features_extractor_name": "v2",
    "features_extractors_params": {
      "cat_features": {
        "features": [
          "is_control",
          "user"
        ],
        "options": {}
      },
      "distr_features": {
        "distr_dict": {
          "city": [
            "Москва",
            "Санкт-Петербург",
            "Екатеринбург",
            "Казань",
            "Самара",
            "others"
          ],
          "day_type": [
            "weekend",
            "workday"
          ]
        },
        "features": [
          "order_local_weekend_{window}_{day_type}_fraction",
          "session_local_weekend_{window}_{day_type}_fraction",
          "city_{window}_{city}_fraction"
        ],
        "options": {
          "window": [
            56
          ]
        }
      },
      "num_features": {
        "features": [
          "mean_interval_order_timestamp_{window}",
          "mean_interval_session_timestamp_{window}",
          "n_orders_{window}_sum",
          "session_with_offer_to_session_with_order_{window}_conversion_rate",
          "time_from_last_order_timestamp_{window}",
          "time_from_last_session_timestamp_{window}"
        ],
        "options": {
          "num_aggr_option": [
            "mean"
          ],
          "window": [
            56
          ]
        }
      }
    },
    "target_extractor_name": "Count",
    "train_features": {
      "cat_features": {
        "features": [],
        "options": {}
      },
      "distr_features": {
        "distr_dict": {
          "city": [
            "Москва",
            "Санкт-Петербург",
            "Екатеринбург",
            "Казань",
            "Самара",
            "others"
          ],
          "day_type": [
            "weekend",
            "workday"
          ]
        },
        "features": [
          "order_local_weekend_{window}_{day_type}_fraction",
          "session_local_weekend_{window}_{day_type}_fraction",
          "city_{window}_{city}_fraction"
        ],
        "options": {
          "window": [
            56
          ]
        }
      },
      "num_features": {
        "features": [
          "mean_interval_order_timestamp_{window}",
          "mean_interval_session_timestamp_{window}",
          "n_orders_{window}_sum",
          "session_with_offer_to_session_with_order_{window}_conversion_rate",
          "time_from_last_order_timestamp_{window}",
          "time_from_last_session_timestamp_{window}"
        ],
        "options": {
          "num_aggr_option": [
            "mean"
          ],
          "window": [
            56
          ]
        }
      },
      "target_column": "target",
      "weight_column": "weight"
    }
  },
  "object_id_name": "phone_pd_id",
  "prepare_dataset_params": {
    "custom_features": false,
    "daily_feature_extractor_params": {
    "cat_features": {
      "features_options": {
        "city": [
          "Москва",
          "Санкт-Петербург",
          "Екатеринбург",
          "Казань",
          "Самара",
          "others"
        ],
        "order_local_weekend": [
            "weekend",
            "workday"
          ],
        "session_local_weekend": [
            "weekend",
            "workday"
          ]
      }
    },
    "num_order_features": {
      "base_feature": "n_orders",
      "feature_names": [
        "n_orders"
      ]
    },
    "num_session_features": {
      "base_feature": "n_sessions",
      "conversion_from_to": [
        [
          "session_with_offer",
          "session_with_order"
        ]
      ],
      "feature_names": [
        "n_sessions",
        "offer_cnt"
      ]
    },
    "time_features": {
      "feature_names": [
        "session_timestamp",
        "order_timestamp"
      ]
    },
    "windows": [
      56
    ]
  },
    "debug": false,
    "features_latency_days": 2,
    "max_window": 56,
    "filters": {
      "lower_limits": {
        "exp_duration": 432000
      },
      "upper_limits": {}
    },
    "hist_table": "//home/taxi_ml/production/discounts/kt2/v2/random_hist_stats",
    "merged_table": "//home/taxi_ml/production/discounts/kt2/v2/random_hist_features",
    "time_gap": "week",
    "user_features": "//home/taxi_ml/production/users/unit_features/{}"
  },
  "prepare_learning_dataset_params": {
    "create_cb_vector": false,
    "filters": {
      "lower_limits": {},
      "upper_limits": {
        "city_56_Москва_fraction": 0.5,
        "session_with_offer_to_session_with_order_56_conversion_rate": 1,
        "n_orders_56_sum": 150,
        "target": 10
      }
    },
    "input_table": "//home/taxi_ml/production/discounts/kt2/v2/random_hist_features",
    "split_data_params": {
      "output_keys": [
        "train",
        "test"
      ]
    },
    "split_path_mapping": {
      "test": "//home/taxi_ml/production/discounts/kt2/v2/random_test_regions",
      "train": "//home/taxi_ml/production/discounts/kt2/v2/random_train_regions"
    }
  },
  "pulsar_params": {
    "dataset": {
      "cluster": "hahn",
      "name": "kt2_random_regions_test"
    },
    "model": {
      "name": "Rell_uplift_Regions_Test_v2",
      "version": "1.0.0"
    },
    "tags": [
      "rell_uplift",
      "kt2",
      "test"
    ]
  },
  "yt_proxy": "hahn"
}
