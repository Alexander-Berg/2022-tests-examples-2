{
  "comment": "",
  "name": "delivery_price_pipeline_4",
  "stages": [
    {
      "conditions": [],
      "in_bindings": [
        {
          "domain": "input",
          "query": {
            "children": [
              {
                "query": {
                  "operations": [
                    {
                      "alias": "continuous_group",
                      "property_name": "continuous_group"
                    }
                  ]
                }
              }
            ],
            "operations": [
              {
                "property_name": "settings"
              }
            ]
          }
        },
        {
          "children": [
            {
              "children": [
                {
                  "query": {
                    "operations": [
                      {
                        "property_name": "region_id"
                      }
                    ]
                  }
                },
                {
                  "query": {
                    "operations": [
                      {
                        "property_name": "brand_id"
                      }
                    ]
                  }
                }
              ],
              "query": {
                "operations": [
                  {
                    "property_name": "place_info"
                  }
                ]
              }
            }
          ],
          "domain": "input",
          "query": {
            "operations": [
              {
                "property_name": "request"
              }
            ]
          }
        }
      ],
      "name": "fetch_continuous_commission",
      "optional": false,
      "resources": [
        {
          "field": "continuous_commission",
          "name": "continuous_commission_data"
        }
      ],
      "source_code": "return {continuous_commission: {brand_id: brand_id, region_id: region_id, continuous_group: settings.continuous_group}};"
    },
    {
      "conditions": [],
      "in_bindings": [
        {
          "domain": "resource",
          "query": {
            "operations": [
              {
                "alias": "continuous_commission",
                "property_name": "continuous_commission"
              }
            ]
          }
        },
        {
          "domain": "input",
          "query": "request.place_info.surge"
        }
      ],
      "name": "calc_fees",
      "optional": false,
      "out_bindings": [
        {
          "alias": "is_fallback",
          "query": "is_fallback"
        },
        {
          "alias": "fees",
          "query": "fees"
        },
        {
          "alias": "extra",
          "query": "extra"
        }
      ],
      "source_code": "return {fees: [{delivery_cost: 199.0,order_price: 0.0}, {delivery_cost: 0.0,order_price: 2500.0}], is_fallback: false, extra: {surge: surge, continuous_commission: continuous_commission}};"
    }
  ]
}
