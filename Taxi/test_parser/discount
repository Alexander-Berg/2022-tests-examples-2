FUNC(abs,ARGS((val,double)),B(CR(res=T(B(FA(val,double),<,0.000000),U(-,FA(val,double)),FA(val,double)))));FUNC(applyNewbieCoefficients,ARGS((coeff,double),(restrictions,clients::discounts::DiscountRestrictions)),B(SV(newbie_max_coeff,T(U(?,B(FA(restrictions,clients::discounts::DiscountRestrictions),.,F(newbie_max_coeff))),U(*,B(FA(restrictions,clients::discounts::DiscountRestrictions),.,F(newbie_max_coeff))),1.000000));SV(newbie_num_coeff,T(U(?,B(FA(restrictions,clients::discounts::DiscountRestrictions),.,F(newbie_num_coeff))),U(*,B(FA(restrictions,clients::discounts::DiscountRestrictions),.,F(newbie_num_coeff))),0.000000));SV(completed_count,T(U(?,B(FA(restrictions,clients::discounts::DiscountRestrictions),.,F(completed_on_special_conditions_count))),U(*,B(FA(restrictions,clients::discounts::DiscountRestrictions),.,F(completed_on_special_conditions_count))),0.000000));CR(res=B(FA(coeff,double),*,B(VA(newbie_max_coeff),-,B(VA(newbie_num_coeff),*,VA(completed_count)))))));FUNC(calculateHyperbolaDiscountPercent,ARGS((hyperbolas,clients::discounts::HyperbolasData),(price,double)),B(IF(B(B(FC(abs,NT(val=B(FA(price,double),+,B(T(B(FA(price,double),<,B(FA(hyperbolas,clients::discounts::HyperbolasData),.,F(threshold))),B(FA(hyperbolas,clients::discounts::HyperbolasData),.,F(hyperbola_lower)),B(FA(hyperbolas,clients::discounts::HyperbolasData),.,F(hyperbola_upper))),.,F(c)))),R(res=double)),.,TF(res)),<,0.000100),CR(res=0.000000));CR(res=B(B(T(B(FA(price,double),<,B(FA(hyperbolas,clients::discounts::HyperbolasData),.,F(threshold))),B(FA(hyperbolas,clients::discounts::HyperbolasData),.,F(hyperbola_lower)),B(FA(hyperbolas,clients::discounts::HyperbolasData),.,F(hyperbola_upper))),.,F(p)),+,B(B(T(B(FA(price,double),<,B(FA(hyperbolas,clients::discounts::HyperbolasData),.,F(threshold))),B(FA(hyperbolas,clients::discounts::HyperbolasData),.,F(hyperbola_lower)),B(FA(hyperbolas,clients::discounts::HyperbolasData),.,F(hyperbola_upper))),.,F(a)),/,B(FA(price,double),+,B(T(B(FA(price,double),<,B(FA(hyperbolas,clients::discounts::HyperbolasData),.,F(threshold))),B(FA(hyperbolas,clients::discounts::HyperbolasData),.,F(hyperbola_lower)),B(FA(hyperbolas,clients::discounts::HyperbolasData),.,F(hyperbola_upper))),.,F(c))))))));FUNC(calculateTableDiscountPercent,ARGS((price,double),(table,std::vector<clients::discounts::TableDataA>)),B(IF(B(FL(FA(table,std::vector<clients::discounts::TableDataA>),elem,NT(first_iteration=true,has_result=false,prev_elem_coeff=0.000000,prev_elem_price=0.000000,price=FA(price,double),result=0.000000),NT(first_iteration=T(FA(has_result,bool),false,T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),false,T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),false,false),false))),has_result=T(FA(has_result,bool),true,T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),true,T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),true,true),false))),prev_elem_coeff=T(FA(has_result,bool),B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),B(FA(elem,clients::discounts::TableDataA),.,F(coeff))),B(FA(elem,clients::discounts::TableDataA),.,F(coeff))))),prev_elem_price=T(FA(has_result,bool),B(FA(elem,clients::discounts::TableDataA),.,F(price)),T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),B(FA(elem,clients::discounts::TableDataA),.,F(price)),T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),B(FA(elem,clients::discounts::TableDataA),.,F(price)),B(FA(elem,clients::discounts::TableDataA),.,F(price))),B(FA(elem,clients::discounts::TableDataA),.,F(price))))),price=T(FA(has_result,bool),FA(price,double),T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),FA(price,double),T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),FA(price,double),FA(price,double)),FA(price,double)))),result=T(FA(has_result,bool),FA(result,double),T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),0.000000,B(FA(prev_elem_coeff,double),+,B(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),-,FA(prev_elem_coeff,double)),*,B(FA(price,double),-,FA(prev_elem_price,double))),/,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))))),FA(result,double)))))),.,TF(has_result)),CR(res=B(FL(FA(table,std::vector<clients::discounts::TableDataA>),elem,NT(first_iteration=true,has_result=false,prev_elem_coeff=0.000000,prev_elem_price=0.000000,price=FA(price,double),result=0.000000),NT(first_iteration=T(FA(has_result,bool),false,T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),false,T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),false,false),false))),has_result=T(FA(has_result,bool),true,T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),true,T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),true,true),false))),prev_elem_coeff=T(FA(has_result,bool),B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),B(FA(elem,clients::discounts::TableDataA),.,F(coeff))),B(FA(elem,clients::discounts::TableDataA),.,F(coeff))))),prev_elem_price=T(FA(has_result,bool),B(FA(elem,clients::discounts::TableDataA),.,F(price)),T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),B(FA(elem,clients::discounts::TableDataA),.,F(price)),T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),B(FA(elem,clients::discounts::TableDataA),.,F(price)),B(FA(elem,clients::discounts::TableDataA),.,F(price))),B(FA(elem,clients::discounts::TableDataA),.,F(price))))),price=T(FA(has_result,bool),FA(price,double),T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),FA(price,double),T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),FA(price,double),FA(price,double)),FA(price,double)))),result=T(FA(has_result,bool),FA(result,double),T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),0.000000,B(FA(prev_elem_coeff,double),+,B(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),-,FA(prev_elem_coeff,double)),*,B(FA(price,double),-,FA(prev_elem_price,double))),/,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))))),FA(result,double)))))),.,TF(result))));CR(res=B(FL(FA(table,std::vector<clients::discounts::TableDataA>),elem,NT(first_iteration=true,has_result=false,prev_elem_coeff=0.000000,prev_elem_price=0.000000,price=FA(price,double),result=0.000000),NT(first_iteration=T(FA(has_result,bool),false,T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),false,T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),false,false),false))),has_result=T(FA(has_result,bool),true,T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),true,T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),true,true),false))),prev_elem_coeff=T(FA(has_result,bool),B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),B(FA(elem,clients::discounts::TableDataA),.,F(coeff))),B(FA(elem,clients::discounts::TableDataA),.,F(coeff))))),prev_elem_price=T(FA(has_result,bool),B(FA(elem,clients::discounts::TableDataA),.,F(price)),T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),B(FA(elem,clients::discounts::TableDataA),.,F(price)),T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),B(FA(elem,clients::discounts::TableDataA),.,F(price)),B(FA(elem,clients::discounts::TableDataA),.,F(price))),B(FA(elem,clients::discounts::TableDataA),.,F(price))))),price=T(FA(has_result,bool),FA(price,double),T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),FA(price,double),T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),FA(price,double),FA(price,double)),FA(price,double)))),result=T(FA(has_result,bool),FA(result,double),T(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),T(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),T(B(T(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double)),<,0.000000),U(-,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),<,0.000100),0.000000,B(FA(prev_elem_coeff,double),+,B(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),-,FA(prev_elem_coeff,double)),*,B(FA(price,double),-,FA(prev_elem_price,double))),/,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))))),FA(result,double)))))),.,TF(prev_elem_coeff)))));FUNC(max,ARGS((a,double),(b,double)),B(CR(res=T(B(FA(a,double),>,FA(b,double)),FA(a,double),FA(b,double)))));FUNC(min,ARGS((a,double),(b,double)),B(CR(res=T(B(FA(a,double),<,FA(b,double)),FA(a,double),FA(b,double)))));FUNC(normalizeByMaxAbsoluteValue,ARGS((coeff,double),(max_absolute_value_opt,std::optional<double>),(price,double)),B(IF(U(?,FA(max_absolute_value_opt,std::optional<double>)),IF(B(B(B(FA(price,double),*,FA(coeff,double)),>,U(*,FA(max_absolute_value_opt,std::optional<double>))),&&,B(FA(price,double),>,0.000100)),CR(res=B(FC(min,NT(a=B(FC(max,NT(a=B(U(*,FA(max_absolute_value_opt,std::optional<double>)),/,FA(price,double)),b=0.000000),R(res=double)),.,TF(res)),b=1.000000),R(res=double)),.,TF(res)))));CR(res=FA(coeff,double))));FUNC(normalizeToMinMax,ARGS((coeff,double),(restrictions,clients::discounts::DiscountRestrictions)),B(SV(coeff_limited_to_max,B(FC(min,NT(a=FA(coeff,double),b=B(FA(restrictions,clients::discounts::DiscountRestrictions),.,F(max_discount_coeff))),R(res=double)),.,TF(res)));CR(res=T(B(VA(coeff_limited_to_max),<,B(FA(restrictions,clients::discounts::DiscountRestrictions),.,F(min_discount_coeff))),0.000000,VA(coeff_limited_to_max)))));FUNC(processTableElement,ARGS((elem,clients::discounts::TableDataA),(first_iteration,bool),(has_result,bool),(prev_elem_coeff,double),(prev_elem_price,double),(price,double),(result,double)),B(IF(FA(has_result,bool),CR(first_iteration=false,has_result=true,prev_elem_coeff=B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),prev_elem_price=B(FA(elem,clients::discounts::TableDataA),.,F(price)),price=FA(price,double),result=FA(result,double)));IF(B(FA(first_iteration,bool),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),CR(first_iteration=false,has_result=true,prev_elem_coeff=B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),prev_elem_price=B(FA(elem,clients::discounts::TableDataA),.,F(price)),price=FA(price,double),result=B(FA(elem,clients::discounts::TableDataA),.,F(coeff))));IF(B(B(U(!,FA(first_iteration,bool)),&&,B(FA(prev_elem_price,double),<=,FA(price,double))),&&,B(FA(price,double),<,B(FA(elem,clients::discounts::TableDataA),.,F(price)))),IF(B(B(FC(abs,NT(val=B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))),R(res=double)),.,TF(res)),<,0.000100),CR(first_iteration=false,has_result=true,prev_elem_coeff=B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),prev_elem_price=B(FA(elem,clients::discounts::TableDataA),.,F(price)),price=FA(price,double),result=0.000000));CR(first_iteration=false,has_result=true,prev_elem_coeff=B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),prev_elem_price=B(FA(elem,clients::discounts::TableDataA),.,F(price)),price=FA(price,double),result=B(FA(prev_elem_coeff,double),+,B(B(B(B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),-,FA(prev_elem_coeff,double)),*,B(FA(price,double),-,FA(prev_elem_price,double))),/,B(B(FA(elem,clients::discounts::TableDataA),.,F(price)),-,FA(prev_elem_price,double))))));CR(first_iteration=false,has_result=false,prev_elem_coeff=B(FA(elem,clients::discounts::TableDataA),.,F(coeff)),prev_elem_price=B(FA(elem,clients::discounts::TableDataA),.,F(price)),price=FA(price,double),result=FA(result,double))));IF(U(?,B(fix,.,F(discount))),IF(U(?,B(U(*,B(fix,.,F(discount))),.,F(is_price_strikethrough))),IF(U(!,U(*,B(U(*,B(fix,.,F(discount))),.,F(is_price_strikethrough)))),CR(boarding=B(B(ride,.,F(price)),.,F(boarding)),destination_waiting=B(B(ride,.,F(price)),.,F(destination_waiting)),distance=B(B(ride,.,F(price)),.,F(distance)),requirements=B(B(ride,.,F(price)),.,F(requirements)),time=B(B(ride,.,F(price)),.,F(time)),transit_waiting=B(B(ride,.,F(price)),.,F(transit_waiting)),waiting=B(B(ride,.,F(price)),.,F(waiting)))));IF(B(B(B(U(*,B(fix,.,F(discount))),.,F(restrictions)),.,F(recalc_type)),==,clients::discounts::RecalcType::kSurgePrice),CR(boarding=B(B(ride,.,F(price)),.,F(boarding)),destination_waiting=B(B(ride,.,F(price)),.,F(destination_waiting)),distance=B(B(ride,.,F(price)),.,F(distance)),requirements=B(B(ride,.,F(price)),.,F(requirements)),time=B(B(ride,.,F(price)),.,F(time)),transit_waiting=B(B(ride,.,F(price)),.,F(transit_waiting)),waiting=B(B(ride,.,F(price)),.,F(waiting))));E("discount_price",U(*,B(ride,.,F(price))));SV(affected_price,B(B(B(U(*,B(ride,.,F(price))),-,B(B(ride,.,F(price)),.,F(waiting))),-,B(B(ride,.,F(price)),.,F(transit_waiting))),-,B(B(ride,.,F(price)),.,F(destination_waiting))));SV(percent,T(U(?,B(U(*,B(fix,.,F(discount))),.,F(calc_data_hyperbolas))),B(FC(calculateHyperbolaDiscountPercent,NT(hyperbolas=U(*,B(U(*,B(fix,.,F(discount))),.,F(calc_data_hyperbolas))),price=VA(affected_price)),R(res=double)),.,TF(res)),T(U(?,B(U(*,B(fix,.,F(discount))),.,F(calc_data_table_data))),B(FC(calculateTableDiscountPercent,NT(price=VA(affected_price),table=U(*,B(U(*,B(fix,.,F(discount))),.,F(calc_data_table_data)))),R(res=double)),.,TF(res)),0.000000)));SV(coeff_initial,B(VA(percent),*,0.010000));SV(coeff1,B(FC(applyNewbieCoefficients,NT(coeff=VA(coeff_initial),restrictions=B(U(*,B(fix,.,F(discount))),.,F(restrictions))),R(res=double)),.,TF(res)));SV(coeff2,B(FC(normalizeToMinMax,NT(coeff=VA(coeff1),restrictions=B(U(*,B(fix,.,F(discount))),.,F(restrictions))),R(res=double)),.,TF(res)));SV(coeff3,B(FC(normalizeByMaxAbsoluteValue,NT(coeff=VA(coeff2),max_absolute_value_opt=B(B(U(*,B(fix,.,F(discount))),.,F(restrictions)),.,F(max_absolute_value)),price=VA(affected_price)),R(res=double)),.,TF(res)));IF(B(VA(coeff3),<=,0.000000),CR(boarding=B(B(ride,.,F(price)),.,F(boarding)),destination_waiting=B(B(ride,.,F(price)),.,F(destination_waiting)),distance=B(B(ride,.,F(price)),.,F(distance)),requirements=B(B(ride,.,F(price)),.,F(requirements)),time=B(B(ride,.,F(price)),.,F(time)),transit_waiting=B(B(ride,.,F(price)),.,F(transit_waiting)),waiting=B(B(ride,.,F(price)),.,F(waiting))));SV(coeff_final,B(FC(min,NT(a=VA(coeff3),b=1.000000),R(res=double)),.,TF(res)));IF(B(U(*,B(fix,.,F(discount))),.,F(is_cashback)),IF(T(U(?,B(fix,.,F(complements))),U(?,B(B(fix,.,F(complements)),.,F(personal_wallet))),false),CR(boarding=B(B(ride,.,F(price)),.,F(boarding)),destination_waiting=B(B(ride,.,F(price)),.,F(destination_waiting)),distance=B(B(ride,.,F(price)),.,F(distance)),requirements=B(B(ride,.,F(price)),.,F(requirements)),time=B(B(ride,.,F(price)),.,F(time)),transit_waiting=B(B(ride,.,F(price)),.,F(transit_waiting)),waiting=B(B(ride,.,F(price)),.,F(waiting))));IF(U(?,B(B(U(*,B(fix,.,F(discount))),.,F(restrictions)),.,F(max_absolute_value))),E("cashback_max_value",U(*,B(B(U(*,B(fix,.,F(discount))),.,F(restrictions)),.,F(max_absolute_value)))));E("cashback_rate",VA(coeff_final));IF(U(?,B(U(*,B(fix,.,F(discount))),.,F(description))),IF(B(U(*,B(U(*,B(fix,.,F(discount))),.,F(description))),==,"mc_cashback_ultima_plus"),E("cashback_sponsor:mastercard",1.000000));IF(B(U(*,B(U(*,B(fix,.,F(discount))),.,F(description))),==,"mastercard_otkrytie_ultima_cashback_2021"),E("cashback_sponsor:otkrytie_mastercard",1.000000)));CR(boarding=B(B(ride,.,F(price)),.,F(boarding)),destination_waiting=B(B(ride,.,F(price)),.,F(destination_waiting)),distance=B(B(ride,.,F(price)),.,F(distance)),requirements=B(B(ride,.,F(price)),.,F(requirements)),time=B(B(ride,.,F(price)),.,F(time)),transit_waiting=B(B(ride,.,F(price)),.,F(transit_waiting)),waiting=B(B(ride,.,F(price)),.,F(waiting))));E("discount_value",VA(coeff_final));SV(delta,B(U(-,VA(affected_price)),*,VA(coeff_final)));E("discount_delta_raw",VA(delta));SV(mult,B(1.000000,-,VA(coeff_final)));CR(boarding=B(B(B(ride,.,F(price)),.,F(boarding)),*,VA(mult)),destination_waiting=B(B(ride,.,F(price)),.,F(destination_waiting)),distance=B(B(B(ride,.,F(price)),.,F(distance)),*,VA(mult)),requirements=B(B(B(ride,.,F(price)),.,F(requirements)),*,VA(mult)),time=B(B(B(ride,.,F(price)),.,F(time)),*,VA(mult)),transit_waiting=B(B(ride,.,F(price)),.,F(transit_waiting)),waiting=B(B(ride,.,F(price)),.,F(waiting))));CR(boarding=B(B(ride,.,F(price)),.,F(boarding)),destination_waiting=B(B(ride,.,F(price)),.,F(destination_waiting)),distance=B(B(ride,.,F(price)),.,F(distance)),requirements=B(B(ride,.,F(price)),.,F(requirements)),time=B(B(ride,.,F(price)),.,F(time)),transit_waiting=B(B(ride,.,F(price)),.,F(transit_waiting)),waiting=B(B(ride,.,F(price)),.,F(waiting)))