{
  "expected_journal_requests": [
    {
      "account": {
        "agreement_id": "taxi/driver_balance",
        "currency": "RUB",
        "entity_external_id": "taximeter_driver_id/7f74df/032880",
        "sub_account": "total"
      },
      "begin_time": "2018-12-20T00:00:00.000000+00:00",
      "cursor": "",
      "end_time": "2018-12-22T00:00:00.000000+00:00",
      "limit": 3,
      "skip_zero_entries": true,
      "sort": "desc"
    },
    {
      "account": {
        "agreement_id": "taxi/driver_balance",
        "currency": "RUB",
        "entity_external_id": "taximeter_park_id/7f74df"
      },
      "begin_time": "2018-12-20T00:00:00.000000+00:00",
      "cursor": "",
      "end_time": "2018-12-22T00:00:00.000000+00:00",
      "limit": 3,
      "skip_zero_entries": true,
      "sort": "desc"
    },
    {
      "account": {
        "agreement_id": "taxi/driver_balance",
        "currency": "RUB",
        "entity_external_id": "taximeter_driver_id/7f74df/032880",
        "sub_account": "total"
      },
      "begin_time": "2018-12-20T17:45:42.000000+00:00",
      "cursor": "2019-01-15T14:20:44.000000+00:00/13620169",
      "end_time": "2018-12-20T17:45:43.100000+00:00",
      "limit": 1,
      "skip_zero_entries": true,
      "sort": "desc"
    },
    {
      "account": {
        "agreement_id": "taxi/driver_balance",
        "currency": "RUB",
        "entity_external_id": "taximeter_park_id/7f74df"
      },
      "begin_time": "2018-12-20T17:45:42.000000+00:00",
      "cursor": "2019-01-15T14:20:44.000000+00:00/13620169",
      "end_time": "2018-12-20T17:45:43.100000+00:00",
      "limit": 1,
      "skip_zero_entries": true,
      "sort": "desc"
    }
  ],
  "expected_requested_resources": [
    [
      "/v1/journal/select:pg:entries",
      1
    ],
    [
      "/v1/journal/select:yt:entries",
      1
    ]
  ],
  "expected_response": {
    "cursor": {
      "2019-01-15T14:20:44.000000+00:00": "13620170"
    },
    "entries": [
      {
        "account": {
          "account_id": 2370170,
          "agreement_id": "taxi/driver_balance",
          "currency": "RUB",
          "entity_external_id": "taximeter_driver_id/7f74df/032880",
          "sub_account": "total"
        },
        "amount": "-468.0000",
        "created": "2019-01-15T14:27:14.016696+00:00",
        "doc_ref": "36010027",
        "entry_id": 13740170,
        "event_at": "2019-01-15T14:26:44.000000+00:00",
        "reason": ""
      },
      {
        "account": {
          "account_id": 2370170,
          "agreement_id": "taxi/driver_balance",
          "currency": "RUB",
          "entity_external_id": "taximeter_driver_id/7f74df/032880",
          "sub_account": "total"
        },
        "amount": "-92.1371",
        "created": "2019-01-15T14:22:20.148857+00:00",
        "doc_ref": "30070006",
        "entry_id": 13710170,
        "event_at": "2019-01-15T14:21:21.000000+00:00",
        "reason": ""
      },
      {
        "account": {
          "account_id": 2370170,
          "agreement_id": "taxi/driver_balance",
          "currency": "RUB",
          "entity_external_id": "taximeter_driver_id/7f74df/032880",
          "sub_account": "total"
        },
        "amount": "468.0000",
        "created": "2019-01-15T14:21:13.068590+00:00",
        "doc_ref": "35990027",
        "entry_id": 13620170,
        "event_at": "2019-01-15T14:20:44.000000+00:00",
        "reason": ""
      }
    ]
  },
  "expected_spent_resources": [
    [
      "/v1/journal/select:pg:entries",
      1
    ],
    [
      "/v1/journal/select:yt:entries",
      3
    ]
  ],
  "expected_yql_params": [
    [
      "//home/taxi/unstable/replica/api/billing_accounts/indexes/journal/account",
      "//home/taxi/unstable/replica/api/billing_accounts/journal",
      -1545436800000000,
      -1543622400000000,
      -1547562044000000,
      -1547562044000000,
      13620169,
      "^0+(\\.0+)?$",
      "taximeter_driver_id/7f74df/032880",
      "taxi/driver_balance",
      "RUB",
      "total",
      2
    ],
    [
      "//home/taxi/unstable/replica/api/billing_accounts/indexes/journal/account",
      "//home/taxi/unstable/replica/api/billing_accounts/journal",
      -1545436800000000,
      -1543622400000000,
      -1545436800000000,
      -1545436800000000,
      0,
      "^0+(\\.0+)?$",
      "taximeter_driver_id/7f74df/032880",
      "taxi/driver_balance",
      "RUB",
      "total",
      3
    ],
    [
      "//home/taxi/unstable/replica/api/billing_accounts/indexes/journal/account",
      "//home/taxi/unstable/replica/api/billing_accounts/journal",
      -1545436800000000,
      -1543622400000000,
      -1545436800000000,
      -1545436800000000,
      0,
      "^0+(\\.0+)?$",
      "taximeter_park_id/7f74df",
      "taxi/driver_balance",
      "RUB",
      3
    ],
    [
      "//home/taxi/unstable/replica/api/billing_accounts/indexes/journal/account",
      "//home/taxi/unstable/replica/api/billing_accounts/journal",
      -1545436800000000,
      -1543622400000000,
      -1547562044000000,
      -1547562044000000,
      13620169,
      "^0+(\\.0+)?$",
      "taximeter_park_id/7f74df",
      "taxi/driver_balance",
      "RUB",
      2
    ]
  ],
  "pg_data": {
    "taximeter_driver_id/7f74df/032880/taxi/driver_balance/RUB/total": [
      [
        {
          "account": {
            "agreement_id": "taxi/driver_balance",
            "currency": "RUB",
            "entity_external_id": "taximeter_driver_id/7f74df/032880",
            "sub_account": "total"
          },
          "account_id": 2370170,
          "amount": "-468.0000",
          "created": "2019-01-15T14:27:14.016696+00:00",
          "cursor": "2019-01-15T14:26:44.000000+00:00/13740170",
          "doc_ref": "36010027",
          "entry_id": 13740170,
          "event_at": "2019-01-15T14:26:44+00:00",
          "reason": ""
        }
      ]
    ],
    "taximeter_park_id/7f74df/taxi/driver_balance/RUB/None": [
      []
    ]
  },
  "request_body": {
    "accounts": [
      {
        "agreement_id": "taxi/driver_balance",
        "currency": "RUB",
        "entity_external_id": "taximeter_driver_id/7f74df/032880",
        "sub_account": "total"
      },
      {
        "agreement_id": "taxi/driver_balance",
        "currency": "RUB",
        "entity_external_id": "taximeter_park_id/7f74df"
      }
    ],
    "begin_time": "2018-12-01T00:00:00+00:00",
    "cursor": {},
    "end_time": "2018-12-22T00:00:00+00:00",
    "exclude": {
      "zero_entries": true
    },
    "limit": 3
  },
  "yt_data": {
    "^0+(\\.0+)?$/taximeter_driver_id/7f74df/032880/taxi/driver_balance/RUB": [
      {
        "items": [
          {
            "idx._dummy": null,
            "idx.agreement_id": "taxi/driver_balance",
            "idx.currency": "RUB",
            "idx.entity_external_id": "taximeter_driver_id/7f74df/032880",
            "idx.event_at": -1547562081000000,
            "idx.id": 13710170,
            "idx.sub_account": "total",
            "j.account_id": 2370170,
            "j.agreement_id": "taxi/driver_balance",
            "j.amount": "-92.1371",
            "j.created": 1547562140148857,
            "j.currency": "RUB",
            "j.details": null,
            "j.doc_ref": "30070006",
            "j.entity_external_id": "taximeter_driver_id/7f74df/032880",
            "j.event_at": 1547562081000000,
            "j.id": 13710170,
            "j.reason": "",
            "j.sub_account": "total"
          },
          {
            "idx._dummy": null,
            "idx.agreement_id": "taxi/driver_balance",
            "idx.currency": "RUB",
            "idx.entity_external_id": "taximeter_driver_id/7f74df/032880",
            "idx.event_at": -1547562044000000,
            "idx.id": 13620169,
            "idx.sub_account": "total",
            "j.account_id": 2370170,
            "j.agreement_id": "taxi/driver_balance",
            "j.amount": "-0.0000",
            "j.created": 1547562073068590,
            "j.currency": "RUB",
            "j.details": null,
            "j.doc_ref": "35990027",
            "j.entity_external_id": "taximeter_driver_id/7f74df/032880",
            "j.event_at": 1547562044000000,
            "j.id": 13620169,
            "j.reason": "",
            "j.sub_account": "total"
          }
        ]
      },
      {
        "items": [
          {
            "idx._dummy": null,
            "idx.agreement_id": "taxi/driver_balance",
            "idx.currency": "RUB",
            "idx.entity_external_id": "taximeter_driver_id/7f74df/032880",
            "idx.event_at": -1547562044000000,
            "idx.id": 13620170,
            "idx.sub_account": "total",
            "j.account_id": 2370170,
            "j.agreement_id": "taxi/driver_balance",
            "j.amount": "468.0000",
            "j.created": 1547562073068590,
            "j.currency": "RUB",
            "j.details": null,
            "j.doc_ref": "35990027",
            "j.entity_external_id": "taximeter_driver_id/7f74df/032880",
            "j.event_at": 1547562044000000,
            "j.id": 13620170,
            "j.reason": "",
            "j.sub_account": "total"
          }
        ]
      }
    ],
    "^0+(\\.0+)?$/taximeter_park_id/7f74df/taxi/driver_balance/RUB": [
      {
        "items": []
      },
      {
        "items": []
      }
    ]
  }
}
