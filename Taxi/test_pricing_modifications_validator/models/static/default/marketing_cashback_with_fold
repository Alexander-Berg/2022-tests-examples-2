FUNC(processRate,ARGS((cashback_fix,double),(elem,lang::variables::CashbackRate),(meta,std::unordered_map<std::string,double>)),B(SV(cashback_price,SL(4,25,4,48,B(U(*,B(ride,.,F(price))),*,B(FA(elem,lang::variables::CashbackRate),.,F(rate)))));SV(round_cashback_price,SL(5,31,5,76,B(VA(cashback_price),round_to,B(fix,.,F(rounding_factor)))));SV(cmeta,SL(7,16,10,5,MAP(B(B("marketing_cashback.",+,B(FA(elem,lang::variables::CashbackRate),.,F(sponsor))),+,".rate")=B(FA(elem,lang::variables::CashbackRate),.,F(rate)),B(B("marketing_cashback.",+,B(FA(elem,lang::variables::CashbackRate),.,F(sponsor))),+,".fix")=VA(round_cashback_price))));CR(cashback_fix=SL(13,21,13,56,B(FA(cashback_fix,double),+,VA(round_cashback_price))),meta=SL(14,13,15,4,B(FA(meta,std::unordered_map<std::string,double>),+,VA(cmeta))))));IF(U(?,SL(19,4,19,23,B(fix,.,F(cashback_rates)))),SV(result,SL(20,17,20,85,FL(SL(20,22,20,37,U(*,B(fix,.,F(cashback_rates)))),elem,NT(cashback_fix=SL(20,73,20,74,0.000000),meta=SL(20,81,20,83,MAP())),FC(processRate,NT(cashback_fix=VA(cashback_fix),elem=VA(elem),meta=VA(meta)),R(cashback_fix=double,meta=std::unordered_map<std::string,double>)))));SV(meta2,SL(22,16,24,5,MAP("marketing_cashback.fix"=B(VA(result),.,F(cashback_fix)))));CR(metadata=SL(27,17,28,4,B(B(VA(result),.,F(meta)),+,VA(meta2)))));CR(boarding=B(SL(31,7,31,17,B(ride,.,F(price))),.,F(boarding)),destination_waiting=B(SL(31,7,31,17,B(ride,.,F(price))),.,F(destination_waiting)),distance=B(SL(31,7,31,17,B(ride,.,F(price))),.,F(distance)),requirements=B(SL(31,7,31,17,B(ride,.,F(price))),.,F(requirements)),time=B(SL(31,7,31,17,B(ride,.,F(price))),.,F(time)),transit_waiting=B(SL(31,7,31,17,B(ride,.,F(price))),.,F(transit_waiting)),waiting=B(SL(31,7,31,17,B(ride,.,F(price))),.,F(waiting)))
