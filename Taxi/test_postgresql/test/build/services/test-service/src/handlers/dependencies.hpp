/* THIS FILE IS AUTOGENERATED, DON'T EDIT! */

#pragma once

#include <memory>
#include <type_traits>

#include <userver/components/component_fwd.hpp>
#include <userver/concurrent/background_task_storage_fwd.hpp>
#include <userver/dynamic_config/source.hpp>
#include <userver/utils/statistics/metrics_storage_fwd.hpp>

#include <codegen/impl/caches.hpp>
#include <custom/dependencies.hpp>
#include <userver/storages/postgres/database.hpp>

namespace handlers {

struct Dependencies final {
  dynamic_config::Snapshot config;
  utils::statistics::MetricsStoragePtr metrics;
  concurrent::BackgroundTaskStorage& bts;
  custom::Dependencies::Extra extra;

  ::storages::postgres::DatabasePtr pg_categories;
  ::storages::postgres::DatabasePtr pg_misc;
  ::storages::postgres::DatabasePtr pg_orders;
  ::storages::postgres::DatabasePtr pg_shared;
};

class DependenciesFactory final {
 public:
  DependenciesFactory(const components::ComponentConfig&,
                      const components::ComponentContext&);
  ~DependenciesFactory();

  Dependencies GetDependencies() const;

 private:
  const dynamic_config::Source config_source_;
  utils::statistics::MetricsStoragePtr metrics_storage_;
  mutable concurrent::BackgroundTaskStorageFastPimpl bts_;
  custom::Dependencies custom_dependencies_;
  ::storages::postgres::DatabasePtr pg_categories_;
  ::storages::postgres::DatabasePtr pg_misc_;
  ::storages::postgres::DatabasePtr pg_orders_;
  ::storages::postgres::DatabasePtr pg_shared_;
};

}  // namespace handlers
