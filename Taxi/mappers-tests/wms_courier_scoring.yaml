# Created with generator. Save this comment for future reference.
# Launch args: --source postgres --tables courier_scoring --secret-source POSTGRES_LAVKA_WMS_STAT --scope wms --replicate-by lsn --primary-keys courier_scoring_id --yt-struct --namespace eats
  - input:
        courier_scoring_id: fd947686b1054370af31c6e3d5c3a850000000000000
        statistics_week:
            $a:
                raw_type: date
            $v: '2022-02-21'
        external_courier_id: '4165703'
        shift_delivery_type: car
        region_name: Новосибирск
        orders: 30
        min_orders: 30
        n_couriers: 251
        mean_pickup_mnt: 1.38
        mean_dropoff_mnt: 4.068888888888889
        mean_velocity_to_customer_kmh: 11.432926829268292
        return_velocity_kmh: 15.501252881627746
        planned_shifts_cnt: 3
        started_shifts_cnt: 3
        missed_shifts_cnt: 0
        started_shifts_without_missed_hours_cnt: 3
        score_orders: 1
        score_shifts_with_bad_timing: 1
        score_missed_shifts: 1
        score_pickup_time: 3
        score_velocity_to_customer: 189
        score_dropoff_time: 131
        score_velocity_back: 69
        total_score: 395
        rating_position: 23
        created:
            $a:
                raw_type: datetime
            $v: '2022-03-04T08:47:25+00:00'
        updated:
            $a:
                raw_type: datetime
            $v: '2022-03-04T08:47:25+00:00'
        serial: 1
        lsn: 1
        sh: 20.1
        is_top: true
        dbid_uuid: example_string
        courier_id: example_string
    expected:
      - courier_scoring_id: fd947686b1054370af31c6e3d5c3a850000000000000
        statistics_week: '2022-02-21'
        external_courier_id: '4165703'
        shift_delivery_type: car
        region_name: Новосибирск
        orders: 30
        min_orders: 30
        n_couriers: 251
        mean_pickup_mnt: 1.38
        mean_dropoff_mnt: 4.068888888888889
        mean_velocity_to_customer_kmh: 11.432926829268292
        return_velocity_kmh: 15.501252881627746
        planned_shifts_cnt: 3
        started_shifts_cnt: 3
        missed_shifts_cnt: 0
        started_shifts_without_missed_hours_cnt: 3
        score_orders: 1
        score_shifts_with_bad_timing: 1
        score_missed_shifts: 1
        score_pickup_time: 3
        score_velocity_to_customer: 189
        score_dropoff_time: 131
        score_velocity_back: 69
        total_score: 395
        rating_position: 23
        created: '2022-03-04T08:47:25+00:00'
        updated: '2022-03-04T08:47:25+00:00'
        serial: 1
        lsn: 1
        sh: 20.1
        is_top: true
        dbid_uuid: example_string
        courier_id: example_string
  - input:
        courier_scoring_id: 9a07418e1d1c4cc68388549859e9034c000000000000
        statistics_week:
            $a:
                raw_type: date
            $v: '2022-02-21'
        external_courier_id: '5664746'
        shift_delivery_type: foot
        region_name: Казань
        orders: 30
        min_orders: 30
        n_couriers: 938
        mean_pickup_mnt: 4.498888888888889
        mean_dropoff_mnt: 4.877222222222223
        mean_velocity_to_customer_kmh: 7.925151348376442
        return_velocity_kmh: 6.292412044374009
        planned_shifts_cnt: 4
        started_shifts_cnt: 4
        missed_shifts_cnt: 0
        started_shifts_without_missed_hours_cnt: 4
        score_orders: 1
        score_shifts_with_bad_timing: 1
        score_missed_shifts: 1
        score_pickup_time: 602
        score_velocity_to_customer: 395
        score_dropoff_time: 585
        score_velocity_back: 701
        total_score: 2286
        rating_position: 65
        created:
            $a:
                raw_type: datetime
            $v: '2022-03-04T08:47:25+00:00'
        updated:
            $a:
                raw_type: datetime
            $v: '2022-03-04T08:47:25+00:00'
        serial: 2
        lsn: 2
        sh: 20.1
        is_top: true
        dbid_uuid: example_string
        courier_id: example_string
    expected:
      - courier_scoring_id: 9a07418e1d1c4cc68388549859e9034c000000000000
        statistics_week: '2022-02-21'
        external_courier_id: '5664746'
        shift_delivery_type: foot
        region_name: Казань
        orders: 30
        min_orders: 30
        n_couriers: 938
        mean_pickup_mnt: 4.498888888888889
        mean_dropoff_mnt: 4.877222222222223
        mean_velocity_to_customer_kmh: 7.925151348376442
        return_velocity_kmh: 6.292412044374009
        planned_shifts_cnt: 4
        started_shifts_cnt: 4
        missed_shifts_cnt: 0
        started_shifts_without_missed_hours_cnt: 4
        score_orders: 1
        score_shifts_with_bad_timing: 1
        score_missed_shifts: 1
        score_pickup_time: 602
        score_velocity_to_customer: 395
        score_dropoff_time: 585
        score_velocity_back: 701
        total_score: 2286
        rating_position: 65
        created: '2022-03-04T08:47:25+00:00'
        updated: '2022-03-04T08:47:25+00:00'
        serial: 2
        lsn: 2
        sh: 20.1
        is_top: true
        dbid_uuid: example_string
        courier_id: example_string
  - input:
        courier_scoring_id: cc042704960b47a694825ef4d5dfcca8000000000000
        statistics_week:
            $a:
                raw_type: date
            $v: '2022-02-21'
        external_courier_id: '3941750'
        shift_delivery_type: car
        region_name: Екатеринбург
        orders: 30
        min_orders: 30
        n_couriers: 36
        mean_pickup_mnt: 2.607222222222222
        mean_dropoff_mnt: 2.8016666666666667
        mean_velocity_to_customer_kmh: 14.644279037562749
        return_velocity_kmh: 19.08465075541931
        planned_shifts_cnt: 2
        started_shifts_cnt: 2
        missed_shifts_cnt: 0
        started_shifts_without_missed_hours_cnt: 2
        score_orders: 1
        score_shifts_with_bad_timing: 1
        score_missed_shifts: 1
        score_pickup_time: 7
        score_velocity_to_customer: 7
        score_dropoff_time: 8
        score_velocity_back: 2
        total_score: 27
        rating_position: 1
        created:
            $a:
                raw_type: datetime
            $v: '2022-03-04T08:47:25+00:00'
        updated:
            $a:
                raw_type: datetime
            $v: '2022-03-04T08:47:25+00:00'
        serial: 3
        lsn: 3
        sh: 20.1
        is_top: true
        dbid_uuid: example_string
        courier_id: example_string
    expected:
      - courier_scoring_id: cc042704960b47a694825ef4d5dfcca8000000000000
        statistics_week: '2022-02-21'
        external_courier_id: '3941750'
        shift_delivery_type: car
        region_name: Екатеринбург
        orders: 30
        min_orders: 30
        n_couriers: 36
        mean_pickup_mnt: 2.607222222222222
        mean_dropoff_mnt: 2.8016666666666667
        mean_velocity_to_customer_kmh: 14.644279037562749
        return_velocity_kmh: 19.08465075541931
        planned_shifts_cnt: 2
        started_shifts_cnt: 2
        missed_shifts_cnt: 0
        started_shifts_without_missed_hours_cnt: 2
        score_orders: 1
        score_shifts_with_bad_timing: 1
        score_missed_shifts: 1
        score_pickup_time: 7
        score_velocity_to_customer: 7
        score_dropoff_time: 8
        score_velocity_back: 2
        total_score: 27
        rating_position: 1
        created: '2022-03-04T08:47:25+00:00'
        updated: '2022-03-04T08:47:25+00:00'
        serial: 3
        lsn: 3
        sh: 20.1
        is_top: true
        dbid_uuid: example_string
        courier_id: example_string
