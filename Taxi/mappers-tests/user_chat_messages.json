[
  {
    "expected": [
      {
        "all_messages": [
          {
            "author": "first_author",
            "message": "first message text",
            "metadata": {
              "order_id": "first_order",
              "phone": "first_phone"
            }
          },
          {
            "author": "second_author",
            "message": "second message text",
            "metadata": {
              "order_id": "second_order",
              "phone": "second_phone"
            }
          }
        ],
        "chat_id": "539e99e1e7e5b1f5397adc5d",
        "chatterbox_id": "123123123",
        "csat_dialog": null,
        "csat_reasons": null,
        "csat_values": null,
        "first_message_meta": {
          "order_id": "first_order",
          "phone": "first_phone"
        },
        "first_message_text": "first message text",
        "new_messages": 3,
        "ticket_id": "123",
        "type": "client_support",
        "updated": 1504774334.772
      }
    ],
    "input": {
      "_id": {
        "$oid": "539e99e1e7e5b1f5397adc5d"
      },
      "chatterbox_id": "123123123",
      "messages": [
        {
          "author": "first_author",
          "message": "first message text",
          "metadata": {
            "order_id": "first_order",
            "phone": "first_phone"
          }
        },
        {
          "author": "second_author",
          "message": "second message text",
          "metadata": {
            "order_id": "second_order",
            "phone": "second_phone"
          }
        }
      ],
      "new_messages": 3,
      "ticket_id": 123,
      "type": "client_support",
      "updated": {
        "$date": 1504774334772
      }
    }
  },
  {
    "expected": [
      {
        "all_messages": [
          {
            "author": "first_author",
            "message": "first message text",
            "metadata": {
              "order_id": "first_order",
              "phone": "first_phone"
            }
          },
          {
            "author": "second_author",
            "message": "second message text",
            "metadata": {
              "order_id": "second_order",
              "phone": "second_phone"
            }
          }
        ],
        "chat_id": "539e99e1e7e5b1f5397adc5d",
        "chatterbox_id": "123123123",
        "csat_dialog": {
          "answers": [
            {
              "actions": [
                {
                  "id": "set_rating_horrible",
                  "text": "horrible",
                  "type": "rating"
                },
                {
                  "id": "set_rating_normal",
                  "text": "normal",
                  "type": "rating"
                },
                {
                  "id": "set_rating_amazing",
                  "text": "amazing",
                  "type": "rating"
                },
                {
                  "id": "cancel",
                  "text": "problem not solved",
                  "type": "exit"
                }
              ],
              "created": 1504774334.772,
              "id": "00000000000040008000000000000000",
              "question": "how do you like this?",
              "state": "waiting_qa_rating"
            }
          ],
          "last_action_id": "change_rating",
          "last_request_id": "some_request_id",
          "new_messages_count": 1,
          "state": "waiting_qa_rating"
        },
        "csat_reasons": [
          "template_answer",
          "helped_me"
        ],
        "csat_values": [
          "horrible",
          "normal"
        ],
        "first_message_meta": {
          "order_id": "first_order",
          "phone": "first_phone"
        },
        "first_message_text": "first message text",
        "new_messages": 3,
        "ticket_id": "test_ticket",
        "type": "client_support",
        "updated": 1504774334.772
      }
    ],
    "input": {
      "_id": {
        "$oid": "539e99e1e7e5b1f5397adc5d"
      },
      "chatterbox_id": "123123123",
      "csat_dialog": {
        "answers": [
          {
            "actions": [
              {
                "id": "set_rating_horrible",
                "text": "horrible",
                "type": "rating"
              },
              {
                "id": "set_rating_normal",
                "text": "normal",
                "type": "rating"
              },
              {
                "id": "set_rating_amazing",
                "text": "amazing",
                "type": "rating"
              },
              {
                "id": "cancel",
                "text": "problem not solved",
                "type": "exit"
              }
            ],
            "created": {
              "$date": 1504774334772
            },
            "id": "00000000000040008000000000000000",
            "question": "how do you like this?",
            "state": "waiting_qa_rating"
          }
        ],
        "last_action_id": "change_rating",
        "last_request_id": "some_request_id",
        "new_messages_count": 1,
        "state": "waiting_qa_rating"
      },
      "csat_reasons": [
        "template_answer",
        "helped_me"
      ],
      "csat_values": [
        "horrible",
        "normal"
      ],
      "messages": [
        {
          "author": "first_author",
          "message": "first message text",
          "metadata": {
            "order_id": "first_order",
            "phone": "first_phone"
          }
        },
        {
          "author": "second_author",
          "message": "second message text",
          "metadata": {
            "order_id": "second_order",
            "phone": "second_phone"
          }
        }
      ],
      "new_messages": 3,
      "ticket_id": "test_ticket",
      "type": "client_support",
      "updated": {
        "$date": 1504774334772
      }
    }
  }
]
