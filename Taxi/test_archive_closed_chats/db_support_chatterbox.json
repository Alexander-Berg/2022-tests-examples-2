[
  {
    "_id": "must_be_archived",
    "chat_type": "client",
    "created": {
      "$date": "2018-05-05T12:34:56.000Z"
    },
    "external_id": "some_user_chat_message_id",
    "history": [
      {
        "action": "update_meta",
        "created": {
          "$date": "2018-05-05T12:35:56.000Z"
        },
        "latency": 60,
        "line": "first",
        "login": "superuser"
      },
      {
        "action": "take",
        "created": {
          "$date": "2018-05-05T12:36:56.000Z"
        },
        "latency": 60,
        "line": "first",
        "login": "some_login"
      },
      {
        "action": "hidden_comment",
        "comment": "Test comment",
        "created": {
          "$date": "2018-05-05T12:37:56.000Z"
        },
        "latency": 60,
        "line": "first",
        "login": "some_login"
      },
      {
        "action": "reopen",
        "created": {
          "$date": "2018-05-05T12:38:26.000Z"
        },
        "line": "first",
        "login": "superuser"
      },
      {
        "action": "hidden_comment",
        "comment": "Another test comment",
        "created": {
          "$date": "2018-05-05T12:39:56.000Z"
        },
        "latency": 60,
        "line": "first",
        "login": "another_login"
      }
    ],
    "inner_comments": [
      {
        "comment": "Test comment",
        "created": {
          "$date": "2018-05-05T12:37:56.000Z"
        },
        "login": "some_login"
      },
      {
        "comment": "Another test comment",
        "created": {
          "$date": "2018-05-05T12:38:56.000Z"
        },
        "login": "another_login"
      }
    ],
    "line": "first",
    "meta_info": {
      "city": "Moscow",
      "country": "rus",
      "macro_id": "some_macro_id",
      "service": "eats",
      "user_phone": "some_user_phone",
      "zendesk_profile": "yataxi"
    },
    "status": "ready_to_archive",
    "support_admin": "some_admin",
    "type": "chat",
    "updated": {
      "$date": "2018-05-07T12:34:56.000Z"
    }
  },
  {
    "_id": "must_also_be_archived",
    "chat_type": "client",
    "created": {
      "$date": "2018-05-05T12:34:56.000Z"
    },
    "external_id": "some_user_chat_message_id_1",
    "history": [],
    "inner_comments": [
      {
        "comment": "Comment",
        "created": {
          "$date": "2018-03-05T12:34:56.000Z"
        },
        "login": "test_login"
      }
    ],
    "line": "first",
    "meta_info": {
      "country": "usa",
      "csat_reasons": [
        "fast_answer",
        "thank_you"
      ],
      "csat_value": "amazing",
      "not_zendesk_custom_field": "value",
      "user_phone": "another_user_phone",
      "zendesk_profile": "yataxi"
    },
    "status": "ready_to_archive",
    "support_admin": "some_admin",
    "tags": [
      "one",
      "two",
      "three"
    ],
    "type": "chat",
    "updated": {
      "$date": "2018-05-07T12:34:56.000Z"
    }
  },
  {
    "_id": "must_not_be_archived",
    "chat_type": "bank",
    "created": {
      "$date": "2018-05-05T12:34:56.000Z"
    },
    "external_id": "some_user_chat_message_id_7",
    "history": [],
    "inner_comments": [
      {
        "comment": "Comment",
        "created": {
          "$date": "2018-03-05T12:34:56.000Z"
        },
        "login": "test_login"
      }
    ],
    "line": "first",
    "meta_info": {
      "country": "usa",
      "csat_reasons": [
        "fast_answer",
        "thank_you"
      ],
      "csat_value": "amazing",
      "not_zendesk_custom_field": "value",
      "user_phone": "another_user_phone",
      "zendesk_profile": "yataxi"
    },
    "status": "ready_to_archive",
    "support_admin": "some_admin",
    "tags": [
      "one",
      "two",
      "three"
    ],
    "type": "chat",
    "updated": {
      "$date": "2018-05-07T12:34:56.000Z"
    }
  },
  {
    "_id": "driver_must_be_archived",
    "chat_type": "driver",
    "created": {
      "$date": "2018-05-05T12:34:56.000Z"
    },
    "external_id": "some_user_chat_message_id_2",
    "history": [
      {
        "action": "update_meta",
        "created": {
          "$date": "2018-05-07T12:34:56.000Z"
        },
        "login": "superuser",
        "meta_changes": [
          {
            "change_type": "set",
            "field_name": "park_db_id",
            "value": "some_db_id"
          },
          {
            "change_type": "set",
            "field_name": "driver_id",
            "value": "some_driver_id"
          },
          {
            "change_type": "set",
            "field_name": "driver_uuid",
            "value": "some_driver_uuid"
          },
          {
            "change_type": "set",
            "field_name": "driver_license",
            "value": "some_driver_license"
          }
        ]
      }
    ],
    "inner_comments": [
      {
        "comment": "Comment",
        "created": {
          "$date": "2018-03-05T12:34:56.000Z"
        },
        "login": "test_login"
      }
    ],
    "line": "first",
    "meta_info": {
      "driver_license": "AAAAA",
      "zendesk_profile": "yataxi"
    },
    "status": "ready_to_archive",
    "support_admin": "some_admin",
    "tags": [
      "one",
      "two",
      "three"
    ],
    "type": "chat",
    "updated": {
      "$date": "2018-05-07T12:34:56.000Z"
    }
  },
  {
    "_id": "already_archived",
    "chat_type": "client",
    "created": {
      "$date": "2018-05-07T12:34:56.000Z"
    },
    "external_id": "some_user_chat_message_id_3",
    "history": [],
    "line": "first",
    "meta_info": {
      "user_phone": "some_user_phone",
      "zendesk_profile": "yataxi"
    },
    "status": "archived",
    "type": "chat",
    "updated": {
      "$date": "2018-05-07T12:34:56.000Z"
    }
  },
  {
    "_id": "is_still_archiving",
    "chat_type": "client",
    "created": {
      "$date": "2018-05-07T12:34:56.000Z"
    },
    "external_id": "some_user_chat_message_id_4",
    "history": [],
    "line": "first",
    "meta_info": {
      "user_phone": "third_user_phone",
      "zendesk_profile": "yataxi"
    },
    "status": "archive_in_progress",
    "type": "chat",
    "updated": {
      "$date": "2018-05-07T12:34:56.000Z"
    }
  },
  {
    "_id": "must_be_rearchived",
    "chat_type": "client",
    "created": {
      "$date": "2017-05-07T12:34:56.000Z"
    },
    "external_id": "some_user_chat_message_id_5",
    "history": [
      {
        "action": "update_meta",
        "created": {
          "$date": "2018-05-07T12:34:56.000Z"
        },
        "login": "superuser",
        "meta_changes": [
          {
            "change_type": "set",
            "field_name": "order_id",
            "value": "some_order_id"
          },
          {
            "change_type": "set",
            "field_name": "park_db_id",
            "value": "db_id"
          },
          {
            "change_type": "set",
            "field_name": "order_alias_id",
            "value": "order_alias"
          },
          {
            "change_type": "set",
            "field_name": "driver_id",
            "value": "id_uuid"
          },
          {
            "change_type": "set",
            "field_name": "driver_uuid",
            "value": "uuid"
          },
          {
            "change_type": "set",
            "field_name": "user_phone",
            "value": "+71234567890"
          }
        ]
      }
    ],
    "line": "first",
    "meta_info": {
      "user_phone": "another_user_phone",
      "zendesk_profile": "yataxi"
    },
    "status": "archive_in_progress",
    "type": "chat",
    "updated": {
      "$date": "2017-05-07T12:34:56.000Z"
    }
  },
  {
    "_id": "must_be_in_progress",
    "chat_type": "client",
    "created": {
      "$date": "2018-05-07T12:34:56.000Z"
    },
    "external_id": "some_user_chat_message_id_6",
    "history": [],
    "line": "first",
    "meta_info": {
      "user_phone": "some_user_phone",
      "zendesk_profile": "yataxi"
    },
    "status": "in_progress",
    "support_admin": "superuser",
    "type": "chat",
    "updated": {
      "$date": "2018-05-07T12:34:56.000Z"
    }
  },
  {
    "_id": "must_fail_support_chat",
    "chat_type": "client",
    "created": {
      "$date": "2017-05-07T12:34:56.000Z"
    },
    "external_id": "bad_user_chat_message_id_7",
    "history": [],
    "line": "first",
    "meta_info": {
      "user_phone": "another_user_phone",
      "zendesk_profile": "yataxi"
    },
    "status": "archive_in_progress",
    "type": "chat",
    "updated": {
      "$date": "2017-05-07T12:34:56.000Z"
    }
  },
  {
    "_id": "yutaxi_ticket_id",
    "chat_type": "client",
    "created": {
      "$date": "2018-05-05T12:34:56.000Z"
    },
    "external_id": "some_user_chat_message_id_14",
    "history": [],
    "line": "first",
    "meta_info": {
      "country": "usa",
      "not_zendesk_custom_field": "value",
      "user_phone": "another_user_phone",
      "zendesk_profile": "yutaxi"
    },
    "status": "ready_to_archive",
    "support_admin": "some_admin",
    "tags": [
      "one",
      "two",
      "three"
    ],
    "type": "chat",
    "updated": {
      "$date": "2018-05-07T12:34:56.000Z"
    }
  },
  {
    "_id": {
      "$oid": "5b2cae5cb2682a976914c2a6"
    },
    "chat_type": "client",
    "created": {
      "$date": "2018-05-05T12:34:56.000Z"
    },
    "external_id": "some_user_chat_message_id_15",
    "history": [
      {
        "action": "update_meta",
        "created": {
          "$date": "2018-05-05T12:35:56.000Z"
        },
        "latency": 60,
        "line": "first",
        "login": "superuser"
      },
      {
        "action": "take",
        "created": {
          "$date": "2018-05-05T12:36:56.000Z"
        },
        "latency": 60,
        "line": "first",
        "login": "some_login"
      },
      {
        "action": "hidden_comment",
        "comment": "Test comment",
        "created": {
          "$date": "2018-05-05T12:37:56.000Z"
        },
        "latency": 60,
        "line": "first",
        "login": "some_login"
      },
      {
        "action": "reopen",
        "created": {
          "$date": "2018-05-05T12:38:26.000Z"
        },
        "line": "first",
        "login": "superuser"
      },
      {
        "action": "hidden_comment",
        "comment": "Another test comment",
        "created": {
          "$date": "2018-05-05T12:39:56.000Z"
        },
        "latency": 60,
        "line": "first",
        "login": "another_login"
      }
    ],
    "inner_comments": [
      {
        "comment": "Test comment",
        "created": {
          "$date": "2018-05-05T12:37:56.000Z"
        },
        "login": "some_login"
      },
      {
        "comment": "Another test comment",
        "created": {
          "$date": "2018-05-05T12:38:56.000Z"
        },
        "login": "another_login"
      }
    ],
    "line": "first",
    "meta_info": {
      "city": "Moscow",
      "country": "rus",
      "macro_id": "some_macro_id",
      "service": "eats",
      "user_phone": "some_user_phone",
      "zendesk_profile": "yataxi"
    },
    "status": "ready_to_archive",
    "support_admin": "some_admin",
    "type": "chat",
    "updated": {
      "$date": "2018-05-07T12:34:56.000Z"
    }
  }
]
