<test>
    <variables>

        <path>
            <instance id="blackbox">blackbox</instance>
        </path>

        <cgi name="format">
            <instance id="xml">xml</instance>
            <instance id="json">json</instance>
        </cgi>

        <cgi name="method">
            <instance id="createsession">createsession</instance>
            <instance id="editsession">editsession</instance>
            <instance id="sessionid">sessionid</instance>
        </cgi>

        <cgi name="op">
            <instance id="select">select</instance>
            <instance id="delete">delete</instance>
        </cgi>

        <cgi name="userip">
            <instance id="user">95.108.132.10</instance>
            <instance id="v6">2a02:6b8:0:408:f8e3:67e4:b0b4:691c</instance>
        </cgi>

        <cgi name="uid">
            <instance id="junit-test">70500</instance>
            <instance id="dot.user">70501</instance>
            <instance id="staff_user">70502</instance>
        </cgi>

        <cgi name="keyspace">
            <instance id="ru">yandex.ru</instance>
            <instance id="com">yandex.com</instance>
        </cgi>

        <cgi name="auth_time">
            <instance id="1344252683198">1344252683198</instance>
        </cgi>

        <cgi name="create_time" func="genunixtime">
            <instance id="5min_ago">
                <arg name="time">-600</arg>
            </instance>
        </cgi>

        <cgi name="host_id">
            <instance id="ab">ab</instance>
        </cgi>

        <cgi name="guard_hosts">
            <instance id="empty"></instance>
            <instance id="bad">mail.ru</instance>
            <instance id="bad2">passport.yandex.ru</instance>
            <instance id="dryrun_ru">qa-sessguard-test-dryrun.yandex.ru</instance>
            <instance id="dryrun_com">qa-sessguard-test-dryrun.yandex.com</instance>
            <instance id="ru+com+bad">passport-test.yandex.ru,qa-sessguard-test-dryrun.yandex.com,neyandex.ru</instance>
            <instance id="tworu+com+bad">www1.passportdev.yandex.ru,qa-sessguard-test-dryrun.yandex.ru,qa-sessguard-test-dryrun.yandex.com,neyandex.ru</instance>
            <instance id="twocom+ru+bad">www1.passportdev.yandex.com,qa-sessguard-test-dryrun.yandex.com,qa-sessguard-test-dryrun.yandex.ru,neyandex.com</instance>
        </cgi>

        <cgi name="sessionid" func="gensessid">
            <arg name="uid">70502</arg>
            <arg name="authtime">1564760242111</arg>
            <arg name="authip">95.108.132.35</arg>
            <arg name="authid">127</arg>
            <arg name="flag">session</arg>

            <instance id="ru_valid">
                <arg name="host">beta.yandex.ru</arg>
                <arg name="type">valid</arg>
                <arg name="time">-10</arg>
            </instance>
            <instance id="ru_need_reset">
                <arg name="host">beta.yandex.ru</arg>
                <arg name="type">need_reset</arg>
            </instance>
            <instance id="com_valid">
                <arg name="host">someservice.yandex.com</arg>
                <arg name="type">valid</arg>
                <arg name="time">-10</arg>
            </instance>
            <instance id="com_need_reset">
                <arg name="host">someservice.yandex.com</arg>
                <arg name="type">need_reset</arg>
            </instance>
            <instance id="com_multi">
                <arg name="host">beta.yandex.com</arg>
                <arg name="type">valid</arg>
                <arg name="uid">123123</arg>
                <arg name="time">-10</arg>
                <arg name="default_index">1</arg>
                <arg name="uid_1">70502</arg>
                <arg name="flags_1">2</arg>
                <arg name="pwdtime_1">-1</arg>
                <arg name="lang_1">1</arg>
                <arg name="uid_2">70500</arg>
                <arg name="pwdtime_2">1111</arg>
                <arg name="lang_2">3</arg>
            </instance>
        </cgi>

        <cgi name="host">
            <instance id="ru_passp">www.dev.passportdev.yandex.ru</instance>
            <instance id="ru_dryrun">www1.qa-sessguard-test-dryrun.yandex.ru</instance>
            <instance id="ru_noguard">passport.yandex.ru</instance>
            <instance id="com_passp">www.passport-test.yandex.com</instance>
            <instance id="com_dryrun">.qa-sessguard-test-dryrun.yandex.com</instance>
            <instance id="com_noguard">qa-sessguard-dryrun.yandex.com</instance>
        </cgi>

        <cgi name="resign">
            <instance id="yes"></instance>
        </cgi>

        <cgi name="force_resign">
            <instance id="yes"></instance>
        </cgi>

        <cgi name="sessguard" func="gensessguard">
            <instance id="passport_ru">
                <arg name="authid">1564760242111:I4RsXw:127</arg>
                <arg name="host">www.passportdev.yandex.ru</arg>
                <arg name="time">-2600000</arg>
            </instance>
            <instance id="dryrun_ru">
                <arg name="authid">1564760242111:I4RsXw:127</arg>
                <arg name="host">qa-sessguard-test-dryrun.yandex.ru</arg>
            </instance>
            <instance id="passport_ru_bad_authid">
                <arg name="authid">1314151617234:I4RsXw:127</arg>
                <arg name="host">www.passportdev.yandex.ru</arg>
                <arg name="time">-2600000</arg>
            </instance>
            <instance id="dryrun_ru_bad_authid">
                <arg name="authid">1564760242111:i4rsxw:127</arg>
                <arg name="host">qa-sessguard-test-dryrun.yandex.ru</arg>
            </instance>
            <instance id="passport_com">
                <arg name="authid">1564760242111:I4RsXw:127</arg>
                <arg name="host">www.passport-test.yandex.com</arg>
                <arg name="time">-2600000</arg>
            </instance>
            <instance id="dryrun_com">
                <arg name="authid">1564760242111:I4RsXw:127</arg>
                <arg name="host">qa-sessguard-test-dryrun.yandex.com</arg>
            </instance>
            <instance id="passport_ua">
                <arg name="authid">1564760242111:I4RsXw:127</arg>
                <arg name="host">passportdev.yandex.ua</arg>
                <arg name="time">-2600000</arg>
            </instance>
            <instance id="dryrun_ua">
                <arg name="authid">1564760242111:I4RsXw:127</arg>
                <arg name="host">qa-sessguard-test-dryrun.yandex.ua</arg>
            </instance>
        </cgi>

        <result name="fail">
            <body func="matchxpath">
                <arg name="fail">yes</arg>
            </body>
        </result>

        <result name="create_by_bad_session">
            <body func="matchxpath">
                <arg name="/doc/exception[@id='2']">INVALID_PARAMS</arg>
                <arg name="/doc/error" comp="starts_with">BlackBox error: Sessionid cookie not valid</arg>
                <arg name="/doc/default_uid">dontmatch</arg>
                <arg name="/doc/new-session">dontmatch</arg>
                <arg name="/doc/new-sessguards">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/exception/value">INVALID_PARAMS</arg>
                <arg name="/exception/id">2</arg>
                <arg name="/error" comp="starts_with">BlackBox error: Sessionid cookie not valid</arg>
                <arg name="/new-session">dontmatch</arg>
                <arg name="/new-sessguards">dontmatch</arg>
            </jsonBody>
        </result>

        <result name="create_ru_noguard">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid" substitute="1">\~`cgi:uid`</arg>
                <arg name="/doc/authid" substitute="1">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                <arg name="/doc/authid/@time" substitute="1">\~`cgi:auth_time`</arg>
                <arg name="/doc/authid/@ip" substitute="1">\~`cgi:userip`</arg>
                <arg name="/doc/authid/@host" substitute="1">\~`cgi:host_id`</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70500</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                </arg>
                <arg name="/doc/new-sessguards/host">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid" substitute="1">\~`cgi:uid`</arg>
                <arg name="/authid/id" substitute="1">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                <arg name="/authid/time" substitute="1">\~`cgi:auth_time`</arg>
                <arg name="/authid/ip" substitute="1">\~`cgi:userip`</arg>
                <arg name="/authid/host" substitute="1">\~`cgi:host_id`</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70500</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                </arg>
                <arg name="/new-sessguards/0">dontmatch</arg>
            </jsonBody>
        </result>
        <result name="create_com_noguard">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid" substitute="1">\~`cgi:uid`</arg>
                <arg name="/doc/authid" substitute="1">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                <arg name="/doc/authid/@time" substitute="1">\~`cgi:auth_time`</arg>
                <arg name="/doc/authid/@ip" substitute="1">\~`cgi:userip`</arg>
                <arg name="/doc/authid/@host" substitute="1">\~`cgi:host_id`</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70500</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                </arg>
                <arg name="/doc/new-sessguards/host">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid" substitute="1">\~`cgi:uid`</arg>
                <arg name="/authid/id" substitute="1">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                <arg name="/authid/time" substitute="1">\~`cgi:auth_time`</arg>
                <arg name="/authid/ip" substitute="1">\~`cgi:userip`</arg>
                <arg name="/authid/host" substitute="1">\~`cgi:host_id`</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70500</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                </arg>
                <arg name="/new-sessguards/0">dontmatch</arg>
            </jsonBody>
        </result>

        <result name="create_ru_guard_dryrun">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid" substitute="1">\~`cgi:uid`</arg>
                <arg name="/doc/authid" substitute="1">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                <arg name="/doc/authid/@time" substitute="1">\~`cgi:auth_time`</arg>
                <arg name="/doc/authid/@ip" substitute="1">\~`cgi:userip`</arg>
                <arg name="/doc/authid/@host" substitute="1">\~`cgi:host_id`</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70500</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                </arg>
                <arg name="count(/doc/new-sessguards/host)">1</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.ru</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid" substitute="1">\~`cgi:uid`</arg>
                <arg name="/authid/id" substitute="1">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                <arg name="/authid/time" substitute="1">\~`cgi:auth_time`</arg>
                <arg name="/authid/ip" substitute="1">\~`cgi:userip`</arg>
                <arg name="/authid/host" substitute="1">\~`cgi:host_id`</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70500</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                </arg>
                <arg name="/new-sessguards" res_mod="key_count">1</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.ru</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
            </jsonBody>
        </result>
        <result name="create_ru_guard_passtest">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid" substitute="1">\~`cgi:uid`</arg>
                <arg name="/doc/authid" substitute="1">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                <arg name="/doc/authid/@time" substitute="1">\~`cgi:auth_time`</arg>
                <arg name="/doc/authid/@ip" substitute="1">\~`cgi:userip`</arg>
                <arg name="/doc/authid/@host" substitute="1">\~`cgi:host_id`</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70500</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                </arg>
                <arg name="count(/doc/new-sessguards/host)">1</arg>
                <arg name="/doc/new-sessguards/host[@id='passport-test.yandex.ru']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passport-test.yandex.ru</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='passport-test.yandex.ru']/sessguard/@domain">.passport-test.yandex.ru</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid" substitute="1">\~`cgi:uid`</arg>
                <arg name="/authid/id" substitute="1">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                <arg name="/authid/time" substitute="1">\~`cgi:auth_time`</arg>
                <arg name="/authid/ip" substitute="1">\~`cgi:userip`</arg>
                <arg name="/authid/host" substitute="1">\~`cgi:host_id`</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70500</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                </arg>
                <arg name="/new-sessguards" res_mod="key_count">1</arg>
                <arg name="/new-sessguards/passport-test.yandex.ru/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passport-test.yandex.ru</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/new-sessguards/passport-test.yandex.ru/sessguard/domain">.passport-test.yandex.ru</arg>
            </jsonBody>
        </result>

        <result name="create_com_guard_dryrun">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid" substitute="1">\~`cgi:uid`</arg>
                <arg name="/doc/authid" substitute="1">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                <arg name="/doc/authid/@time" substitute="1">\~`cgi:auth_time`</arg>
                <arg name="/doc/authid/@ip" substitute="1">\~`cgi:userip`</arg>
                <arg name="/doc/authid/@host" substitute="1">\~`cgi:host_id`</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70500</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                </arg>
                <arg name="count(/doc/new-sessguards/host)">1</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.com</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_com</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.com</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid" substitute="1">\~`cgi:uid`</arg>
                <arg name="/authid/id" substitute="1">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                <arg name="/authid/time" substitute="1">\~`cgi:auth_time`</arg>
                <arg name="/authid/ip" substitute="1">\~`cgi:userip`</arg>
                <arg name="/authid/host" substitute="1">\~`cgi:host_id`</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70500</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                </arg>
                <arg name="/new-sessguards" res_mod="key_count">1</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.com</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_com</arg>
                </arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/domain">.qa-sessguard-test-dryrun.yandex.com</arg>
            </jsonBody>
        </result>

        <result name="create_ru_guard_two">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid" substitute="1">\~`cgi:uid`</arg>
                <arg name="/doc/authid" substitute="1">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                <arg name="/doc/authid/@time" substitute="1">\~`cgi:auth_time`</arg>
                <arg name="/doc/authid/@ip" substitute="1">\~`cgi:userip`</arg>
                <arg name="/doc/authid/@host" substitute="1">\~`cgi:host_id`</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70500</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                </arg>
                <arg name="count(/doc/new-sessguards/host)">2</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.ru</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.ru']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passportdev.yandex.ru</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.ru']/sessguard/@domain">.passportdev.yandex.ru</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid" substitute="1">\~`cgi:uid`</arg>
                <arg name="/authid/id" substitute="1">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                <arg name="/authid/time" substitute="1">\~`cgi:auth_time`</arg>
                <arg name="/authid/ip" substitute="1">\~`cgi:userip`</arg>
                <arg name="/authid/host" substitute="1">\~`cgi:host_id`</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70500</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                </arg>
                <arg name="/new-sessguards" res_mod="key_count">2</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.ru</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.ru/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passportdev.yandex.ru</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.ru/sessguard/domain">.passportdev.yandex.ru</arg>
            </jsonBody>
        </result>

        <result name="create_com_guard_two">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid" substitute="1">\~`cgi:uid`</arg>
                <arg name="/doc/authid" substitute="1">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                <arg name="/doc/authid/@time" substitute="1">\~`cgi:auth_time`</arg>
                <arg name="/doc/authid/@ip" substitute="1">\~`cgi:userip`</arg>
                <arg name="/doc/authid/@host" substitute="1">\~`cgi:host_id`</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70500</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                </arg>
                <arg name="count(/doc/new-sessguards/host)">2</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.com</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_com</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.com</arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.com']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passportdev.yandex.com</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_com</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.com']/sessguard/@domain">.passportdev.yandex.com</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid" substitute="1">\~`cgi:uid`</arg>
                <arg name="/authid/id" substitute="1">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                <arg name="/authid/time" substitute="1">\~`cgi:auth_time`</arg>
                <arg name="/authid/ip" substitute="1">\~`cgi:userip`</arg>
                <arg name="/authid/host" substitute="1">\~`cgi:host_id`</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70500</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                </arg>
                <arg name="/new-sessguards" res_mod="key_count">2</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.com</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_com</arg>
                </arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/domain">.qa-sessguard-test-dryrun.yandex.com</arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.com/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passportdev.yandex.com</arg>
                    <arg name="authid">\~`cgi:auth_time`:\~`@@cgi:userip`:\~`cgi:host_id`</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_com</arg>
                </arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.com/sessguard/domain">.passportdev.yandex.com</arg>
            </jsonBody>
        </result>

        <result name="transform_ru_noguard">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid">70502</arg>
                <arg name="/doc/authid">1564760242111:I4RsXw:127</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/doc/new-sessguards/host">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid">70502</arg>
                <arg name="/authid/id">1564760242111:I4RsXw:127</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/new-sessguards/0">dontmatch</arg>
            </jsonBody>
        </result>
        <result name="transform_com_noguard">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid">70502</arg>
                <arg name="/doc/authid">1564760242111:I4RsXw:127</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/doc/new-sessguards/host">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid">70502</arg>
                <arg name="/authid/id">1564760242111:I4RsXw:127</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/new-sessguards/0">dontmatch</arg>
            </jsonBody>
        </result>

        <result name="transform_ru_guard_dryrun">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid">70502</arg>
                <arg name="/doc/authid">1564760242111:I4RsXw:127</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="count(/doc/new-sessguards/host)">1</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_ru</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid">70502</arg>
                <arg name="/authid/id">1564760242111:I4RsXw:127</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/new-sessguards" res_mod="key_count">1</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_ru</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
            </jsonBody>
        </result>
        <result name="transform_ru_guard_passtest">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid">70502</arg>
                <arg name="/doc/authid">1564760242111:I4RsXw:127</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="count(/doc/new-sessguards/host)">1</arg>
                <arg name="/doc/new-sessguards/host[@id='passport-test.yandex.ru']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passport-test.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_ru</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='passport-test.yandex.ru']/sessguard/@domain">.passport-test.yandex.ru</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid">70502</arg>
                <arg name="/authid/id">1564760242111:I4RsXw:127</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/new-sessguards" res_mod="key_count">1</arg>
                <arg name="/new-sessguards/passport-test.yandex.ru/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passport-test.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_ru</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/new-sessguards/passport-test.yandex.ru/sessguard/domain">.passport-test.yandex.ru</arg>
            </jsonBody>
        </result>
        <result name="transform_com_guard_dryrun">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid">70502</arg>
                <arg name="/doc/authid">1564760242111:I4RsXw:127</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="count(/doc/new-sessguards/host)">1</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.com</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_com</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.com</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid">70502</arg>
                <arg name="/authid/id">1564760242111:I4RsXw:127</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/new-sessguards" res_mod="key_count">1</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.com</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_com</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/domain">.qa-sessguard-test-dryrun.yandex.com</arg>
            </jsonBody>
        </result>

        <result name="transform_ru_guard_two">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid">70502</arg>
                <arg name="/doc/authid">1564760242111:I4RsXw:127</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="count(/doc/new-sessguards/host)">2</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_ru</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.ru']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passportdev.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_ru</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.ru']/sessguard/@domain">.passportdev.yandex.ru</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid">70502</arg>
                <arg name="/authid/id">1564760242111:I4RsXw:127</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/new-sessguards" res_mod="key_count">2</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_ru</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.ru/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passportdev.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_ru</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.ru/sessguard/domain">.passportdev.yandex.ru</arg>
            </jsonBody>
        </result>
        <result name="transform_com_guard_two">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid">70502</arg>
                <arg name="/doc/authid">1564760242111:I4RsXw:127</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="count(/doc/new-sessguards/host)">2</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.com</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_com</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.com</arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.com']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passportdev.yandex.com</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_com</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.com']/sessguard/@domain">.passportdev.yandex.com</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid">70502</arg>
                <arg name="/authid/id">1564760242111:I4RsXw:127</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/new-sessguards" res_mod="key_count">2</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.com</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_com</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/domain">.qa-sessguard-test-dryrun.yandex.com</arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.com/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passportdev.yandex.com</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_com</arg>
                    <arg name="time">-600</arg>
                </arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.com/sessguard/domain">.passportdev.yandex.com</arg>
            </jsonBody>
        </result>

        <result name="edit_with_bad_sessguard">
            <body func="matchxpath">
                <arg name="/doc/exception[@id='2']">INVALID_PARAMS</arg>
                <arg name="/doc/error" comp="starts_with">BlackBox error: SessGuard is not valid. </arg>
                <arg name="/doc/default_uid">dontmatch</arg>
                <arg name="/doc/new-session">dontmatch</arg>
                <arg name="/doc/new-sessguards">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/exception/value">INVALID_PARAMS</arg>
                <arg name="/exception/id">2</arg>
                <arg name="/error" comp="starts_with">BlackBox error: SessGuard is not valid. </arg>
                <arg name="/new-session">dontmatch</arg>
                <arg name="/new-sessguards">dontmatch</arg>
            </jsonBody>
        </result>

        <result name="edit_deleted_ru_noguard">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid"></arg>
                <arg name="/doc/authid">1564760242111:I4RsXw:127</arg>
                <arg name="/doc/new-session"></arg>
                <arg name="/doc/new-session/@domain">.yandex.ru</arg>
                <arg name="/doc/new-session/@expires">1</arg>
                <arg name="/doc/new-sessguards/host">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid"></arg>
                <arg name="/authid/id">1564760242111:I4RsXw:127</arg>
                <arg name="/new-session/value"></arg>
                <arg name="/new-session/domain">.yandex.ru</arg>
                <arg name="/new-session/expires">1</arg>
                <arg name="/new-sessguards/0">dontmatch</arg>
            </jsonBody>
        </result>
        <result name="edit_deleted_com_noguard">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid"></arg>
                <arg name="/doc/authid">1564760242111:I4RsXw:127</arg>
                <arg name="/doc/new-session"></arg>
                <arg name="/doc/new-session/@domain">.yandex.com</arg>
                <arg name="/doc/new-session/@expires">1</arg>
                <arg name="/doc/new-sessguards/host">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid"></arg>
                <arg name="/authid/id">1564760242111:I4RsXw:127</arg>
                <arg name="/new-session/value"></arg>
                <arg name="/new-session/domain">.yandex.com</arg>
                <arg name="/new-session/expires">1</arg>
                <arg name="/new-sessguards/0">dontmatch</arg>
            </jsonBody>
        </result>

        <result name="edit_deleted_ru_guard_dryrun">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid"></arg>
                <arg name="/doc/authid">1564760242111:I4RsXw:127</arg>
                <arg name="/doc/new-session"></arg>
                <arg name="/doc/new-session/@domain">.yandex.ru</arg>
                <arg name="/doc/new-session/@expires">1</arg>
                <arg name="count(/doc/new-sessguards/host)">1</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard"></arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard/@expires">1</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid"></arg>
                <arg name="/authid/id">1564760242111:I4RsXw:127</arg>
                <arg name="/new-session/value"></arg>
                <arg name="/new-session/domain">.yandex.ru</arg>
                <arg name="/new-session/expires">1</arg>
                <arg name="/new-sessguards" res_mod="key_count">1</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/value"></arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/expires">1</arg>
            </jsonBody>
        </result>
        <result name="edit_deleted_ru_guard_passtest">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid"></arg>
                <arg name="/doc/authid">1564760242111:I4RsXw:127</arg>
                <arg name="/doc/new-session"></arg>
                <arg name="/doc/new-session/@domain">.yandex.ru</arg>
                <arg name="/doc/new-session/@expires">1</arg>
                <arg name="count(/doc/new-sessguards/host)">1</arg>
                <arg name="/doc/new-sessguards/host[@id='passport-test.yandex.ru']/sessguard"></arg>
                <arg name="/doc/new-sessguards/host[@id='passport-test.yandex.ru']/sessguard/@domain">.passport-test.yandex.ru</arg>
                <arg name="/doc/new-sessguards/host[@id='passport-test.yandex.ru']/sessguard/@expires">1</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid"></arg>
                <arg name="/authid/id">1564760242111:I4RsXw:127</arg>
                <arg name="/new-session/value"></arg>
                <arg name="/new-session/domain">.yandex.ru</arg>
                <arg name="/new-session/expires">1</arg>
                <arg name="/new-sessguards" res_mod="key_count">1</arg>
                <arg name="/new-sessguards/passport-test.yandex.ru/sessguard/value"></arg>
                <arg name="/new-sessguards/passport-test.yandex.ru/sessguard/domain">.passport-test.yandex.ru</arg>
                <arg name="/new-sessguards/passport-test.yandex.ru/sessguard/expires">1</arg>
            </jsonBody>
        </result>
        <result name="edit_deleted_com_guard_dryrun">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid"></arg>
                <arg name="/doc/authid">1564760242111:I4RsXw:127</arg>
                <arg name="/doc/new-session"></arg>
                <arg name="/doc/new-session/@domain">.yandex.com</arg>
                <arg name="/doc/new-session/@expires">1</arg>
                <arg name="count(/doc/new-sessguards/host)">1</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard"></arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.com</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard/@expires">1</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid"></arg>
                <arg name="/authid/id">1564760242111:I4RsXw:127</arg>
                <arg name="/new-session/value"></arg>
                <arg name="/new-session/domain">.yandex.com</arg>
                <arg name="/new-session/expires">1</arg>
                <arg name="/new-sessguards" res_mod="key_count">1</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/value"></arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/domain">.qa-sessguard-test-dryrun.yandex.com</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/expires">1</arg>
            </jsonBody>
        </result>

        <result name="edit_deleted_ru_guard_two">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid"></arg>
                <arg name="/doc/authid">1564760242111:I4RsXw:127</arg>
                <arg name="/doc/new-session"></arg>
                <arg name="/doc/new-session/@domain">.yandex.ru</arg>
                <arg name="/doc/new-session/@expires">1</arg>
                <arg name="count(/doc/new-sessguards/host)">2</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard"></arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard/@expires">1</arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.ru']/sessguard"></arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.ru']/sessguard/@domain">.passportdev.yandex.ru</arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.ru']/sessguard/@expires">1</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid"></arg>
                <arg name="/authid/id">1564760242111:I4RsXw:127</arg>
                <arg name="/new-session/value"></arg>
                <arg name="/new-session/domain">.yandex.ru</arg>
                <arg name="/new-session/expires">1</arg>
                <arg name="/new-sessguards" res_mod="key_count">2</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/value"></arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/expires">1</arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.ru/sessguard/value"></arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.ru/sessguard/domain">.passportdev.yandex.ru</arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.ru/sessguard/expires">1</arg>
            </jsonBody>
        </result>
        <result name="edit_deleted_com_guard_two">
            <body func="matchxpath">
                <arg name="/doc/error">dontmatch</arg>
                <arg name="/doc/default_uid"></arg>
                <arg name="/doc/authid">1564760242111:I4RsXw:127</arg>
                <arg name="/doc/new-session"></arg>
                <arg name="/doc/new-session/@domain">.yandex.com</arg>
                <arg name="/doc/new-session/@expires">1</arg>
                <arg name="count(/doc/new-sessguards/host)">2</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard"></arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.com</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard/@expires">1</arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.com']/sessguard"></arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.com']/sessguard/@domain">.passportdev.yandex.com</arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.com']/sessguard/@expires">1</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">dontmatch</arg>
                <arg name="/default_uid"></arg>
                <arg name="/authid/id">1564760242111:I4RsXw:127</arg>
                <arg name="/new-session/value"></arg>
                <arg name="/new-session/domain">.yandex.com</arg>
                <arg name="/new-session/expires">1</arg>
                <arg name="/new-sessguards" res_mod="key_count">2</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/value"></arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/domain">.qa-sessguard-test-dryrun.yandex.com</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/expires">1</arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.com/sessguard/value"></arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.com/sessguard/domain">.passportdev.yandex.com</arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.com/sessguard/expires">1</arg>
            </jsonBody>
        </result>

        <result name="invalid_domain">
            <body func="matchxpath">
                <arg name="/doc/status[@id='5']">INVALID</arg>
                <arg name="/doc/error" substitute="1">hostname &apos;\~`cgi:host`&apos; doesn't belong to sessionid domain</arg>
                <arg name="/doc/uid">dontmatch</arg>
                <arg name="/doc/new-session">dontmatch</arg>
                <arg name="/doc/new-sessguards">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">INVALID</arg>
                <arg name="/error" substitute="1">hostname &apos;\~`cgi:host`&apos; doesn't belong to sessionid domain</arg>
                <arg name="/uid">dontmatch</arg>
                <arg name="/new-session">dontmatch</arg>
                <arg name="/new-sessguards">dontmatch</arg>
            </jsonBody>
        </result>
        <result name="wrong_guard">
            <body func="matchxpath">
                <arg name="/doc/status[@id='8']">WRONG_GUARD</arg>
                <arg name="/doc/error" comp="starts_with">Sessguard is not valid</arg>
                <arg name="/doc/uid">dontmatch</arg>
                <arg name="/doc/new-session">dontmatch</arg>
                <arg name="/doc/new-sessguards">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">WRONG_GUARD</arg>
                <arg name="/error" comp="starts_with">Sessguard is not valid</arg>
                <arg name="/uid">dontmatch</arg>
                <arg name="/new-session">dontmatch</arg>
                <arg name="/new-sessguards">dontmatch</arg>
            </jsonBody>
        </result>
        <result name="wrong_guard_passport">
            <body func="matchxpath">
                <arg name="/doc/status[@id='5']">INVALID</arg>
                <arg name="/doc/error" comp="starts_with">Sessguard is not valid</arg>
                <arg name="/doc/uid">dontmatch</arg>
                <arg name="/doc/new-session">dontmatch</arg>
                <arg name="/doc/new-sessguards">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">INVALID</arg>
                <arg name="/error" comp="starts_with">Sessguard is not valid</arg>
                <arg name="/uid">dontmatch</arg>
                <arg name="/new-session">dontmatch</arg>
                <arg name="/new-sessguards">dontmatch</arg>
            </jsonBody>
        </result>

        <result name="session_valid">
            <body func="matchxpath">
                <arg name="/doc/status[@id='0']">VALID</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70502</arg>
                <arg name="/doc/new-session">dontmatch</arg>
                <arg name="/doc/new-sessguards">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">VALID</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70502</arg>
                <arg name="/new-session">dontmatch</arg>
                <arg name="/new-sessguards">dontmatch</arg>
            </jsonBody>
        </result>
        <result name="session_force_resign_ru">
            <body func="matchxpath">
                <arg name="/doc/status[@id='0']">VALID</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70502</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="/doc/new-sessguards/host">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">VALID</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70502</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="/new-sessguards/0">dontmatch</arg>
            </jsonBody>
        </result>
        <result name="session_force_resign_com">
            <body func="matchxpath">
                <arg name="/doc/status[@id='0']">VALID</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70502</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="/doc/new-sessguards/host">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">VALID</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70502</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="/new-sessguards/0">dontmatch</arg>
            </jsonBody>
        </result>

        <result name="session_ru_resign_noguard">
            <body func="matchxpath">
                <arg name="/doc/status[@id='1']">NEED_RESET</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70502</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="/doc/new-sessguards/host">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">NEED_RESET</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70502</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="/new-sessguards/0">dontmatch</arg>
            </jsonBody>
        </result>
        <result name="session_com_resign_noguard">
            <body func="matchxpath">
                <arg name="/doc/status[@id='1']">NEED_RESET</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70502</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="/doc/new-sessguards/host">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">NEED_RESET</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70502</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="/new-sessguards/0">dontmatch</arg>
            </jsonBody>
        </result>

        <result name="session_ru_resign_guard_dryrun">
            <body func="matchxpath">
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70502</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="count(/doc/new-sessguards/host)">1</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70502</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="/new-sessguards" res_mod="key_count">1</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
            </jsonBody>
        </result>
        <result name="session_ru_resign_guard_passtest">
            <body func="matchxpath">
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70502</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="count(/doc/new-sessguards/host)">1</arg>
                <arg name="/doc/new-sessguards/host[@id='passport-test.yandex.ru']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passport-test.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='passport-test.yandex.ru']/sessguard/@domain">.passport-test.yandex.ru</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70502</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="/new-sessguards" res_mod="key_count">1</arg>
                <arg name="/new-sessguards/passport-test.yandex.ru/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passport-test.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/new-sessguards/passport-test.yandex.ru/sessguard/domain">.passport-test.yandex.ru</arg>
            </jsonBody>
        </result>
        <result name="session_ru_valid_guard_passtest">
            <body func="matchxpath">
                <arg name="/doc/status[@id='0']">VALID</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70502</arg>
                <arg name="/doc/new-session">dontmatch</arg>
                <arg name="count(/doc/new-sessguards/host)">1</arg>
                <arg name="/doc/new-sessguards/host[@id='passport-test.yandex.ru']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passport-test.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='passport-test.yandex.ru']/sessguard/@domain">.passport-test.yandex.ru</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">VALID</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70502</arg>
                <arg name="/new-session/">dontmatch</arg>
                <arg name="/new-sessguards" res_mod="key_count">1</arg>
                <arg name="/new-sessguards/passport-test.yandex.ru/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passport-test.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/new-sessguards/passport-test.yandex.ru/sessguard/domain">.passport-test.yandex.ru</arg>
            </jsonBody>
        </result>
        <result name="session_com_resign_guard_dryrun">
            <body func="matchxpath">
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70502</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="count(/doc/new-sessguards/host)">1</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.com</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_com</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.com</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70502</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="/new-sessguards" res_mod="key_count">1</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.com</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_com</arg>
                </arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/domain">.qa-sessguard-test-dryrun.yandex.com</arg>
            </jsonBody>
        </result>

        <result name="session_ru_resign_guard_two">
            <body func="matchxpath">
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70502</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="count(/doc/new-sessguards/host)">2</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.ru']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passportdev.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.ru']/sessguard/@domain">.passportdev.yandex.ru</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70502</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.ru</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="/new-sessguards" res_mod="key_count">2</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.ru/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passportdev.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.ru/sessguard/domain">.passportdev.yandex.ru</arg>
            </jsonBody>
        </result>
        <result name="session_ru_valid_guard_two">
            <body func="matchxpath">
                <arg name="/doc/status[@id='0']">VALID</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70502</arg>
                <arg name="/doc/new-session">dontmatch</arg>
                <arg name="count(/doc/new-sessguards/host)">2</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.ru']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.ru']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passportdev.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.ru']/sessguard/@domain">.passportdev.yandex.ru</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">VALID</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70502</arg>
                <arg name="/new-session">dontmatch</arg>
                <arg name="/new-sessguards" res_mod="key_count">2</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.ru/sessguard/domain">.qa-sessguard-test-dryrun.yandex.ru</arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.ru/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passportdev.yandex.ru</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_ru</arg>
                </arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.ru/sessguard/domain">.passportdev.yandex.ru</arg>
            </jsonBody>
        </result>
        <result name="session_com_resign_guard_two">
            <body func="matchxpath">
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70502</arg>
                <arg name="/doc/new-session" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="count(/doc/new-sessguards/host)">2</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.com</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_com</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.com</arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.com']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passportdev.yandex.com</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_com</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.com']/sessguard/@domain">.passportdev.yandex.com</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70502</arg>
                <arg name="/new-session/value" func="checksessid">
                    <arg name="version">3</arg>
                    <arg name="uid">70502</arg>
                    <arg name="host">yandex.com</arg>
                    <arg name="type">valid</arg>
                    <arg name="flag">session</arg>
                    <arg name="safe">1</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                </arg>
                <arg name="/new-sessguards" res_mod="key_count">2</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.com</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_com</arg>
                </arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/domain">.qa-sessguard-test-dryrun.yandex.com</arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.com/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passportdev.yandex.com</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_com</arg>
                </arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.com/sessguard/domain">.passportdev.yandex.com</arg>
            </jsonBody>
        </result>
        <result name="session_com_valid_guard_two">
            <body func="matchxpath">
                <arg name="/doc/status[@id='0']">VALID</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70502</arg>
                <arg name="/doc/new-session">dontmatch</arg>
                <arg name="count(/doc/new-sessguards/host)">2</arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.com</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_com</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='qa-sessguard-test-dryrun.yandex.com']/sessguard/@domain">.qa-sessguard-test-dryrun.yandex.com</arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.com']/sessguard" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passportdev.yandex.com</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_com</arg>
                </arg>
                <arg name="/doc/new-sessguards/host[@id='www1.passportdev.yandex.com']/sessguard/@domain">.passportdev.yandex.com</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">VALID</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70502</arg>
                <arg name="/new-session">dontmatch</arg>
                <arg name="/new-sessguards" res_mod="key_count">2</arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">qa-sessguard-test-dryrun.yandex.com</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_test_dryrun</arg>
                    <arg name="keyspace">yandex_com</arg>
                </arg>
                <arg name="/new-sessguards/qa-sessguard-test-dryrun.yandex.com/sessguard/domain">.qa-sessguard-test-dryrun.yandex.com</arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.com/sessguard/value" func="checksessguard">
                    <arg name="status">valid</arg>
                    <arg name="host">passportdev.yandex.com</arg>
                    <arg name="authid">1564760242111:I4RsXw:127</arg>
                    <arg name="guardspace">guard_passport</arg>
                    <arg name="keyspace">yandex_com</arg>
                </arg>
                <arg name="/new-sessguards/www1.passportdev.yandex.com/sessguard/domain">.passportdev.yandex.com</arg>
            </jsonBody>
        </result>

    </variables>

    <node>
        <description>Blackbox sessguard tests</description>
        <url>http://passdev2.yandex.ru</url>

        <case lastid="createsession_uid">
            <description>Create session by uid</description>
            <path>blackbox</path>
            <cgi name="method">createsession</cgi>
            <cgi name="uid">junit-test</cgi>
            <cgi name="keyspace">*</cgi>
            <cgi name="userip">*</cgi>
            <cgi name="auth_time">*</cgi>
            <cgi name="host_id">*</cgi>
            <cgi name="guard_hosts" withnull="1">*</cgi>
            <cgi name="format">*</cgi>

            <check>
                <cgi name="keyspace">ru</cgi>
                <cgi name="guard_hosts">dryrun_ru; twocom+ru+bad</cgi>
                <result>create_ru_guard_dryrun</result>
            </check>

            <check>
                <cgi name="keyspace">ru</cgi>
                <cgi name="guard_hosts">ru+com+bad</cgi>
                <result>create_ru_guard_passtest</result>
            </check>

            <check>
                <cgi name="keyspace">com</cgi>
                <cgi name="guard_hosts">dryrun_com; ru+com+bad; tworu+com+bad</cgi>
                <result>create_com_guard_dryrun</result>
            </check>

            <check>
                <cgi name="keyspace">ru</cgi>
                <cgi name="guard_hosts">tworu+com+bad</cgi>
                <result>create_ru_guard_two</result>
            </check>

            <check>
                <cgi name="keyspace">com</cgi>
                <cgi name="guard_hosts">twocom+ru+bad</cgi>
                <result>create_com_guard_two</result>
            </check>

            <check>
                <cgi name="keyspace">ru</cgi>
                <result>create_ru_noguard</result>
            </check>

            <check>
                <cgi name="keyspace">com</cgi>
                <result>create_com_noguard</result>
            </check>

        </case>

        <case lastid="editsession">
            <description>Edit session with various params</description>
            <path>blackbox</path>
            <cgi name="method">editsession</cgi>
            <cgi name="sessionid">ru_valid; ru_need_reset; com_valid; com_need_reset</cgi>
            <cgi name="op">*</cgi>
            <cgi name="uid">staff_user</cgi>
            <cgi name="host">*</cgi>
            <cgi name="userip">*</cgi>
            <cgi name="create_time">*</cgi>
            <cgi name="sessguard" withnull="1">*</cgi>
            <cgi name="guard_hosts" withnull="1">*</cgi>
            <cgi name="format">*</cgi>

            <check>
                <cgi name="sessionid">ru_valid; ru_need_reset</cgi>
                <cgi name="host">com_passp; com_dryrun; com_noguard</cgi>
                <result>create_by_bad_session</result>
            </check>
            <check>
                <cgi name="sessionid">com_valid; com_need_reset</cgi>
                <cgi name="host">ru_passp; ru_dryrun; ru_noguard</cgi>
                <result>create_by_bad_session</result>
            </check>

            <check>
                <cgi name="host">ru_passp</cgi>
                <cgi name="sessguard" withnull="1">
                    passport_ru_bad_authid; dryrun_ru_bad_authid; dryrun_ru;
                    passport_com; dryrun_com;
                    passport_ua; dryrun_ua
                </cgi>
                <result>edit_with_bad_sessguard</result>
            </check>
            <check>
                <cgi name="host">com_passp</cgi>
                <cgi name="sessguard" withnull="1">
                    passport_ru_bad_authid; dryrun_ru_bad_authid; dryrun_com;
                    passport_ru; dryrun_ru;
                    passport_ua; dryrun_ua
                </cgi>
                <result>edit_with_bad_sessguard</result>
            </check>

            <!-- op=delete -->

            <check>
                <cgi name="host">ru_noguard</cgi>
                <cgi name="op">delete</cgi>
                <cgi name="sessguard" withnull="1">*</cgi>
                <result>edit_deleted_ru_noguard</result>
            </check>
            <check>
                <cgi name="host">com_noguard</cgi>
                <cgi name="op">delete</cgi>
                <cgi name="sessguard" withnull="1">*</cgi>
                <result>edit_deleted_com_noguard</result>
            </check>

            <check>
                <cgi name="host">ru_dryrun</cgi>
                <cgi name="op">delete</cgi>
                <cgi name="sessguard">
                    passport_ru_bad_authid; dryrun_ru_bad_authid; passport_ru;
                    passport_com; dryrun_com;
                    passport_ua; dryrun_ua
                </cgi>
                <result>edit_deleted_ru_noguard</result>
            </check>
            <check>
                <cgi name="host">com_dryrun</cgi>
                <cgi name="op">delete</cgi>
                <cgi name="sessguard">
                    passport_ru_bad_authid; dryrun_ru_bad_authid; passport_com;
                    passport_ru; dryrun_ru;
                    passport_ua; dryrun_ua
                </cgi>
                <result>edit_deleted_com_noguard</result>
            </check>

            <check>
                <cgi name="host">ru_passp; ru_dryrun; ru_noguard</cgi>
                <cgi name="op">delete</cgi>
                <cgi name="guard_hosts">dryrun_ru; twocom+ru+bad</cgi>
                <result>edit_deleted_ru_guard_dryrun</result>
            </check>
            <check>
                <cgi name="host">ru_passp; ru_dryrun; ru_noguard</cgi>
                <cgi name="op">delete</cgi>
                <cgi name="guard_hosts">ru+com+bad</cgi>
                <result>edit_deleted_ru_guard_passtest</result>
            </check>

            <check>
                <cgi name="host">com_passp; com_dryrun; com_noguard</cgi>
                <cgi name="op">delete</cgi>
                <cgi name="guard_hosts">dryrun_com; ru+com+bad; tworu+com+bad</cgi>
                <result>edit_deleted_com_guard_dryrun</result>
            </check>

            <check>
                <cgi name="host">ru_passp; ru_dryrun; ru_noguard</cgi>
                <cgi name="op">delete</cgi>
                <cgi name="guard_hosts">tworu+com+bad</cgi>
                <result>edit_deleted_ru_guard_two</result>
            </check>
            <check>
                <cgi name="host">com_passp; com_dryrun; com_noguard</cgi>
                <cgi name="op">delete</cgi>
                <cgi name="guard_hosts">twocom+ru+bad</cgi>
                <result>edit_deleted_com_guard_two</result>
            </check>

            <check>
                <cgi name="host">ru_passp; ru_dryrun; ru_noguard</cgi>
                <cgi name="op">delete</cgi>
                <result>edit_deleted_ru_noguard</result>
            </check>

            <check>
                <cgi name="host">com_passp; com_dryrun; com_noguard</cgi>
                <cgi name="op">delete</cgi>
                <result>edit_deleted_com_noguard</result>
            </check>

            <!-- op=select -->

            <check>
                <cgi name="host">ru_noguard</cgi>
                <cgi name="op">select</cgi>
                <cgi name="sessguard" withnull="1">*</cgi>
                <result>transform_ru_noguard</result>
            </check>
            <check>
                <cgi name="host">com_noguard</cgi>
                <cgi name="op">select</cgi>
                <cgi name="sessguard" withnull="1">*</cgi>
                <result>transform_com_noguard</result>
            </check>

            <check>
                <cgi name="host">ru_dryrun</cgi>
                <cgi name="op">select</cgi>
                <cgi name="sessguard">
                    passport_ru_bad_authid; dryrun_ru_bad_authid; passport_ru;
                    passport_com; dryrun_com;
                    passport_ua; dryrun_ua
                </cgi>
                <result>transform_ru_noguard</result>
            </check>
            <check>
                <cgi name="host">com_dryrun</cgi>
                <cgi name="op">select</cgi>
                <cgi name="sessguard">
                    passport_ru_bad_authid; dryrun_ru_bad_authid; passport_com;
                    passport_ru; dryrun_ru;
                    passport_ua; dryrun_ua
                </cgi>
                <result>transform_com_noguard</result>
            </check>

            <check>
                <cgi name="host">ru_passp; ru_dryrun; ru_noguard</cgi>
                <cgi name="op">select</cgi>
                <cgi name="guard_hosts">dryrun_ru; twocom+ru+bad</cgi>
                <result>transform_ru_guard_dryrun</result>
            </check>

            <check>
                <cgi name="host">ru_passp; ru_dryrun; ru_noguard</cgi>
                <cgi name="op">select</cgi>
                <cgi name="guard_hosts">ru+com+bad</cgi>
                <result>transform_ru_guard_passtest</result>
            </check>

            <check>
                <cgi name="host">com_passp; com_dryrun; com_noguard</cgi>
                <cgi name="op">select</cgi>
                <cgi name="guard_hosts">dryrun_com; ru+com+bad; tworu+com+bad</cgi>
                <result>transform_com_guard_dryrun</result>
            </check>

            <check>
                <cgi name="host">ru_passp; ru_dryrun; ru_noguard</cgi>
                <cgi name="op">select</cgi>
                <cgi name="guard_hosts">tworu+com+bad</cgi>
                <result>transform_ru_guard_two</result>
            </check>

            <check>
                <cgi name="host">com_passp; com_dryrun; com_noguard</cgi>
                <cgi name="op">select</cgi>
                <cgi name="guard_hosts">twocom+ru+bad</cgi>
                <result>transform_com_guard_two</result>
            </check>

            <check>
                <cgi name="host">ru_passp; ru_dryrun; ru_noguard</cgi>
                <cgi name="op">select</cgi>
                <result>transform_ru_noguard</result>
            </check>

            <check>
                <cgi name="host">com_passp; com_dryrun; com_noguard</cgi>
                <cgi name="op">select</cgi>
                <result>transform_com_noguard</result>
            </check>
        </case>

        <case lastid="sessionid">
            <description>Check session with sessguard</description>
            <path>blackbox</path>
            <cgi name="method">sessionid</cgi>
            <cgi name="sessionid">ru_valid; ru_need_reset; com_valid; com_need_reset</cgi>
            <cgi name="host">*</cgi>
            <cgi name="userip">*</cgi>
            <cgi name="resign">*</cgi>
            <cgi name="force_resign" withnull="1">*</cgi>
            <cgi name="sessguard" withnull="1">*</cgi>
            <cgi name="guard_hosts" withnull="1">*</cgi>
            <cgi name="format">*</cgi>

            <check>
                <cgi name="sessionid">ru_valid; ru_need_reset</cgi>
                <cgi name="host">com_passp; com_dryrun; com_noguard</cgi>
                <result>invalid_domain</result>
            </check>
            <check>
                <cgi name="sessionid">com_valid; com_need_reset</cgi>
                <cgi name="host">ru_passp; ru_dryrun; ru_noguard</cgi>
                <result>invalid_domain</result>
            </check>

            <!-- bad sessguard variants -->

            <check>
                <cgi name="host">ru_noguard</cgi>
                <cgi name="sessionid">ru_need_reset</cgi>
                <cgi name="sessguard" withnull="1">*</cgi>
                <result>session_ru_resign_noguard</result>
            </check>
            <check>
                <cgi name="host">com_noguard</cgi>
                <cgi name="sessionid">com_need_reset</cgi>
                <cgi name="sessguard" withnull="1">*</cgi>
                <result>session_com_resign_noguard</result>
            </check>

            <check>
                <cgi name="host">ru_dryrun</cgi>
                <cgi name="sessionid">ru_need_reset</cgi>
                <cgi name="sessguard">
                    passport_ru_bad_authid; dryrun_ru_bad_authid; passport_ru;
                    passport_com; dryrun_com;
                    passport_ua; dryrun_ua
                </cgi>
                <result>session_ru_resign_noguard</result>
            </check>
            <check>
                <cgi name="host">com_dryrun</cgi>
                <cgi name="sessionid">com_need_reset</cgi>
                <cgi name="sessguard">
                    passport_ru_bad_authid; dryrun_ru_bad_authid; passport_com;
                    passport_ru; dryrun_ru;
                    passport_ua; dryrun_ua
                </cgi>
                <result>session_com_resign_noguard</result>
            </check>

            <check>
                <cgi name="host">ru_passp</cgi>
                <cgi name="sessguard" withnull="1">
                    passport_ru_bad_authid; dryrun_ru_bad_authid; dryrun_ru;
                    passport_com; dryrun_com;
                    passport_ua; dryrun_ua
                </cgi>
                <result>wrong_guard_passport</result>
            </check>
            <check>
                <cgi name="host">com_passp</cgi>
                <cgi name="sessguard" withnull="1">
                    passport_ru_bad_authid; dryrun_ru_bad_authid; dryrun_com;
                    passport_ru; dryrun_ru;
                    passport_ua; dryrun_ua
                </cgi>
                <result>wrong_guard_passport</result>
            </check>

            <!-- results with new sessguards -->

            <!-- caused by need_reset session -->
            <check>
                <cgi name="host">ru_passp; ru_dryrun; ru_noguard</cgi>
                <cgi name="sessionid">ru_need_reset</cgi>
                <cgi name="guard_hosts">dryrun_ru; twocom+ru+bad</cgi>
                <result>session_ru_resign_guard_dryrun</result>
            </check>
            <check>
                <cgi name="host">ru_passp; ru_dryrun; ru_noguard</cgi>
                <cgi name="sessionid">ru_need_reset</cgi>
                <cgi name="guard_hosts">ru+com+bad</cgi>
                <result>session_ru_resign_guard_passtest</result>
            </check>
            <check>
                <cgi name="host">com_passp; com_dryrun; com_noguard</cgi>
                <cgi name="sessionid">com_need_reset</cgi>
                <cgi name="guard_hosts">dryrun_com; ru+com+bad; tworu+com+bad</cgi>
                <result>session_com_resign_guard_dryrun</result>
            </check>
            <check>
                <cgi name="host">ru_passp; ru_dryrun; ru_noguard</cgi>
                <cgi name="sessionid">ru_need_reset</cgi>
                <cgi name="guard_hosts">tworu+com+bad</cgi>
                <result>session_ru_resign_guard_two</result>
            </check>
            <check>
                <cgi name="host">com_passp; com_dryrun; com_noguard</cgi>
                <cgi name="sessionid">com_need_reset</cgi>
                <cgi name="guard_hosts">twocom+ru+bad</cgi>
                <result>session_com_resign_guard_two</result>
            </check>

            <!-- caused by need_reset sessguard -->
            <check>
                <cgi name="host">ru_passp</cgi>
                <cgi name="sessguard">passport_ru</cgi>
                <cgi name="guard_hosts">dryrun_ru; twocom+ru+bad</cgi>
                <result>session_ru_resign_guard_dryrun</result>
            </check>
            <check>
                <cgi name="host">ru_passp</cgi>
                <cgi name="sessguard">passport_ru</cgi>
                <cgi name="guard_hosts">ru+com+bad</cgi>
                <result>session_ru_resign_guard_passtest</result>
            </check>
            <check>
                <cgi name="host">com_passp</cgi>
                <cgi name="sessguard">passport_com</cgi>
                <cgi name="guard_hosts">dryrun_com; ru+com+bad; tworu+com+bad</cgi>
                <result>session_com_resign_guard_dryrun</result>
            </check>
            <check>
                <cgi name="host">ru_passp</cgi>
                <cgi name="sessguard">passport_ru</cgi>
                <cgi name="guard_hosts">tworu+com+bad</cgi>
                <result>session_ru_resign_guard_two</result>
            </check>
            <check>
                <cgi name="host">com_passp</cgi>
                <cgi name="sessguard">passport_com</cgi>
                <cgi name="guard_hosts">twocom+ru+bad</cgi>
                <result>session_com_resign_guard_two</result>
            </check>

            <!-- caused by force_resign -->
            <check>
                <cgi name="host">ru_dryrun</cgi>
                <cgi name="sessguard" withnull="1">dryrun_ru</cgi>
                <cgi name="guard_hosts">ru+com+bad</cgi>
                <cgi name="force_resign">yes</cgi>
                <result>session_ru_resign_guard_passtest</result>
            </check>
            <check>
                <cgi name="host">ru_dryrun</cgi>
                <cgi name="sessguard" withnull="1">dryrun_ru</cgi>
                <cgi name="guard_hosts">dryrun_ru; twocom+ru+bad</cgi>
                <cgi name="force_resign">yes</cgi>
                <result>session_ru_resign_guard_dryrun</result>
            </check>
            <check>
                <cgi name="host">ru_dryrun</cgi>
                <cgi name="sessguard" withnull="1">dryrun_ru</cgi>
                <cgi name="guard_hosts">tworu+com+bad</cgi>
                <cgi name="force_resign">yes</cgi>
                <result>session_ru_resign_guard_two</result>
            </check>
            <check>
                <cgi name="host">com_dryrun</cgi>
                <cgi name="sessguard" withnull="1">dryrun_com</cgi>
                <cgi name="guard_hosts">dryrun_com; ru+com+bad; tworu+com+bad</cgi>
                <cgi name="force_resign">yes</cgi>
                <result>session_com_resign_guard_dryrun</result>
            </check>
            <check>
                <cgi name="host">com_dryrun</cgi>
                <cgi name="sessguard" withnull="1">dryrun_com</cgi>
                <cgi name="guard_hosts">twocom+ru+bad</cgi>
                <cgi name="force_resign">yes</cgi>
                <result>session_com_resign_guard_two</result>
            </check>

            <!-- caused by another guard_space in request -->
            <check>
                <cgi name="host">ru_dryrun</cgi>
                <cgi name="sessguard" withnull="1">dryrun_ru</cgi>
                <cgi name="guard_hosts">ru+com+bad</cgi>
                <result>session_ru_valid_guard_passtest</result>
            </check>
            <check>
                <cgi name="host">ru_dryrun</cgi>
                <cgi name="sessguard" withnull="1">dryrun_ru</cgi>
                <cgi name="guard_hosts">tworu+com+bad</cgi>
                <result>session_ru_valid_guard_two</result>
            </check>
            <check>
                <cgi name="host">com_dryrun</cgi>
                <cgi name="sessguard" withnull="1">dryrun_com</cgi>
                <cgi name="guard_hosts">twocom+ru+bad</cgi>
                <result>session_com_valid_guard_two</result>
            </check>

            <!-- no guard_hosts -->

            <check>
                <cgi name="host">ru_passp; ru_dryrun; ru_noguard</cgi>
                <cgi name="sessionid">ru_need_reset</cgi>
                <result>session_ru_resign_noguard</result>
            </check>
            <check>
                <cgi name="host">com_passp; com_dryrun; com_noguard</cgi>
                <cgi name="sessionid">com_need_reset</cgi>
                <result>session_com_resign_noguard</result>
            </check>

            <check>
                <cgi name="host">ru_passp</cgi>
                <cgi name="sessguard">passport_ru</cgi>
                <result>session_ru_resign_noguard</result>
            </check>
            <check>
                <cgi name="host">com_passp</cgi>
                <cgi name="sessguard">passport_com</cgi>
                <result>session_com_resign_noguard</result>
            </check>

            <!-- no need_reset cookie or sessguard -->

            <check>
                <cgi name="host">ru_passp; ru_dryrun; ru_noguard</cgi>
                <cgi name="force_resign">yes</cgi>
                <result>session_force_resign_ru</result>
            </check>
            <check>
                <cgi name="host">com_passp; com_dryrun; com_noguard</cgi>
                <cgi name="force_resign">yes</cgi>
                <result>session_force_resign_com</result>
            </check>
            <check>
                <cgi name="host">*</cgi>
                <result>session_valid</result>
            </check>

        </case>

    </node>

</test>
