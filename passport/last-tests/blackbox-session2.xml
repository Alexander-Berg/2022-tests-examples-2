<test>
    <variables>

        <path>
            <instance id="blackbox">blackbox</instance>
        </path>

        <cgi name="format">
            <instance id="xml">xml</instance>
            <instance id="json">json</instance>
        </cgi>

        <cgi name="method">
            <instance id="sessionid">sessionid</instance>
        </cgi>

        <cgi name="userip">
            <instance id="localhost">127.0.0.1</instance>
            <instance id="internal">95.108.148.135</instance>
            <instance id="internal_user">95.108.132.35</instance>
            <instance id="external">8.8.8.8</instance>
            <instance id="junk">127.0.0.1.1</instance>
        </cgi>

        <cgi name="ip">
            <instance id="internal">95.108.148.135</instance>
            <instance id="internal_user">95.108.132.35</instance>
            <instance id="external">8.8.8.8</instance>
        </cgi>

        <cgi name="host">
            <instance id="ru">yandex.ru</instance>
            <instance id="com">yandex.com</instance>
            <instance id="comtr">yandex.com.tr</instance>
            <instance id="by">yandex.by</instance>
        </cgi>

        <cgi name="uid">
            <instance id="junit-test">70500</instance>
            <instance id="dot.user">70501</instance>
        </cgi>

        <cgi name="resign">
            <instance id="resign_yes">1</instance>
            <instance id="resign_no">a</instance>
            <instance id="resign"></instance>
        </cgi>

        <cgi name="force_resign">
            <instance id="resign_yes">YES</instance>
            <instance id="resign_no">0</instance>
            <instance id="resign"></instance>
        </cgi>

        <cgi name="resign_for_domains">
            <instance id="mail_yandex_ru_and_test_edadeal_ru">test.edadeal.ru,,aqua.mail.yandex.ru</instance>
            <instance id="test_edadeal_ru">test.edadeal.ru</instance>
            <instance id="invalid">test.edadeal.ru,,yandex.kokoko.ru</instance>
        </cgi>

        <cgi name="sessionid" func="gensessid">
            <arg name="uid">70500</arg>

            <instance id="ru_valid">
                <arg name="host">beta.yandex.ru</arg>
                <arg name="type">validquoted</arg>
                <arg name="time">-10</arg>
            </instance>
            <instance id="ru_need_reset">
                <arg name="host">beta.yandex.ru</arg>
                <arg name="type">need_reset</arg>
            </instance>
            <instance id="ru_expired">
                <arg name="host">beta.yandex.ru</arg>
                <arg name="type">expired</arg>
            </instance>

            <instance id="ru_restricted_int_user">
                <arg name="host">beta.yandex.ru</arg>
                <arg name="type">valid</arg>
                <arg name="time">-10</arg>
                <arg name="flag">restricted</arg>
                <arg name="authdelta">-1000</arg>
                <arg name="authip">95.108.132.35</arg>
                <arg name="authid">127</arg>
            </instance>
            <instance id="ru_int">
                <arg name="host">beta.yandex.ru</arg>
                <arg name="type">valid</arg>
                <arg name="time">-10</arg>
                <arg name="authdelta">-1000000</arg>
                <arg name="authip">95.108.148.135</arg>
                <arg name="authid">127</arg>
            </instance>
            <instance id="ru_int2">
                <arg name="host">beta.yandex.ru</arg>
                <arg name="type">valid</arg>
                <arg name="time">-10</arg>
                <arg name="authdelta">-1000000</arg>
                <arg name="authip">95.108.132.35</arg>
                <arg name="authid">127</arg>
            </instance>
            <instance id="ru_ext">
                <arg name="host">beta.yandex.ru</arg>
                <arg name="type">valid</arg>
                <arg name="time">-10</arg>
                <arg name="flag">restricted</arg>
                <arg name="authdelta">-1000</arg>
                <arg name="authip">8.8.8.8</arg>
                <arg name="authid">55</arg>
                <arg name="havepwd">1</arg>
            </instance>
            <instance id="ru_need_reset_restricted_ext">
                <arg name="host">beta.yandex.ru</arg>
                <arg name="type">need_reset</arg>
                <arg name="time">-7210</arg>
                <arg name="flag">restricted</arg>
                <arg name="authdelta">-1000</arg>
                <arg name="authip">8.8.8.8</arg>
                <arg name="authid">55</arg>
            </instance>

            <instance id="com_valid">
                <arg name="host">beta.yandex.com</arg>
                <arg name="type">valid</arg>
                <arg name="time">-10</arg>
            </instance>
            <instance id="com_need_reset">
                <arg name="host">beta.yandex.com</arg>
                <arg name="type">need_reset</arg>
            </instance>
            <instance id="com_expired">
                <arg name="host">beta.yandex.com</arg>
                <arg name="type">expired</arg>
            </instance>

            <instance id="com_restricted_int_user">
                <arg name="host">beta.yandex.com</arg>
                <arg name="type">valid</arg>
                <arg name="time">-10</arg>
                <arg name="flag">restricted</arg>
                <arg name="authdelta">-1000</arg>
                <arg name="authip">95.108.132.35</arg>
                <arg name="authid">127</arg>
            </instance>
            <instance id="com_int">
                <arg name="host">beta.yandex.com</arg>
                <arg name="type">validquoted</arg>
                <arg name="time">-10</arg>
                <arg name="authdelta">-1000000</arg>
                <arg name="authip">95.108.148.135</arg>
                <arg name="authid">127</arg>
            </instance>
            <instance id="com_int2">
                <arg name="host">beta.yandex.com</arg>
                <arg name="type">valid</arg>
                <arg name="time">-10</arg>
                <arg name="authdelta">-1000000</arg>
                <arg name="authip">95.108.132.35</arg>
                <arg name="authid">127</arg>
            </instance>
            <instance id="com_ext">
                <arg name="host">beta.yandex.com</arg>
                <arg name="type">valid</arg>
                <arg name="time">-10</arg>
                <arg name="flag">restricted</arg>
                <arg name="authdelta">-1000</arg>
                <arg name="authip">8.8.8.8</arg>
                <arg name="authid">55</arg>
            </instance>
            <instance id="com_need_reset_restricted_ext">
                <arg name="host">beta.yandex.com</arg>
                <arg name="type">need_reset</arg>
                <arg name="time">-7210</arg>
                <arg name="flag">restricted</arg>
                <arg name="authdelta">-1000</arg>
                <arg name="authip">8.8.8.8</arg>
                <arg name="authid">55</arg>
            </instance>


            <instance id="comtr_valid">
                <arg name="host">beta.yandex.com.tr</arg>
                <arg name="type">valid</arg>
                <arg name="time">-10</arg>
            </instance>
            <instance id="comtr_need_reset">
                <arg name="host">beta.yandex.com.tr</arg>
                <arg name="type">need_reset</arg>
            </instance>
            <instance id="comtr_expired">
                <arg name="host">beta.yandex.com.tr</arg>
                <arg name="type">expired</arg>
            </instance>

            <instance id="comtr_restricted_int_user">
                <arg name="host">beta.yandex.com.tr</arg>
                <arg name="type">valid</arg>
                <arg name="time">-10</arg>
                <arg name="flag">restricted</arg>
                <arg name="authdelta">-1000</arg>
                <arg name="authip">95.108.132.35</arg>
                <arg name="authid">127</arg>
            </instance>
            <instance id="comtr_int">
                <arg name="host">beta.yandex.com.tr</arg>
                <arg name="type">valid</arg>
                <arg name="time">-10</arg>
                <arg name="authdelta">-1000000</arg>
                <arg name="authip">95.108.148.135</arg>
                <arg name="authid">127</arg>
                <arg name="havepwd">1</arg>
            </instance>
            <instance id="comtr_int2">
                <arg name="host">beta.yandex.com.tr</arg>
                <arg name="type">validquoted</arg>
                <arg name="time">-10</arg>
                <arg name="authdelta">-1000000</arg>
                <arg name="authip">95.108.132.35</arg>
                <arg name="authid">127</arg>
                <arg name="havepwd">1</arg>
            </instance>
            <instance id="comtr_ext">
                <arg name="host">beta.yandex.com.tr</arg>
                <arg name="type">valid</arg>
                <arg name="time">-10</arg>
                <arg name="flag">restricted</arg>
                <arg name="authdelta">-1000</arg>
                <arg name="authip">8.8.8.8</arg>
                <arg name="authid">55</arg>
            </instance>
            <instance id="comtr_need_reset_restricted_ext">
                <arg name="host">beta.yandex.com.tr</arg>
                <arg name="type">need_reset</arg>
                <arg name="time">-7210</arg>
                <arg name="flag">restricted</arg>
                <arg name="authdelta">-1000</arg>
                <arg name="authip">8.8.8.8</arg>
                <arg name="authid">55</arg>
            </instance>

            <instance id="ua_valid">
                <arg name="host">beta.yandex.by</arg>
                <arg name="type">valid</arg>
                <arg name="time">-10</arg>
            </instance>
            <instance id="ua_need_reset">
                <arg name="host">beta.yandex.by</arg>
                <arg name="type">need_reset</arg>
            </instance>
            <instance id="ua_expired">
                <arg name="host">beta.yandex.by</arg>
                <arg name="type">expired</arg>
            </instance>

        </cgi>

       <result name="id_valid_secure">
            <body func="matchxpath">
                <arg name="/doc/status">VALID</arg>
                <arg name="/doc/status/@id">0</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70500</arg>
                <arg name="count(/doc/age[text() &gt; 8 and text() &lt; 12])">1</arg>
                <arg name="/doc/dbfield">dontmatch</arg>
                <arg name="/doc/special">dontmatch</arg>
                <arg name="/doc/new-session">dontmatch</arg>
                <arg name="/doc/new-sslsession">dontmatch</arg>
                <arg name="/doc/auth/secure">1</arg>
                <arg name="/doc/have_password">1</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">VALID</arg>
                <arg name="/status/id">0</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70500</arg>
                <arg name="/age" comp="relation" min="8" max="12"></arg>
                <arg name="/dbfields">dontmatch</arg>
                <arg name="/new-session">dontmatch</arg>
                <arg name="/new-sslsession">dontmatch</arg>
                <arg name="/auth/secure">true</arg>
                <arg name="/auth/have_password">true</arg>
            </jsonBody>
        </result>

        <result name="id_need_reset_secure">
            <body func="matchxpath">
                <arg name="/doc/status">NEED_RESET</arg>
                <arg name="/doc/status/@id">1</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70500</arg>
                <arg name="/doc/dbfield">dontmatch</arg>
                <arg name="/doc/special">dontmatch</arg>
                <arg name="/doc/new-session">dontmatch</arg>
                <arg name="/doc/new-sslsession">dontmatch</arg>
                <arg name="/doc/auth/secure">1</arg>
                <arg name="/doc/have_password">1</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">NEED_RESET</arg>
                <arg name="/status/id">1</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70500</arg>
                <arg name="/dbfields">dontmatch</arg>
                <arg name="/new-session">dontmatch</arg>
                <arg name="/new-sslsession">dontmatch</arg>
                <arg name="/auth/secure">true</arg>
                <arg name="/auth/have_password">true</arg>
            </jsonBody>
        </result>

        <result name="id_need_reset_secure_resign_ru">
            <body func="matchxpath">
                <arg name="/doc/status">NEED_RESET</arg>
                <arg name="/doc/status/@id">1</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70500</arg>
                <arg name="/doc/dbfield">dontmatch</arg>
                <arg name="/doc/special">dontmatch</arg>
                <arg name="/doc/auth/secure">1</arg>
                <arg name="count(/doc/new-session)">1</arg>
                <arg name="/doc/new-session/@domain">.yandex.ru</arg>
                <arg name="/doc/new-session/@http-only">1</arg>
                <arg name="/doc/new-session/@secure">1</arg>
                <arg name="contains(/doc/new-session, '.1.2:2|70500.-1.')">1</arg>
                <arg name="count(/doc/new-sslsession)">1</arg>
                <arg name="/doc/new-sslsession/@domain">.yandex.ru</arg>
                <arg name="/doc/new-sslsession/@http-only">1</arg>
                <arg name="/doc/new-sslsession/@secure">1</arg>
                <arg name="contains(/doc/new-sslsession, '.1.2:2.499:1|70500.-1.')">1</arg>
                <arg name="/doc/have_password">1</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">NEED_RESET</arg>
                <arg name="/status/id">1</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70500</arg>
                <arg name="/dbfields">dontmatch</arg>
                <arg name="/auth/secure">true</arg>
                <arg name="/auth/have_password">true</arg>
                <arg name="/new-session/domain">.yandex.ru</arg>
                <arg name="/new-session/http-only">true</arg>
                <arg name="/new-session/secure">true</arg>
                <arg name="/new-session/value" comp="contains">.1.2:2|70500.-1.</arg>
                <arg name="/new-sslsession/domain">.yandex.ru</arg>
                <arg name="/new-sslsession/http-only">true</arg>
                <arg name="/new-sslsession/secure">true</arg>
                <arg name="/new-sslsession/value" comp="contains">.1.2:2.499:1|70500.-1.</arg>
            </jsonBody>
        </result>
        <result name="id_need_reset_secure_resign_com">
            <body func="matchxpath">
                <arg name="/doc/status">NEED_RESET</arg>
                <arg name="/doc/status/@id">1</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70500</arg>
                <arg name="/doc/dbfield">dontmatch</arg>
                <arg name="/doc/special">dontmatch</arg>
                <arg name="/doc/auth/secure">1</arg>
                <arg name="count(/doc/new-session)">1</arg>
                <arg name="/doc/new-session/@domain">.yandex.com</arg>
                <arg name="/doc/new-session/@http-only">1</arg>
                <arg name="/doc/new-session/@secure">1</arg>
                <arg name="contains(/doc/new-session, '.1.2:2|70500.-1.')">1</arg>
                <arg name="count(/doc/new-sslsession)">1</arg>
                <arg name="/doc/new-sslsession/@domain">.yandex.com</arg>
                <arg name="/doc/new-sslsession/@http-only">1</arg>
                <arg name="/doc/new-sslsession/@secure">1</arg>
                <arg name="contains(/doc/new-sslsession, '.1.2:2.499:1|70500.-1.')">1</arg>
                <arg name="/doc/have_password">1</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">NEED_RESET</arg>
                <arg name="/status/id">1</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70500</arg>
                <arg name="/dbfields">dontmatch</arg>
                <arg name="/auth/secure">true</arg>
                <arg name="/auth/have_password">true</arg>
                <arg name="/new-session/domain">.yandex.com</arg>
                <arg name="/new-session/http-only">true</arg>
                <arg name="/new-session/secure">true</arg>
                <arg name="/new-session/value" comp="contains">.1.2:2|70500.-1.</arg>
                <arg name="/new-sslsession/domain">.yandex.com</arg>
                <arg name="/new-sslsession/http-only">true</arg>
                <arg name="/new-sslsession/secure">true</arg>
                <arg name="/new-sslsession/value" comp="contains">.1.2:2.499:1|70500.-1.</arg>
            </jsonBody>
        </result>

        <result name="id_need_reset_secure_resign_comtr">
            <body func="matchxpath">
                <arg name="/doc/status">NEED_RESET</arg>
                <arg name="/doc/status/@id">1</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70500</arg>
                <arg name="/doc/dbfield">dontmatch</arg>
                <arg name="/doc/special">dontmatch</arg>
                <arg name="/doc/auth/secure">1</arg>
                <arg name="count(/doc/new-session)">1</arg>
                <arg name="/doc/new-session/@domain">.yandex.com.tr</arg>
                <arg name="/doc/new-session/@http-only">1</arg>
                <arg name="/doc/new-session/@secure">1</arg>
                <arg name="contains(/doc/new-session, '.1.2:2|70500.-1')">1</arg>
                <arg name="count(/doc/new-sslsession)">1</arg>
                <arg name="/doc/new-sslsession/@domain">.yandex.com.tr</arg>
                <arg name="/doc/new-sslsession/@http-only">1</arg>
                <arg name="/doc/new-sslsession/@secure">1</arg>
                <arg name="contains(/doc/new-sslsession, '.1.2:2.499:1|70500.-1')">1</arg>
                <arg name="/doc/have_password">1</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">NEED_RESET</arg>
                <arg name="/status/id">1</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70500</arg>
                <arg name="/dbfields">dontmatch</arg>
                <arg name="/auth/secure">true</arg>
                <arg name="/auth/have_password">true</arg>
                <arg name="/new-session/domain">.yandex.com.tr</arg>
                <arg name="/new-session/http-only">true</arg>
                <arg name="/new-session/secure">true</arg>
                <arg name="/new-session/value" comp="contains">.1.2:2|70500.-1.</arg>
                <arg name="/new-sslsession/domain">.yandex.com.tr</arg>
                <arg name="/new-sslsession/http-only">true</arg>
                <arg name="/new-sslsession/secure">true</arg>
                <arg name="/new-sslsession/value" comp="contains">.1.2:2.499:1|70500.-1.</arg>
            </jsonBody>
        </result>

        <result name="id_valid_secure_resign_ru">
            <body func="matchxpath">
                <arg name="/doc/status">VALID</arg>
                <arg name="/doc/status/@id">0</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70500</arg>
                <arg name="/doc/dbfield">dontmatch</arg>
                <arg name="/doc/special">dontmatch</arg>
                <arg name="/doc/auth/secure">1</arg>
                <arg name="count(/doc/new-session)">1</arg>
                <arg name="/doc/new-session/@domain">.yandex.ru</arg>
                <arg name="count(/doc/new-sslsession)">1</arg>
                <arg name="/doc/new-sslsession/@domain">.yandex.ru</arg>
                <arg name="/doc/have_password">1</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">VALID</arg>
                <arg name="/status/id">0</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70500</arg>
                <arg name="/dbfields">dontmatch</arg>
                <arg name="/auth/secure">true</arg>
                <arg name="/auth/have_password">true</arg>
                <arg name="/new-session/domain">.yandex.ru</arg>
                <arg name="/new-session/http-only">true</arg>
                <arg name="/new-session/secure">true</arg>
                <arg name="/new-session/value" comp="contains">|70500.-1.</arg>
                <arg name="/new-sslsession/domain">.yandex.ru</arg>
                <arg name="/new-sslsession/http-only">true</arg>
                <arg name="/new-sslsession/secure">true</arg>
                <arg name="/new-sslsession/value" comp="contains">|70500.-1.</arg>
            </jsonBody>
        </result>
        <result name="id_valid_secure_resign_ua">
            <body func="matchxpath">
                <arg name="/doc/status">VALID</arg>
                <arg name="/doc/status/@id">0</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70500</arg>
                <arg name="/doc/dbfield">dontmatch</arg>
                <arg name="/doc/special">dontmatch</arg>
                <arg name="/doc/auth/secure">1</arg>
                <arg name="count(/doc/new-session)">1</arg>
                <arg name="/doc/new-session/@domain">.yandex.by</arg>
                <arg name="count(/doc/new-sslsession)">1</arg>
                <arg name="/doc/new-sslsession/@domain">.yandex.by</arg>
                <arg name="/doc/have_password">1</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">VALID</arg>
                <arg name="/status/id">0</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70500</arg>
                <arg name="/dbfields">dontmatch</arg>
                <arg name="/auth/secure">true</arg>
                <arg name="/auth/have_password">true</arg>
                <arg name="/new-session/domain">.yandex.by</arg>
                <arg name="/new-session/http-only">true</arg>
                <arg name="/new-session/secure">true</arg>
                <arg name="/new-session/value" comp="contains">|70500.-1.</arg>
                <arg name="/new-sslsession/domain">.yandex.by</arg>
                <arg name="/new-sslsession/http-only">true</arg>
                <arg name="/new-sslsession/secure">true</arg>
                <arg name="/new-sslsession/value" comp="contains">|70500.-1.</arg>
            </jsonBody>
        </result>

        <result name="id_need_reset_secure_resign_ua">
            <body func="matchxpath">
                <arg name="/doc/status">NEED_RESET</arg>
                <arg name="/doc/status/@id">1</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70500</arg>
                <arg name="/doc/dbfield">dontmatch</arg>
                <arg name="/doc/special">dontmatch</arg>
                <arg name="/doc/auth/secure">1</arg>
                <arg name="/doc/new-session/@domain">.yandex.by</arg>
                <arg name="/doc/new-session" comp="contains">|70500.-1</arg>
                <arg name="/doc/new-session/@http-only">1</arg>
                <arg name="/doc/new-session/@secure">1</arg>
                <arg name="/doc/new-sslsession/@domain">.yandex.by</arg>
                <arg name="/doc/new-sslsession" comp="contains">|70500.-1</arg>
                <arg name="/doc/new-sslsession/@http-only">1</arg>
                <arg name="/doc/new-sslsession/@secure">1</arg>
                <arg name="/doc/have_password">1</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">NEED_RESET</arg>
                <arg name="/status/id">1</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70500</arg>
                <arg name="/dbfields">dontmatch</arg>
                <arg name="/auth/secure">true</arg>
                <arg name="/auth/have_password">true</arg>
                <arg name="/new-session/domain">.yandex.by</arg>
                <arg name="/new-session/http-only">true</arg>
                <arg name="/new-session/secure">true</arg>
                <arg name="/new-session/value" comp="contains">|70500.-1.</arg>
                <arg name="/new-sslsession/domain">.yandex.by</arg>
                <arg name="/new-sslsession/http-only">true</arg>
                <arg name="/new-sslsession/secure">true</arg>
                <arg name="/new-sslsession/value" comp="contains">|70500.-1.</arg>
            </jsonBody>
        </result>

        <result name="id_expired">
            <body func="matchxpath">
                <arg name="/doc/status">EXPIRED</arg>
                <arg name="/doc/status/@id">2</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">dontmatch</arg>
                <arg name="/doc/age">dontmatch</arg>
                <arg name="/doc/dbfield">dontmatch</arg>
                <arg name="/doc/special">dontmatch</arg>
                <arg name="/doc/new-session">dontmatch</arg>
                <arg name="/doc/new-sslsession">dontmatch</arg>
                <arg name="/doc/auth/secure">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">EXPIRED</arg>
                <arg name="/status/id">2</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid">dontmatch</arg>
                <arg name="/age">dontmatch</arg>
                <arg name="/dbfields">dontmatch</arg>
                <arg name="/new-session">dontmatch</arg>
                <arg name="/new-sslsession">dontmatch</arg>
                <arg name="/auth/secure">dontmatch</arg>
            </jsonBody>
        </result>

        <result name="id_invalid_domain">
            <body func="matchxpath">
                <arg name="/doc/status">INVALID</arg>
                <arg name="/doc/status/@id">5</arg>
                <arg name="/doc/error" substitute="1">hostname &apos;\~`cgi:host`&apos; doesn't belong to sessionid domain</arg>
                <arg name="/doc/uid">dontmatch</arg>
                <arg name="/doc/age">dontmatch</arg>
                <arg name="/doc/dbfield">dontmatch</arg>
                <arg name="/doc/special">dontmatch</arg>
                <arg name="/doc/new-session">dontmatch</arg>
                <arg name="/doc/new-sslsession">dontmatch</arg>
                <arg name="/doc/auth/secure">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">INVALID</arg>
                <arg name="/status/id">5</arg>
                <arg name="/error" substitute="1">hostname &apos;\~`cgi:host`&apos; doesn't belong to sessionid domain</arg>
                <arg name="/uid">dontmatch</arg>
                <arg name="/age">dontmatch</arg>
                <arg name="/dbfields">dontmatch</arg>
                <arg name="/new-session">dontmatch</arg>
                <arg name="/new-sslsession">dontmatch</arg>
                <arg name="/auth/secure">dontmatch</arg>
            </jsonBody>
        </result>

        <result name="id_restricted_mismatch">
            <body func="matchxpath">
                <arg name="/doc/status">INVALID</arg>
                <arg name="/doc/status/@id">5</arg>
                <arg name="/doc/error">restricted cookie auth ip does not match with userip</arg>
                <arg name="/doc/uid">dontmatch</arg>
                <arg name="/doc/login">dontmatch</arg>
                <arg name="/doc/age">dontmatch</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">INVALID</arg>
                <arg name="/status/id">5</arg>
                <arg name="/error">restricted cookie auth ip does not match with userip</arg>
                <arg name="/uid">dontmatch</arg>
                <arg name="/age">dontmatch</arg>
                <arg name="/dbfields">dontmatch</arg>
                <arg name="/new-session">dontmatch</arg>
                <arg name="/new-sslsession">dontmatch</arg>
                <arg name="/auth/secure">dontmatch</arg>
            </jsonBody>
        </result>

        <result name="id_valid_resign_for_yandex_ru_and_edadeal_ru">
            <body func="matchxpath">
                <arg name="/doc/status">VALID</arg>
                <arg name="/doc/status/@id">0</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70500</arg>
                <arg name="/doc/auth/secure">1</arg>
                <arg name="count(/doc/resigned_cookies)">1</arg>
                <arg name="count(/doc/resigned_cookies/domain)">2</arg>
                <arg name="count(/doc/resigned_cookies/domain[@id='test.edadeal.ru'])">1</arg>
                <arg name="count(/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-session)">1</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-session/@domain">.edadeal.ru</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-session/@http-only">1</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-session/@secure">1</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-session/@expires">0</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-session" comp="contains">|70500.-1.</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-sslsession/@domain">.edadeal.ru</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-sslsession/@http-only">1</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-sslsession/@secure">1</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-sslsession/@expires">0</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-sslsession" comp="contains">|70500.-1.</arg>
                <arg name="count(/doc/resigned_cookies/domain[@id='aqua.mail.yandex.ru'])">1</arg>
                <arg name="count(/doc/resigned_cookies/domain[@id='aqua.mail.yandex.ru']/new-session)">1</arg>
                <arg name="/doc/resigned_cookies/domain[@id='aqua.mail.yandex.ru']/new-session/@domain">.yandex.ru</arg>
                <arg name="/doc/resigned_cookies/domain[@id='aqua.mail.yandex.ru']/new-session/@http-only">1</arg>
                <arg name="/doc/resigned_cookies/domain[@id='aqua.mail.yandex.ru']/new-session/@secure">1</arg>
                <arg name="/doc/resigned_cookies/domain[@id='aqua.mail.yandex.ru']/new-session/@expires">0</arg>
                <arg name="/doc/resigned_cookies/domain[@id='aqua.mail.yandex.ru']/new-session" comp="contains">|70500.-1.</arg>
                <arg name="/doc/resigned_cookies/domain[@id='aqua.mail.yandex.ru']/new-sslsession/@domain">.yandex.ru</arg>
                <arg name="/doc/resigned_cookies/domain[@id='aqua.mail.yandex.ru']/new-sslsession/@http-only">1</arg>
                <arg name="/doc/resigned_cookies/domain[@id='aqua.mail.yandex.ru']/new-sslsession/@secure">1</arg>
                <arg name="/doc/resigned_cookies/domain[@id='aqua.mail.yandex.ru']/new-sslsession/@expires">0</arg>
                <arg name="/doc/resigned_cookies/domain[@id='aqua.mail.yandex.ru']/new-sslsession" comp="contains">|70500.-1.</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">VALID</arg>
                <arg name="/status/id">0</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70500</arg>
                <arg name="/dbfields">dontmatch</arg>
                <arg name="/auth/secure">true</arg>
                <arg name="/resigned_cookies" res_mod="key_count">2</arg>
                <arg name="/resigned_cookies/test.edadeal.ru" res_mod="key_count">2</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-session" res_mod="key_count">5</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-session/domain">.edadeal.ru</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-session/http-only">true</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-session/secure">true</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-session/expires">0</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-session/value" comp="contains">|70500.-1.</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-sslsession/domain">.edadeal.ru</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-sslsession/http-only">true</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-sslsession/secure">true</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-sslsession/expires">0</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-sslsession/value" comp="contains">|70500.-1.</arg>
                <arg name="/resigned_cookies/aqua.mail.yandex.ru" res_mod="key_count">2</arg>
                <arg name="/resigned_cookies/aqua.mail.yandex.ru/new-session" res_mod="key_count">5</arg>
                <arg name="/resigned_cookies/aqua.mail.yandex.ru/new-session/domain">.yandex.ru</arg>
                <arg name="/resigned_cookies/aqua.mail.yandex.ru/new-session/http-only">true</arg>
                <arg name="/resigned_cookies/aqua.mail.yandex.ru/new-session/secure">true</arg>
                <arg name="/resigned_cookies/aqua.mail.yandex.ru/new-session/expires">0</arg>
                <arg name="/resigned_cookies/aqua.mail.yandex.ru/new-session/value" comp="contains">|70500.-1.</arg>
                <arg name="/resigned_cookies/aqua.mail.yandex.ru/new-sslsession/domain">.yandex.ru</arg>
                <arg name="/resigned_cookies/aqua.mail.yandex.ru/new-sslsession/http-only">true</arg>
                <arg name="/resigned_cookies/aqua.mail.yandex.ru/new-sslsession/secure">true</arg>
                <arg name="/resigned_cookies/aqua.mail.yandex.ru/new-sslsession/expires">0</arg>
                <arg name="/resigned_cookies/aqua.mail.yandex.ru/new-sslsession/value" comp="contains">|70500.-1.</arg>
            </jsonBody>
        </result>
        <result name="id_valid_resign_for_edadeal_ru">
            <body func="matchxpath">
                <arg name="/doc/status">VALID</arg>
                <arg name="/doc/status/@id">0</arg>
                <arg name="/doc/error">OK</arg>
                <arg name="/doc/uid">70500</arg>
                <arg name="/doc/auth/secure">1</arg>
                <arg name="count(/doc/resigned_cookies)">1</arg>
                <arg name="count(/doc/resigned_cookies/domain)">1</arg>
                <arg name="count(/doc/resigned_cookies/domain[@id='test.edadeal.ru'])">1</arg>
                <arg name="count(/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-session)">1</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-session/@domain">.edadeal.ru</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-session/@http-only">1</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-session/@secure">1</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-session/@expires">0</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-session" comp="contains">|70500.-1.</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-sslsession/@domain">.edadeal.ru</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-sslsession/@http-only">1</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-sslsession/@secure">1</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-sslsession/@expires">0</arg>
                <arg name="/doc/resigned_cookies/domain[@id='test.edadeal.ru']/new-sslsession" comp="contains">|70500.-1.</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/status/value">VALID</arg>
                <arg name="/status/id">0</arg>
                <arg name="/error">OK</arg>
                <arg name="/uid/value">70500</arg>
                <arg name="/auth/secure">true</arg>
                <arg name="/resigned_cookies" res_mod="key_count">1</arg>
                <arg name="/resigned_cookies/test.edadeal.ru" res_mod="key_count">2</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-session" res_mod="key_count">5</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-session/domain">.edadeal.ru</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-session/http-only">true</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-session/secure">true</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-session/expires">0</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-session/value" comp="contains">|70500.-1.</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-sslsession/domain">.edadeal.ru</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-sslsession/http-only">true</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-sslsession/secure">true</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-sslsession/expires">0</arg>
                <arg name="/resigned_cookies/test.edadeal.ru/new-sslsession/value" comp="contains">|70500.-1.</arg>
            </jsonBody>
        </result>
        <result name="id_resigned_not_found">
            <body func="matchxpath">
                <arg name="/doc/exception">INVALID_PARAMS</arg>
                <arg name="/doc/exception/@id">2</arg>
                <arg name="/doc/error" comp="starts_with">BlackBox error: failed to get keys for domain: 'yandex.kokoko.ru'.</arg>
            </body>
            <jsonBody func="matchjsonpoint">
                <arg name="/exception/value">INVALID_PARAMS</arg>
                <arg name="/exception/id">2</arg>
                <arg name="/error" comp="starts_with">BlackBox error: failed to get keys for domain: 'yandex.kokoko.ru'.</arg>
            </jsonBody>
        </result>
    </variables>

    <node>
        <description> blackbox sessionid method test </description>
        <url>http://passdev2.yandex.ru</url>

        <case lastid="check">
            <description>Testing two cookies sessionid behavior</description>
            <path>blackbox</path>
            <cgi name="userip">internal_user</cgi>
            <cgi name="host">com;comtr</cgi>
            <cgi name="sessionid">*</cgi>
            <cgi name="format">*</cgi>

            <check>
                <cgi name="sessionid">
                    ru_int; ru_int2; ru_ext; ru_expired; ru_valid; ru_need_reset; ru_restricted_int_user;
                    ru_need_reset_restricted_ext; ua_valid; ua_need_reset; ua_expired
                </cgi>
                <cgi name="host">com; comtr</cgi>
                <result>id_invalid_domain</result>
            </check>

            <check>
                <cgi name="sessionid">
                    com_int; com_int2; com_ext; com_expired; com_valid; com_need_reset; com_restricted_int_user;
                    com_need_reset_restricted_ext; ua_valid; ua_need_reset; ua_expired
                </cgi>
                <cgi name="host">ru; comtr</cgi>
                <result>id_invalid_domain</result>
            </check>

            <check>
                <cgi name="sessionid">
                    comtr_int; comtr_int2; comtr_ext; comtr_expired; comtr_valid; comtr_need_reset; comtr_restricted_int_user;
                    comtr_need_reset_restricted_ext; ua_valid; ua_need_reset; ua_expired
                </cgi>
                <cgi name="host">ru; com</cgi>
                <result>id_invalid_domain</result>
            </check>

            <check>
                <cgi name="sessionid">ru_ext; com_ext; comtr_ext;
                    ru_need_reset_restricted_ext; com_need_reset_restricted_ext;
                    comtr_need_reset_restricted_ext</cgi>
                <result>id_restricted_mismatch</result>
            </check>

            <check>
                <cgi name="sessionid">ru_expired; com_expired; comtr_expired</cgi>
                <result>id_expired</result>
            </check>

            <check>
                <cgi name="sessionid">
                    ru_valid; ru_ext; ru_int; ru_int2; ru_restricted_int_user;
                    com_valid; com_ext; com_int; com_int2; com_restricted_int_user;
                    comtr_valid; comtr_ext; comtr_int; comtr_int2; comtr_restricted_int_user
                </cgi>
                <result>id_valid_secure</result>
            </check>

            <check>
                <cgi name="sessionid">
                    ru_need_reset; com_need_reset; comtr_need_reset
                </cgi>
                <result>id_need_reset_secure</result>
            </check>

        </case>

        <case lastid="resign">
            <description>Testing cookie resign behavior</description>
            <path>blackbox</path>
            <cgi name="userip">internal_user</cgi>
            <cgi name="host">ru;com</cgi>
            <cgi name="resign">*</cgi>
            <cgi name="sessionid">*</cgi>
            <cgi name="format">*</cgi>

            <check>
                <cgi name="sessionid">
                    ru_int; ru_int2; ru_ext; ru_expired; ru_valid; ru_need_reset; ru_restricted_int_user;
                    ru_need_reset_restricted_ext; ua_valid; ua_need_reset; ua_expired
                </cgi>
                <cgi name="host">com; comtr</cgi>
                <result>id_invalid_domain</result>
            </check>

            <check>
                <cgi name="sessionid">
                    com_int; com_int2; com_ext; com_expired; com_valid; com_need_reset; com_restricted_int_user;
                    com_need_reset_restricted_ext; ua_valid; ua_need_reset; ua_expired
                </cgi>
                <cgi name="host">ru; comtr</cgi>
                <result>id_invalid_domain</result>
            </check>

            <check>
                <cgi name="sessionid">
                    comtr_int; comtr_int2; comtr_ext; comtr_expired; comtr_valid; comtr_need_reset; comtr_restricted_int_user;
                    comtr_need_reset_restricted_ext; ua_valid; ua_need_reset; ua_expired
                </cgi>
                <cgi name="host">ru; com</cgi>
                <result>id_invalid_domain</result>
            </check>

            <check>
                <cgi name="sessionid">ru_ext; com_ext; comtr_ext;
                    ru_need_reset_restricted_ext; com_need_reset_restricted_ext; comtr_need_reset_restricted_ext</cgi>
                <result>id_restricted_mismatch</result>
            </check>

            <check>
                <cgi name="sessionid">ru_expired; com_expired; comtr_expired</cgi>
                <result>id_expired</result>
            </check>

            <check>
                <cgi name="sessionid">
                    ru_valid; ru_ext; ru_int; ru_int2; ru_restricted_int_user;
                    com_valid; com_ext; com_int; com_int2; com_restricted_int_user;
                    comtr_valid; comtr_ext; comtr_int; comtr_int2; comtr_restricted_int_user
                </cgi>
                <result>id_valid_secure</result>
            </check>

            <check>
                <cgi name="sessionid"> ru_need_reset; com_need_reset</cgi>
                <cgi name="resign">resign_no</cgi>
                <result>id_need_reset_secure</result>
            </check>
            <check>
                <cgi name="sessionid">ru_need_reset</cgi>
                <result>id_need_reset_secure_resign_ru</result>
            </check>
            <check>
                <cgi name="sessionid">com_need_reset</cgi>
                <result>id_need_reset_secure_resign_com</result>
            </check>

        </case>

        <case lastid="resign_ext">
            <description>Testing external cookie resign behavior</description>
            <path>blackbox</path>
            <cgi name="userip">internal_user; external</cgi>
            <cgi name="host">ru;comtr</cgi>
            <cgi name="resign">*</cgi>
            <cgi name="sessionid">ru_ext; com_ext; comtr_ext;
                 ru_need_reset_restricted_ext; com_need_reset_restricted_ext; comtr_need_reset_restricted_ext;
            </cgi>
            <cgi name="format">*</cgi>

            <check>
                <cgi name="sessionid">ru_ext; ru_need_reset_restricted_ext</cgi>
                <cgi name="host">com; comtr</cgi>
                <result>id_invalid_domain</result>
            </check>
            <check>
                <cgi name="sessionid">com_ext; com_need_reset_restricted_ext</cgi>
                <cgi name="host">ru; comtr</cgi>
                <result>id_invalid_domain</result>
            </check>
            <check>
                <cgi name="sessionid">comtr_ext; comtr_need_reset_restricted_ext</cgi>
                <cgi name="host">ru; com</cgi>
                <result>id_invalid_domain</result>
            </check>

            <check>
                <cgi name="userip">internal_user</cgi>
                <result>id_restricted_mismatch</result>
            </check>

            <check>
                <cgi name="sessionid">ru_ext; comtr_ext</cgi>
                <result>id_valid_secure</result>
            </check>

            <check>
                <cgi name="sessionid">ru_need_reset_restricted_ext; comtr_need_reset_restricted_ext</cgi>
                <cgi name="resign">resign_no</cgi>
                <result>id_need_reset_secure</result>
            </check>

            <check>
                <cgi name="sessionid">ru_need_reset_restricted_ext</cgi>
                <result>id_need_reset_secure_resign_ru</result>
            </check>

            <check>
                <cgi name="sessionid">comtr_need_reset_restricted_ext</cgi>
                <result>id_need_reset_secure_resign_comtr</result>
            </check>

        </case>

        <case lastid="force_resign">
            <description>Testing resign and force_resign</description>
            <path>blackbox</path>
            <cgi name="userip">internal_user</cgi>
            <cgi name="host">ru; by</cgi>
            <cgi name="resign" withnull="1">*</cgi>
            <cgi name="force_resign" withnull="1">*</cgi>
            <cgi name="sessionid">ru_valid; ru_need_reset; ru_expired; ua_valid; ua_need_reset; ua_expired</cgi>
            <cgi name="format">*</cgi>

            <check>
                <cgi name="sessionid">ru_valid; ru_need_reset; ru_expired</cgi>
                <cgi name="host">by</cgi>
                <result>id_invalid_domain</result>
            </check>
            <check>
                <cgi name="sessionid">ua_valid; ua_need_reset; ua_expired</cgi>
                <cgi name="host">ru</cgi>
                <result>id_invalid_domain</result>
            </check>

            <check>
                <cgi name="sessionid">ru_expired; ua_expired</cgi>
                <result>id_expired</result>
            </check>

            <check>
                <cgi name="sessionid">ru_valid</cgi>
                <cgi name="resign">resign_yes; resign</cgi>
                <cgi name="force_resign">resign_yes; resign</cgi>
                <result>id_valid_secure_resign_ru</result>
            </check>
            <check>
                <cgi name="sessionid">ua_valid</cgi>
                <cgi name="resign">resign_yes; resign</cgi>
                <cgi name="force_resign">resign_yes; resign</cgi>
                <result>id_valid_secure_resign_ua</result>
            </check>
            <check>
                <cgi name="sessionid">ru_valid; ua_valid</cgi>
                <result>id_valid_secure</result>
            </check>

            <check>
                <cgi name="sessionid">ru_need_reset</cgi>
                <cgi name="resign">resign_yes;resign</cgi>
                <result>id_need_reset_secure_resign_ru</result>
            </check>
            <check>
                <cgi name="sessionid">ua_need_reset</cgi>
                <cgi name="resign">resign_yes;resign</cgi>
                <result>id_need_reset_secure_resign_ua</result>
            </check>

            <check>
                <cgi name="sessionid">ru_need_reset; ua_need_reset</cgi>
                <result>id_need_reset_secure</result>
            </check>
        </case>

        <case lastid="resign_for_domains">
            <description>Testing resign_for_domains</description>
            <path>blackbox</path>
            <cgi name="userip">internal_user</cgi>
            <cgi name="host">ru</cgi>
            <cgi name="sessionid">ru_valid</cgi>
            <cgi name="resign_for_domains">*</cgi>
            <cgi name="format">*</cgi>

            <check>
                <cgi name="resign_for_domains">mail_yandex_ru_and_test_edadeal_ru</cgi>
                <result>id_valid_resign_for_yandex_ru_and_edadeal_ru</result>
            </check>
            <check>
                <cgi name="resign_for_domains">test_edadeal_ru</cgi>
                <result>id_valid_resign_for_edadeal_ru</result>
            </check>

            <check>
                <result>id_resigned_not_found</result>
            </check>
        </case>
    </node>

</test>
